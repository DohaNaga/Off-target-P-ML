The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) slurm/17.02.7
During startup - Warning message:
Setting LC_CTYPE failed, using "C" 

Attaching package: 'dplyr'

The following objects are masked from 'package:stats':

    filter, lag

The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union

Loading required package: lattice
Loading required package: ggplot2

Attaching package: 'caret'

The following object is masked from 'package:tensorflow':

    train

2021-11-29 01:52:46.701947: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/Java/1.8.0_144/jre/lib/amd64/server:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Szip/2.1-goolf-1.7.20/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/libgcrypt/1.7.0-goolf-1.7.20/lib:/pstore/apps/libgpg-error/1.22-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/HarfBuzz/1.0.1-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/libGLU/9.0.0-goolf-1.7.20/lib:/pstore/apps/Mesa/17.0.2-goolf-1.7.20/lib:/pstore/apps/LLVM/4.0.0-goolf-1.7.20/lib:/pstore/apps/libdrm/2.4.67-goolf-1.7.20/lib:/pstore/apps/gtk-doc/1.25-goolf-1.7.20/lib:/pstore/apps/docbook-xsl/1.79.1-goolf-1.7.20/lib:/pstore/apps/Perl/5.22.0-goolf-1.7.20/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/bzip2/1.0.6-goolf-1.7.20/lib:/pstore/apps/GObject-Introspection/1.44.0-goolf-1.7.20/lib:/pstore/apps/pixman/0.32.6-goolf-1.7.20/lib:/pstore/apps/flex/2.5.39-goolf-1.7.20/lib:/pstore/apps/Bison/3.0.4-goolf-1.7.20/lib:/pstore/apps/GLib/2.44.1-goolf-1.7.20/lib:/pstore/apps/gnutls/3.4.7-goolf-1.7.20/lib:/pstore/apps/p11-kit/0.23.2-goolf-1.7.20/lib:/pstore/apps/libidn/1.32-goolf-1.7.20/lib:/pstore/apps/libtasn1/4.7-goolf-1.7.20/lib:/pstore/apps/guile/1.8.8-goolf-1.7.20/lib:/pstore/apps/libunistring/0.9.3-goolf-1.7.20/lib:/pstore/apps/libtool/2.4.6-goolf-1.7.20/lib:/pstore/apps/nettle/3.1.1-goolf-1.7.20/lib64:/pstore/apps/GMP/5.0.5-goolf-1.7.20/lib:/pstore/apps/gettext/0.18.2-goolf-1.7.20/lib:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib64:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/freetype/2.6.5-goolf-1.7.20/lib:/pstore/apps/expat/2.2.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/ncurses/5.9-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/OpenMPI/1.8.8-GCC-4.8.4/lib:/pstore/apps/hwloc/1.10.1-GCC-4.8.4/lib:/pstore/apps/numactl/2.0.10-GCC-4.8.4/lib:/pstore/apps/GCC/4.8.4/lib/gcc/x86_64-unknown-linux-gnu/4.8.4:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/binutils/2.25/lib:/cm/shared/apps/slurm/17.02.7/lib64/slurm:/cm/shared/apps/slurm/17.02.7/lib64:/pstore/home/nagakamd/.conda/envs/r-tensorflow/lib:@JAVA_LD@
2021-11-29 01:52:46.704239: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
1,296 total combinations of flags (sampled to 648 combinations)
Training run 1/648 (flags = list(0.2, 1024, 0.2, 64, 2048, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-52-53Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()
2021-11-29 01:52:53.600505: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2021-11-29 01:52:53.740014: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 0 with properties: 
pciBusID: 0000:15:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-11-29 01:52:53.742069: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 1 with properties: 
pciBusID: 0000:3b:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-11-29 01:52:53.743956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1716] Found device 2 with properties: 
pciBusID: 0000:8a:00.0 name: Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-11-29 01:52:53.744470: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudart.so.10.1'; dlerror: libcudart.so.10.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/Java/1.8.0_144/jre/lib/amd64/server:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Szip/2.1-goolf-1.7.20/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/libgcrypt/1.7.0-goolf-1.7.20/lib:/pstore/apps/libgpg-error/1.22-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/HarfBuzz/1.0.1-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/libGLU/9.0.0-goolf-1.7.20/lib:/pstore/apps/Mesa/17.0.2-goolf-1.7.20/lib:/pstore/apps/LLVM/4.0.0-goolf-1.7.20/lib:/pstore/apps/libdrm/2.4.67-goolf-1.7.20/lib:/pstore/apps/gtk-doc/1.25-goolf-1.7.20/lib:/pstore/apps/docbook-xsl/1.79.1-goolf-1.7.20/lib:/pstore/apps/Perl/5.22.0-goolf-1.7.20/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/bzip2/1.0.6-goolf-1.7.20/lib:/pstore/apps/GObject-Introspection/1.44.0-goolf-1.7.20/lib:/pstore/apps/pixman/0.32.6-goolf-1.7.20/lib:/pstore/apps/flex/2.5.39-goolf-1.7.20/lib:/pstore/apps/Bison/3.0.4-goolf-1.7.20/lib:/pstore/apps/GLib/2.44.1-goolf-1.7.20/lib:/pstore/apps/gnutls/3.4.7-goolf-1.7.20/lib:/pstore/apps/p11-kit/0.23.2-goolf-1.7.20/lib:/pstore/apps/libidn/1.32-goolf-1.7.20/lib:/pstore/apps/libtasn1/4.7-goolf-1.7.20/lib:/pstore/apps/guile/1.8.8-goolf-1.7.20/lib:/pstore/apps/libunistring/0.9.3-goolf-1.7.20/lib:/pstore/apps/libtool/2.4.6-goolf-1.7.20/lib:/pstore/apps/nettle/3.1.1-goolf-1.7.20/lib64:/pstore/apps/GMP/5.0.5-goolf-1.7.20/lib:/pstore/apps/gettext/0.18.2-goolf-1.7.20/lib:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib64:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/freetype/2.6.5-goolf-1.7.20/lib:/pstore/apps/expat/2.2.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/ncurses/5.9-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/OpenMPI/1.8.8-GCC-4.8.4/lib:/pstore/apps/hwloc/1.10.1-GCC-4.8.4/lib:/pstore/apps/numactl/2.0.10-GCC-4.8.4/lib:/pstore/apps/GCC/4.8.4/lib/gcc/x86_64-unknown-linux-gnu/4.8.4:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/binutils/2.25/lib:/cm/shared/apps/slurm/17.02.7/lib64/slurm:/cm/shared/apps/slurm/17.02.7/lib64:/pstore/home/nagakamd/.conda/envs/r-tensorflow/lib:@JAVA_LD@
2021-11-29 01:52:53.745228: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcublas.so.10'; dlerror: libcublas.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/Java/1.8.0_144/jre/lib/amd64/server:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Szip/2.1-goolf-1.7.20/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/libgcrypt/1.7.0-goolf-1.7.20/lib:/pstore/apps/libgpg-error/1.22-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/HarfBuzz/1.0.1-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/libGLU/9.0.0-goolf-1.7.20/lib:/pstore/apps/Mesa/17.0.2-goolf-1.7.20/lib:/pstore/apps/LLVM/4.0.0-goolf-1.7.20/lib:/pstore/apps/libdrm/2.4.67-goolf-1.7.20/lib:/pstore/apps/gtk-doc/1.25-goolf-1.7.20/lib:/pstore/apps/docbook-xsl/1.79.1-goolf-1.7.20/lib:/pstore/apps/Perl/5.22.0-goolf-1.7.20/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/bzip2/1.0.6-goolf-1.7.20/lib:/pstore/apps/GObject-Introspection/1.44.0-goolf-1.7.20/lib:/pstore/apps/pixman/0.32.6-goolf-1.7.20/lib:/pstore/apps/flex/2.5.39-goolf-1.7.20/lib:/pstore/apps/Bison/3.0.4-goolf-1.7.20/lib:/pstore/apps/GLib/2.44.1-goolf-1.7.20/lib:/pstore/apps/gnutls/3.4.7-goolf-1.7.20/lib:/pstore/apps/p11-kit/0.23.2-goolf-1.7.20/lib:/pstore/apps/libidn/1.32-goolf-1.7.20/lib:/pstore/apps/libtasn1/4.7-goolf-1.7.20/lib:/pstore/apps/guile/1.8.8-goolf-1.7.20/lib:/pstore/apps/libunistring/0.9.3-goolf-1.7.20/lib:/pstore/apps/libtool/2.4.6-goolf-1.7.20/lib:/pstore/apps/nettle/3.1.1-goolf-1.7.20/lib64:/pstore/apps/GMP/5.0.5-goolf-1.7.20/lib:/pstore/apps/gettext/0.18.2-goolf-1.7.20/lib:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib64:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/freetype/2.6.5-goolf-1.7.20/lib:/pstore/apps/expat/2.2.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/ncurses/5.9-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/OpenMPI/1.8.8-GCC-4.8.4/lib:/pstore/apps/hwloc/1.10.1-GCC-4.8.4/lib:/pstore/apps/numactl/2.0.10-GCC-4.8.4/lib:/pstore/apps/GCC/4.8.4/lib/gcc/x86_64-unknown-linux-gnu/4.8.4:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/binutils/2.25/lib:/cm/shared/apps/slurm/17.02.7/lib64/slurm:/cm/shared/apps/slurm/17.02.7/lib64:/pstore/home/nagakamd/.conda/envs/r-tensorflow/lib:@JAVA_LD@
2021-11-29 01:52:53.745806: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcufft.so.10'; dlerror: libcufft.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/Java/1.8.0_144/jre/lib/amd64/server:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Szip/2.1-goolf-1.7.20/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/libgcrypt/1.7.0-goolf-1.7.20/lib:/pstore/apps/libgpg-error/1.22-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/HarfBuzz/1.0.1-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/libGLU/9.0.0-goolf-1.7.20/lib:/pstore/apps/Mesa/17.0.2-goolf-1.7.20/lib:/pstore/apps/LLVM/4.0.0-goolf-1.7.20/lib:/pstore/apps/libdrm/2.4.67-goolf-1.7.20/lib:/pstore/apps/gtk-doc/1.25-goolf-1.7.20/lib:/pstore/apps/docbook-xsl/1.79.1-goolf-1.7.20/lib:/pstore/apps/Perl/5.22.0-goolf-1.7.20/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/bzip2/1.0.6-goolf-1.7.20/lib:/pstore/apps/GObject-Introspection/1.44.0-goolf-1.7.20/lib:/pstore/apps/pixman/0.32.6-goolf-1.7.20/lib:/pstore/apps/flex/2.5.39-goolf-1.7.20/lib:/pstore/apps/Bison/3.0.4-goolf-1.7.20/lib:/pstore/apps/GLib/2.44.1-goolf-1.7.20/lib:/pstore/apps/gnutls/3.4.7-goolf-1.7.20/lib:/pstore/apps/p11-kit/0.23.2-goolf-1.7.20/lib:/pstore/apps/libidn/1.32-goolf-1.7.20/lib:/pstore/apps/libtasn1/4.7-goolf-1.7.20/lib:/pstore/apps/guile/1.8.8-goolf-1.7.20/lib:/pstore/apps/libunistring/0.9.3-goolf-1.7.20/lib:/pstore/apps/libtool/2.4.6-goolf-1.7.20/lib:/pstore/apps/nettle/3.1.1-goolf-1.7.20/lib64:/pstore/apps/GMP/5.0.5-goolf-1.7.20/lib:/pstore/apps/gettext/0.18.2-goolf-1.7.20/lib:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib64:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/freetype/2.6.5-goolf-1.7.20/lib:/pstore/apps/expat/2.2.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/ncurses/5.9-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/OpenMPI/1.8.8-GCC-4.8.4/lib:/pstore/apps/hwloc/1.10.1-GCC-4.8.4/lib:/pstore/apps/numactl/2.0.10-GCC-4.8.4/lib:/pstore/apps/GCC/4.8.4/lib/gcc/x86_64-unknown-linux-gnu/4.8.4:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/binutils/2.25/lib:/cm/shared/apps/slurm/17.02.7/lib64/slurm:/cm/shared/apps/slurm/17.02.7/lib64:/pstore/home/nagakamd/.conda/envs/r-tensorflow/lib:@JAVA_LD@
2021-11-29 01:52:53.746368: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcurand.so.10'; dlerror: libcurand.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/Java/1.8.0_144/jre/lib/amd64/server:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Szip/2.1-goolf-1.7.20/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/libgcrypt/1.7.0-goolf-1.7.20/lib:/pstore/apps/libgpg-error/1.22-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/HarfBuzz/1.0.1-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/libGLU/9.0.0-goolf-1.7.20/lib:/pstore/apps/Mesa/17.0.2-goolf-1.7.20/lib:/pstore/apps/LLVM/4.0.0-goolf-1.7.20/lib:/pstore/apps/libdrm/2.4.67-goolf-1.7.20/lib:/pstore/apps/gtk-doc/1.25-goolf-1.7.20/lib:/pstore/apps/docbook-xsl/1.79.1-goolf-1.7.20/lib:/pstore/apps/Perl/5.22.0-goolf-1.7.20/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/bzip2/1.0.6-goolf-1.7.20/lib:/pstore/apps/GObject-Introspection/1.44.0-goolf-1.7.20/lib:/pstore/apps/pixman/0.32.6-goolf-1.7.20/lib:/pstore/apps/flex/2.5.39-goolf-1.7.20/lib:/pstore/apps/Bison/3.0.4-goolf-1.7.20/lib:/pstore/apps/GLib/2.44.1-goolf-1.7.20/lib:/pstore/apps/gnutls/3.4.7-goolf-1.7.20/lib:/pstore/apps/p11-kit/0.23.2-goolf-1.7.20/lib:/pstore/apps/libidn/1.32-goolf-1.7.20/lib:/pstore/apps/libtasn1/4.7-goolf-1.7.20/lib:/pstore/apps/guile/1.8.8-goolf-1.7.20/lib:/pstore/apps/libunistring/0.9.3-goolf-1.7.20/lib:/pstore/apps/libtool/2.4.6-goolf-1.7.20/lib:/pstore/apps/nettle/3.1.1-goolf-1.7.20/lib64:/pstore/apps/GMP/5.0.5-goolf-1.7.20/lib:/pstore/apps/gettext/0.18.2-goolf-1.7.20/lib:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib64:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/freetype/2.6.5-goolf-1.7.20/lib:/pstore/apps/expat/2.2.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/ncurses/5.9-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/OpenMPI/1.8.8-GCC-4.8.4/lib:/pstore/apps/hwloc/1.10.1-GCC-4.8.4/lib:/pstore/apps/numactl/2.0.10-GCC-4.8.4/lib:/pstore/apps/GCC/4.8.4/lib/gcc/x86_64-unknown-linux-gnu/4.8.4:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/binutils/2.25/lib:/cm/shared/apps/slurm/17.02.7/lib64/slurm:/cm/shared/apps/slurm/17.02.7/lib64:/pstore/home/nagakamd/.conda/envs/r-tensorflow/lib:@JAVA_LD@
2021-11-29 01:52:53.746922: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusolver.so.10'; dlerror: libcusolver.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/Java/1.8.0_144/jre/lib/amd64/server:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Szip/2.1-goolf-1.7.20/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/libgcrypt/1.7.0-goolf-1.7.20/lib:/pstore/apps/libgpg-error/1.22-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/HarfBuzz/1.0.1-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/libGLU/9.0.0-goolf-1.7.20/lib:/pstore/apps/Mesa/17.0.2-goolf-1.7.20/lib:/pstore/apps/LLVM/4.0.0-goolf-1.7.20/lib:/pstore/apps/libdrm/2.4.67-goolf-1.7.20/lib:/pstore/apps/gtk-doc/1.25-goolf-1.7.20/lib:/pstore/apps/docbook-xsl/1.79.1-goolf-1.7.20/lib:/pstore/apps/Perl/5.22.0-goolf-1.7.20/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/bzip2/1.0.6-goolf-1.7.20/lib:/pstore/apps/GObject-Introspection/1.44.0-goolf-1.7.20/lib:/pstore/apps/pixman/0.32.6-goolf-1.7.20/lib:/pstore/apps/flex/2.5.39-goolf-1.7.20/lib:/pstore/apps/Bison/3.0.4-goolf-1.7.20/lib:/pstore/apps/GLib/2.44.1-goolf-1.7.20/lib:/pstore/apps/gnutls/3.4.7-goolf-1.7.20/lib:/pstore/apps/p11-kit/0.23.2-goolf-1.7.20/lib:/pstore/apps/libidn/1.32-goolf-1.7.20/lib:/pstore/apps/libtasn1/4.7-goolf-1.7.20/lib:/pstore/apps/guile/1.8.8-goolf-1.7.20/lib:/pstore/apps/libunistring/0.9.3-goolf-1.7.20/lib:/pstore/apps/libtool/2.4.6-goolf-1.7.20/lib:/pstore/apps/nettle/3.1.1-goolf-1.7.20/lib64:/pstore/apps/GMP/5.0.5-goolf-1.7.20/lib:/pstore/apps/gettext/0.18.2-goolf-1.7.20/lib:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib64:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/freetype/2.6.5-goolf-1.7.20/lib:/pstore/apps/expat/2.2.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/ncurses/5.9-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/OpenMPI/1.8.8-GCC-4.8.4/lib:/pstore/apps/hwloc/1.10.1-GCC-4.8.4/lib:/pstore/apps/numactl/2.0.10-GCC-4.8.4/lib:/pstore/apps/GCC/4.8.4/lib/gcc/x86_64-unknown-linux-gnu/4.8.4:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/binutils/2.25/lib:/cm/shared/apps/slurm/17.02.7/lib64/slurm:/cm/shared/apps/slurm/17.02.7/lib64:/pstore/home/nagakamd/.conda/envs/r-tensorflow/lib:@JAVA_LD@
2021-11-29 01:52:53.747468: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcusparse.so.10'; dlerror: libcusparse.so.10: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/Java/1.8.0_144/jre/lib/amd64/server:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Szip/2.1-goolf-1.7.20/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/libgcrypt/1.7.0-goolf-1.7.20/lib:/pstore/apps/libgpg-error/1.22-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/HarfBuzz/1.0.1-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/libGLU/9.0.0-goolf-1.7.20/lib:/pstore/apps/Mesa/17.0.2-goolf-1.7.20/lib:/pstore/apps/LLVM/4.0.0-goolf-1.7.20/lib:/pstore/apps/libdrm/2.4.67-goolf-1.7.20/lib:/pstore/apps/gtk-doc/1.25-goolf-1.7.20/lib:/pstore/apps/docbook-xsl/1.79.1-goolf-1.7.20/lib:/pstore/apps/Perl/5.22.0-goolf-1.7.20/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/bzip2/1.0.6-goolf-1.7.20/lib:/pstore/apps/GObject-Introspection/1.44.0-goolf-1.7.20/lib:/pstore/apps/pixman/0.32.6-goolf-1.7.20/lib:/pstore/apps/flex/2.5.39-goolf-1.7.20/lib:/pstore/apps/Bison/3.0.4-goolf-1.7.20/lib:/pstore/apps/GLib/2.44.1-goolf-1.7.20/lib:/pstore/apps/gnutls/3.4.7-goolf-1.7.20/lib:/pstore/apps/p11-kit/0.23.2-goolf-1.7.20/lib:/pstore/apps/libidn/1.32-goolf-1.7.20/lib:/pstore/apps/libtasn1/4.7-goolf-1.7.20/lib:/pstore/apps/guile/1.8.8-goolf-1.7.20/lib:/pstore/apps/libunistring/0.9.3-goolf-1.7.20/lib:/pstore/apps/libtool/2.4.6-goolf-1.7.20/lib:/pstore/apps/nettle/3.1.1-goolf-1.7.20/lib64:/pstore/apps/GMP/5.0.5-goolf-1.7.20/lib:/pstore/apps/gettext/0.18.2-goolf-1.7.20/lib:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib64:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/freetype/2.6.5-goolf-1.7.20/lib:/pstore/apps/expat/2.2.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/ncurses/5.9-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/OpenMPI/1.8.8-GCC-4.8.4/lib:/pstore/apps/hwloc/1.10.1-GCC-4.8.4/lib:/pstore/apps/numactl/2.0.10-GCC-4.8.4/lib:/pstore/apps/GCC/4.8.4/lib/gcc/x86_64-unknown-linux-gnu/4.8.4:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/binutils/2.25/lib:/cm/shared/apps/slurm/17.02.7/lib64/slurm:/cm/shared/apps/slurm/17.02.7/lib64:/pstore/home/nagakamd/.conda/envs/r-tensorflow/lib:@JAVA_LD@
2021-11-29 01:52:53.748005: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/Java/1.8.0_144/jre/lib/amd64/server:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64/R/lib:/pstore/apps/R/3.5.1-goolf-1.7.20/lib64:/pstore/apps/Oracle_InstantClient/12.2.0.1.0/lib:/pstore/apps/netCDF/4.4.0-goolf-1.7.20/lib64:/pstore/apps/HDF5/1.8.16-goolf-1.7.20/lib:/pstore/apps/Szip/2.1-goolf-1.7.20/lib:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib64:/pstore/apps/libssh2/1.8.0-goolf-1.7.20/lib:/pstore/apps/OpenSSL/1.0.2d-goolf-1.7.20/lib:/pstore/apps/libgcrypt/1.7.0-goolf-1.7.20/lib:/pstore/apps/libgpg-error/1.22-goolf-1.7.20/lib:/pstore/apps/PCRE/8.37-goolf-1.7.20-UTF/lib:/pstore/apps/XZ/5.2.2-goolf-1.7.20/lib:/pstore/apps/lzma/4.32.7-goolf-1.7.20/lib:/pstore/apps/NLopt/2.4.2-goolf-1.7.20/lib:/pstore/apps/Java/1.8.0_144/lib:/pstore/apps/unixODBC/2.3.0-goolf-1.7.20-20130506/lib:/pstore/apps/JAGS/4.2.0-goolf-1.7.20/lib:/pstore/apps/Pango/1.37.2-goolf-1.7.20/lib:/pstore/apps/HarfBuzz/1.0.1-goolf-1.7.20/lib:/pstore/apps/cairo/1.14.2-goolf-1.7.20/lib:/pstore/apps/libGLU/9.0.0-goolf-1.7.20/lib:/pstore/apps/Mesa/17.0.2-goolf-1.7.20/lib:/pstore/apps/LLVM/4.0.0-goolf-1.7.20/lib:/pstore/apps/libdrm/2.4.67-goolf-1.7.20/lib:/pstore/apps/gtk-doc/1.25-goolf-1.7.20/lib:/pstore/apps/docbook-xsl/1.79.1-goolf-1.7.20/lib:/pstore/apps/Perl/5.22.0-goolf-1.7.20/lib:/pstore/apps/X11/20160819-goolf-1.7.20/lib:/pstore/apps/bzip2/1.0.6-goolf-1.7.20/lib:/pstore/apps/GObject-Introspection/1.44.0-goolf-1.7.20/lib:/pstore/apps/pixman/0.32.6-goolf-1.7.20/lib:/pstore/apps/flex/2.5.39-goolf-1.7.20/lib:/pstore/apps/Bison/3.0.4-goolf-1.7.20/lib:/pstore/apps/GLib/2.44.1-goolf-1.7.20/lib:/pstore/apps/gnutls/3.4.7-goolf-1.7.20/lib:/pstore/apps/p11-kit/0.23.2-goolf-1.7.20/lib:/pstore/apps/libidn/1.32-goolf-1.7.20/lib:/pstore/apps/libtasn1/4.7-goolf-1.7.20/lib:/pstore/apps/guile/1.8.8-goolf-1.7.20/lib:/pstore/apps/libunistring/0.9.3-goolf-1.7.20/lib:/pstore/apps/libtool/2.4.6-goolf-1.7.20/lib:/pstore/apps/nettle/3.1.1-goolf-1.7.20/lib64:/pstore/apps/GMP/5.0.5-goolf-1.7.20/lib:/pstore/apps/gettext/0.18.2-goolf-1.7.20/lib:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib64:/pstore/apps/libffi/3.2.1-goolf-1.7.20/lib:/pstore/apps/fontconfig/2.12.1-goolf-1.7.20/lib:/pstore/apps/freetype/2.6.5-goolf-1.7.20/lib:/pstore/apps/expat/2.2.0-goolf-1.7.20/lib:/pstore/apps/libxml2/2.9.2-goolf-1.7.20/lib:/pstore/apps/cURL/7.43.0-goolf-1.7.20/lib:/pstore/apps/Tk/8.6.4-goolf-1.7.20-no-X11/lib:/pstore/apps/Tcl/8.6.4-goolf-1.7.20/lib:/pstore/apps/libtiff/4.0.6-goolf-1.7.20/lib:/pstore/apps/libjpeg-turbo/1.4.2-goolf-1.7.20/lib:/pstore/apps/libpng/1.6.19-goolf-1.7.20/lib:/pstore/apps/zlib/1.2.8-goolf-1.7.20/lib:/pstore/apps/libreadline/6.3-goolf-1.7.20/lib:/pstore/apps/ncurses/5.9-goolf-1.7.20/lib:/pstore/apps/GSL/2.1-goolf-1.7.20/lib:/pstore/apps/icu4c/58_2-src-goolf-1.7.20/lib:/pstore/apps/ScaLAPACK/2.0.2-gompi-1.7.20-OpenBLAS-0.2.13-LAPACK-3.5.0/lib:/pstore/apps/FFTW/3.3.4-gompi-1.7.20/lib:/pstore/apps/OpenBLAS/0.2.13-GCC-4.8.4-LAPACK-3.5.0/lib:/pstore/apps/OpenMPI/1.8.8-GCC-4.8.4/lib:/pstore/apps/hwloc/1.10.1-GCC-4.8.4/lib:/pstore/apps/numactl/2.0.10-GCC-4.8.4/lib:/pstore/apps/GCC/4.8.4/lib/gcc/x86_64-unknown-linux-gnu/4.8.4:/pstore/apps/GCC/4.8.4/lib64:/pstore/apps/GCC/4.8.4/lib:/pstore/apps/binutils/2.25/lib:/cm/shared/apps/slurm/17.02.7/lib64/slurm:/cm/shared/apps/slurm/17.02.7/lib64:/pstore/home/nagakamd/.conda/envs/r-tensorflow/lib:@JAVA_LD@
2021-11-29 01:52:53.748041: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1753] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2021-11-29 01:52:53.748659: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-11-29 01:52:53.759250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 2400000000 Hz
2021-11-29 01:52:53.760125: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x19c44920 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-11-29 01:52:53.760153: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-11-29 01:52:53.761983: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1257] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-11-29 01:52:53.762006: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1263]      

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 3.0571 - binary_accuracy: 0.7188 - balanced_acc: 0.4814 6/19 [========>.....................] - ETA: 0s - loss: 3.7870 - binary_accuracy: 0.8698 - balanced_acc: 0.496912/19 [=================>............] - ETA: 0s - loss: 2.9306 - binary_accuracy: 0.8958 - balanced_acc: 0.498418/19 [===========================>..] - ETA: 0s - loss: 2.5306 - binary_accuracy: 0.9080 - balanced_acc: 0.49902021-11-29 01:52:55.308942: W tensorflow/python/util/util.cc:348] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
19/19 [==============================] - 1s 58ms/step - loss: 2.5106 - binary_accuracy: 0.9075 - balanced_acc: 0.4990 - val_loss: 1.4142 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.3658 - binary_accuracy: 0.9531 - balanced_acc: 0.5000 7/19 [==========>...................] - ETA: 0s - loss: 1.2593 - binary_accuracy: 0.9174 - balanced_acc: 0.498813/19 [===================>..........] - ETA: 0s - loss: 1.1579 - binary_accuracy: 0.9087 - balanced_acc: 0.518019/19 [==============================] - ETA: 0s - loss: 1.0401 - binary_accuracy: 0.9194 - balanced_acc: 0.531619/19 [==============================] - 0s 15ms/step - loss: 1.0401 - binary_accuracy: 0.9194 - balanced_acc: 0.5316 - val_loss: 0.7183 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6952 - binary_accuracy: 0.8906 - balanced_acc: 0.5000 7/19 [==========>...................] - ETA: 0s - loss: 0.6088 - binary_accuracy: 0.9308 - balanced_acc: 0.567413/19 [===================>..........] - ETA: 0s - loss: 0.5698 - binary_accuracy: 0.9339 - balanced_acc: 0.637019/19 [==============================] - 1s 47ms/step - loss: 0.5501 - binary_accuracy: 0.9304 - balanced_acc: 0.6125 - val_loss: 0.4734 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6649
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4627 - binary_accuracy: 0.9375 - balanced_acc: 0.8087 7/19 [==========>...................] - ETA: 0s - loss: 0.4000 - binary_accuracy: 0.9420 - balanced_acc: 0.596513/19 [===================>..........] - ETA: 0s - loss: 0.3889 - binary_accuracy: 0.9363 - balanced_acc: 0.618619/19 [==============================] - 0s 10ms/step - loss: 0.3964 - binary_accuracy: 0.9304 - balanced_acc: 0.6445 - val_loss: 0.3515 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5667
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3427 - binary_accuracy: 0.9219 - balanced_acc: 0.6429 7/19 [==========>...................] - ETA: 0s - loss: 0.2863 - binary_accuracy: 0.9598 - balanced_acc: 0.810613/19 [===================>..........] - ETA: 0s - loss: 0.3025 - binary_accuracy: 0.9495 - balanced_acc: 0.799519/19 [==============================] - ETA: 0s - loss: 0.3036 - binary_accuracy: 0.9449 - balanced_acc: 0.769719/19 [==============================] - 0s 11ms/step - loss: 0.3036 - binary_accuracy: 0.9449 - balanced_acc: 0.7697 - val_loss: 0.3252 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6317
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3170 - binary_accuracy: 0.9219 - balanced_acc: 0.6875 7/19 [==========>...................] - ETA: 0s - loss: 0.2795 - binary_accuracy: 0.9420 - balanced_acc: 0.762113/19 [===================>..........] - ETA: 0s - loss: 0.2825 - binary_accuracy: 0.9423 - balanced_acc: 0.753519/19 [==============================] - ETA: 0s - loss: 0.2752 - binary_accuracy: 0.9474 - balanced_acc: 0.753319/19 [==============================] - 0s 10ms/step - loss: 0.2752 - binary_accuracy: 0.9474 - balanced_acc: 0.7533 - val_loss: 0.3257 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5417
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2549 - binary_accuracy: 0.9375 - balanced_acc: 0.6667 7/19 [==========>...................] - ETA: 0s - loss: 0.2107 - binary_accuracy: 0.9554 - balanced_acc: 0.748013/19 [===================>..........] - ETA: 0s - loss: 0.2244 - binary_accuracy: 0.9531 - balanced_acc: 0.780219/19 [==============================] - ETA: 0s - loss: 0.2250 - binary_accuracy: 0.9525 - balanced_acc: 0.786519/19 [==============================] - 1s 42ms/step - loss: 0.2250 - binary_accuracy: 0.9525 - balanced_acc: 0.7865 - val_loss: 0.2819 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6742
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1417 - binary_accuracy: 0.9844 - balanced_acc: 0.8333 7/19 [==========>...................] - ETA: 0s - loss: 0.2176 - binary_accuracy: 0.9598 - balanced_acc: 0.863213/19 [===================>..........] - ETA: 0s - loss: 0.1980 - binary_accuracy: 0.9651 - balanced_acc: 0.859219/19 [==============================] - ETA: 0s - loss: 0.1948 - binary_accuracy: 0.9644 - balanced_acc: 0.813119/19 [==============================] - 0s 10ms/step - loss: 0.1948 - binary_accuracy: 0.9644 - balanced_acc: 0.8131 - val_loss: 0.2995 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5871
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1748 - binary_accuracy: 0.9688 - balanced_acc: 0.8000 7/19 [==========>...................] - ETA: 0s - loss: 0.1499 - binary_accuracy: 0.9799 - balanced_acc: 0.881013/19 [===================>..........] - ETA: 0s - loss: 0.1583 - binary_accuracy: 0.9748 - balanced_acc: 0.895919/19 [==============================] - ETA: 0s - loss: 0.1720 - binary_accuracy: 0.9686 - balanced_acc: 0.879019/19 [==============================] - 0s 11ms/step - loss: 0.1720 - binary_accuracy: 0.9686 - balanced_acc: 0.8790 - val_loss: 0.3009 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6671
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1583 - binary_accuracy: 0.9688 - balanced_acc: 0.9831 7/19 [==========>...................] - ETA: 0s - loss: 0.1543 - binary_accuracy: 0.9754 - balanced_acc: 0.902213/19 [===================>..........] - ETA: 0s - loss: 0.1818 - binary_accuracy: 0.9736 - balanced_acc: 0.906219/19 [==============================] - ETA: 0s - loss: 0.2028 - binary_accuracy: 0.9652 - balanced_acc: 0.873819/19 [==============================] - 0s 11ms/step - loss: 0.2028 - binary_accuracy: 0.9652 - balanced_acc: 0.8738 - val_loss: 0.2777 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6615
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2004 - binary_accuracy: 0.9531 - balanced_acc: 0.8247 7/19 [==========>...................] - ETA: 0s - loss: 0.1812 - binary_accuracy: 0.9732 - balanced_acc: 0.870613/19 [===================>..........] - ETA: 0s - loss: 0.1803 - binary_accuracy: 0.9700 - balanced_acc: 0.877019/19 [==============================] - ETA: 0s - loss: 0.1832 - binary_accuracy: 0.9661 - balanced_acc: 0.868019/19 [==============================] - 1s 44ms/step - loss: 0.1832 - binary_accuracy: 0.9661 - balanced_acc: 0.8680 - val_loss: 0.2785 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7071
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2079 - binary_accuracy: 0.9531 - balanced_acc: 0.7500 7/19 [==========>...................] - ETA: 0s - loss: 0.1726 - binary_accuracy: 0.9665 - balanced_acc: 0.841513/19 [===================>..........] - ETA: 0s - loss: 0.1770 - binary_accuracy: 0.9639 - balanced_acc: 0.849219/19 [==============================] - ETA: 0s - loss: 0.1847 - binary_accuracy: 0.9635 - balanced_acc: 0.868219/19 [==============================] - 1s 46ms/step - loss: 0.1847 - binary_accuracy: 0.9635 - balanced_acc: 0.8682 - val_loss: 0.2796 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7154
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2129 - binary_accuracy: 0.9531 - balanced_acc: 0.8831 6/19 [========>.....................] - ETA: 0s - loss: 0.1737 - binary_accuracy: 0.9688 - balanced_acc: 0.849812/19 [=================>............] - ETA: 0s - loss: 0.1685 - binary_accuracy: 0.9701 - balanced_acc: 0.840618/19 [===========================>..] - ETA: 0s - loss: 0.1874 - binary_accuracy: 0.9627 - balanced_acc: 0.851519/19 [==============================] - 0s 11ms/step - loss: 0.1862 - binary_accuracy: 0.9627 - balanced_acc: 0.8583 - val_loss: 0.2810 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6621
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2426 - binary_accuracy: 0.9531 - balanced_acc: 0.7915 7/19 [==========>...................] - ETA: 0s - loss: 0.1816 - binary_accuracy: 0.9554 - balanced_acc: 0.830313/19 [===================>..........] - ETA: 0s - loss: 0.1889 - binary_accuracy: 0.9579 - balanced_acc: 0.854519/19 [==============================] - ETA: 0s - loss: 0.1844 - binary_accuracy: 0.9610 - balanced_acc: 0.854619/19 [==============================] - 0s 11ms/step - loss: 0.1844 - binary_accuracy: 0.9610 - balanced_acc: 0.8546 - val_loss: 0.3389 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6738
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1789 - binary_accuracy: 0.9688 - balanced_acc: 0.8251 7/19 [==========>...................] - ETA: 0s - loss: 0.1944 - binary_accuracy: 0.9621 - balanced_acc: 0.802613/19 [===================>..........] - ETA: 0s - loss: 0.1951 - binary_accuracy: 0.9627 - balanced_acc: 0.802619/19 [==============================] - ETA: 0s - loss: 0.1967 - binary_accuracy: 0.9627 - balanced_acc: 0.840219/19 [==============================] - 0s 11ms/step - loss: 0.1967 - binary_accuracy: 0.9627 - balanced_acc: 0.8402 - val_loss: 0.3086 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6474
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2057 - binary_accuracy: 0.9531 - balanced_acc: 0.8484 6/19 [========>.....................] - ETA: 0s - loss: 0.2065 - binary_accuracy: 0.9531 - balanced_acc: 0.826412/19 [=================>............] - ETA: 0s - loss: 0.1956 - binary_accuracy: 0.9596 - balanced_acc: 0.860418/19 [===========================>..] - ETA: 0s - loss: 0.1875 - binary_accuracy: 0.9644 - balanced_acc: 0.853719/19 [==============================] - 0s 12ms/step - loss: 0.1858 - binary_accuracy: 0.9652 - balanced_acc: 0.8351 - val_loss: 0.3457 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5804
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1864 - binary_accuracy: 0.9375 - balanced_acc: 0.8182 6/19 [========>.....................] - ETA: 0s - loss: 0.1750 - binary_accuracy: 0.9740 - balanced_acc: 0.909912/19 [=================>............] - ETA: 0s - loss: 0.1727 - binary_accuracy: 0.9714 - balanced_acc: 0.907017/19 [=========================>....] - ETA: 0s - loss: 0.1728 - binary_accuracy: 0.9697 - balanced_acc: 0.899419/19 [==============================] - 0s 12ms/step - loss: 0.1736 - binary_accuracy: 0.9686 - balanced_acc: 0.8761 - val_loss: 0.2749 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6437
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1272 - binary_accuracy: 0.9844 - balanced_acc: 0.9914 7/19 [==========>...................] - ETA: 0s - loss: 0.1532 - binary_accuracy: 0.9688 - balanced_acc: 0.906413/19 [===================>..........] - ETA: 0s - loss: 0.1624 - binary_accuracy: 0.9688 - balanced_acc: 0.862519/19 [==============================] - ETA: 0s - loss: 0.1677 - binary_accuracy: 0.9652 - balanced_acc: 0.865319/19 [==============================] - 0s 11ms/step - loss: 0.1677 - binary_accuracy: 0.9652 - balanced_acc: 0.8653 - val_loss: 0.3620 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.5204
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1585 - binary_accuracy: 0.9688 - balanced_acc: 0.8667 7/19 [==========>...................] - ETA: 0s - loss: 0.1617 - binary_accuracy: 0.9710 - balanced_acc: 0.827113/19 [===================>..........] - ETA: 0s - loss: 0.1884 - binary_accuracy: 0.9579 - balanced_acc: 0.821319/19 [==============================] - ETA: 0s - loss: 0.1878 - binary_accuracy: 0.9601 - balanced_acc: 0.832219/19 [==============================] - 0s 10ms/step - loss: 0.1878 - binary_accuracy: 0.9601 - balanced_acc: 0.8322 - val_loss: 0.2847 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6992
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1837 - binary_accuracy: 0.9531 - balanced_acc: 0.8994 7/19 [==========>...................] - ETA: 0s - loss: 0.1662 - binary_accuracy: 0.9688 - balanced_acc: 0.922813/19 [===================>..........] - ETA: 0s - loss: 0.1714 - binary_accuracy: 0.9700 - balanced_acc: 0.867619/19 [==============================] - ETA: 0s - loss: 0.1625 - binary_accuracy: 0.9746 - balanced_acc: 0.896519/19 [==============================] - 0s 11ms/step - loss: 0.1625 - binary_accuracy: 0.9746 - balanced_acc: 0.8965 - val_loss: 0.3508 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6454
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1618 - binary_accuracy: 0.9688 - balanced_acc: 0.9198 7/19 [==========>...................] - ETA: 0s - loss: 0.1565 - binary_accuracy: 0.9732 - balanced_acc: 0.886113/19 [===================>..........] - ETA: 0s - loss: 0.1537 - binary_accuracy: 0.9724 - balanced_acc: 0.903219/19 [==============================] - ETA: 0s - loss: 0.1727 - binary_accuracy: 0.9712 - balanced_acc: 0.885819/19 [==============================] - 0s 10ms/step - loss: 0.1727 - binary_accuracy: 0.9712 - balanced_acc: 0.8858 - val_loss: 0.2838 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6221
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1485 - binary_accuracy: 0.9688 - balanced_acc: 0.9286 7/19 [==========>...................] - ETA: 0s - loss: 0.1588 - binary_accuracy: 0.9710 - balanced_acc: 0.945213/19 [===================>..........] - ETA: 0s - loss: 0.1699 - binary_accuracy: 0.9688 - balanced_acc: 0.911419/19 [==============================] - ETA: 0s - loss: 0.1893 - binary_accuracy: 0.9669 - balanced_acc: 0.890919/19 [==============================] - 1s 46ms/step - loss: 0.1893 - binary_accuracy: 0.9669 - balanced_acc: 0.8909 - val_loss: 0.2864 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7603
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1996 - binary_accuracy: 0.9531 - balanced_acc: 0.9737 7/19 [==========>...................] - ETA: 0s - loss: 0.1849 - binary_accuracy: 0.9598 - balanced_acc: 0.899813/19 [===================>..........] - ETA: 0s - loss: 0.1814 - binary_accuracy: 0.9615 - balanced_acc: 0.861319/19 [==============================] - ETA: 0s - loss: 0.1885 - binary_accuracy: 0.9559 - balanced_acc: 0.840819/19 [==============================] - 0s 11ms/step - loss: 0.1885 - binary_accuracy: 0.9559 - balanced_acc: 0.8408 - val_loss: 0.2777 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7329
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1523 - binary_accuracy: 0.9844 - balanced_acc: 0.9914 7/19 [==========>...................] - ETA: 0s - loss: 0.1662 - binary_accuracy: 0.9732 - balanced_acc: 0.881813/19 [===================>..........] - ETA: 0s - loss: 0.1633 - binary_accuracy: 0.9724 - balanced_acc: 0.862219/19 [==============================] - ETA: 0s - loss: 0.1647 - binary_accuracy: 0.9720 - balanced_acc: 0.885019/19 [==============================] - 0s 10ms/step - loss: 0.1647 - binary_accuracy: 0.9720 - balanced_acc: 0.8850 - val_loss: 0.2725 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6783
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1406 - binary_accuracy: 0.9844 - balanced_acc: 0.9911 7/19 [==========>...................] - ETA: 0s - loss: 0.1396 - binary_accuracy: 0.9777 - balanced_acc: 0.912513/19 [===================>..........] - ETA: 0s - loss: 0.1531 - binary_accuracy: 0.9760 - balanced_acc: 0.909319/19 [==============================] - ETA: 0s - loss: 0.1653 - binary_accuracy: 0.9703 - balanced_acc: 0.908619/19 [==============================] - 0s 11ms/step - loss: 0.1653 - binary_accuracy: 0.9703 - balanced_acc: 0.9086 - val_loss: 0.2862 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6521
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1055 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1510 - binary_accuracy: 0.9732 - balanced_acc: 0.910413/19 [===================>..........] - ETA: 0s - loss: 0.1615 - binary_accuracy: 0.9675 - balanced_acc: 0.887019/19 [==============================] - ETA: 0s - loss: 0.1627 - binary_accuracy: 0.9686 - balanced_acc: 0.880619/19 [==============================] - 0s 10ms/step - loss: 0.1627 - binary_accuracy: 0.9686 - balanced_acc: 0.8806 - val_loss: 0.3250 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6404
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1624 - binary_accuracy: 0.9844 - balanced_acc: 0.9914 7/19 [==========>...................] - ETA: 0s - loss: 0.1547 - binary_accuracy: 0.9777 - balanced_acc: 0.875013/19 [===================>..........] - ETA: 0s - loss: 0.1754 - binary_accuracy: 0.9760 - balanced_acc: 0.867819/19 [==============================] - ETA: 0s - loss: 0.1738 - binary_accuracy: 0.9737 - balanced_acc: 0.891519/19 [==============================] - 0s 10ms/step - loss: 0.1738 - binary_accuracy: 0.9737 - balanced_acc: 0.8915 - val_loss: 0.3074 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7431
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1786 - binary_accuracy: 0.9531 - balanced_acc: 0.8125 7/19 [==========>...................] - ETA: 0s - loss: 0.1394 - binary_accuracy: 0.9866 - balanced_acc: 0.939913/19 [===================>..........] - ETA: 0s - loss: 0.1603 - binary_accuracy: 0.9832 - balanced_acc: 0.929119/19 [==============================] - ETA: 0s - loss: 0.1690 - binary_accuracy: 0.9788 - balanced_acc: 0.920219/19 [==============================] - 0s 10ms/step - loss: 0.1690 - binary_accuracy: 0.9788 - balanced_acc: 0.9202 - val_loss: 0.2985 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7569
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1414 - binary_accuracy: 0.9844 - balanced_acc: 0.9915 7/19 [==========>...................] - ETA: 0s - loss: 0.1399 - binary_accuracy: 0.9821 - balanced_acc: 0.955212/19 [=================>............] - ETA: 0s - loss: 0.1531 - binary_accuracy: 0.9779 - balanced_acc: 0.933717/19 [=========================>....] - ETA: 0s - loss: 0.1572 - binary_accuracy: 0.9770 - balanced_acc: 0.921319/19 [==============================] - 0s 12ms/step - loss: 0.1577 - binary_accuracy: 0.9763 - balanced_acc: 0.9209 - val_loss: 0.3082 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6733
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1399 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1702 - binary_accuracy: 0.9799 - balanced_acc: 0.914113/19 [===================>..........] - ETA: 0s - loss: 0.1684 - binary_accuracy: 0.9760 - balanced_acc: 0.946719/19 [==============================] - ETA: 0s - loss: 0.1727 - binary_accuracy: 0.9737 - balanced_acc: 0.914719/19 [==============================] - 0s 10ms/step - loss: 0.1727 - binary_accuracy: 0.9737 - balanced_acc: 0.9147 - val_loss: 0.4087 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5638
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1103 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1565 - binary_accuracy: 0.9732 - balanced_acc: 0.853613/19 [===================>..........] - ETA: 0s - loss: 0.1660 - binary_accuracy: 0.9700 - balanced_acc: 0.863719/19 [==============================] - 0s 10ms/step - loss: 0.1657 - binary_accuracy: 0.9729 - balanced_acc: 0.8620 - val_loss: 0.3524 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6066
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2048 - binary_accuracy: 0.9375 - balanced_acc: 0.7414 7/19 [==========>...................] - ETA: 0s - loss: 0.1848 - binary_accuracy: 0.9598 - balanced_acc: 0.862012/19 [=================>............] - ETA: 0s - loss: 0.1668 - binary_accuracy: 0.9674 - balanced_acc: 0.884718/19 [===========================>..] - ETA: 0s - loss: 0.1667 - binary_accuracy: 0.9661 - balanced_acc: 0.865019/19 [==============================] - 0s 11ms/step - loss: 0.1656 - binary_accuracy: 0.9669 - balanced_acc: 0.8721 - val_loss: 0.2958 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7030
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1877 - binary_accuracy: 0.9375 - balanced_acc: 0.9677 7/19 [==========>...................] - ETA: 0s - loss: 0.1642 - binary_accuracy: 0.9710 - balanced_acc: 0.977713/19 [===================>..........] - ETA: 0s - loss: 0.1514 - binary_accuracy: 0.9760 - balanced_acc: 0.974019/19 [==============================] - ETA: 0s - loss: 0.1565 - binary_accuracy: 0.9737 - balanced_acc: 0.956119/19 [==============================] - 0s 11ms/step - loss: 0.1565 - binary_accuracy: 0.9737 - balanced_acc: 0.9561 - val_loss: 0.3122 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6292
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1066 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1204 - binary_accuracy: 0.9888 - balanced_acc: 0.937513/19 [===================>..........] - ETA: 0s - loss: 0.1268 - binary_accuracy: 0.9856 - balanced_acc: 0.945419/19 [==============================] - ETA: 0s - loss: 0.1263 - binary_accuracy: 0.9856 - balanced_acc: 0.953819/19 [==============================] - 0s 10ms/step - loss: 0.1263 - binary_accuracy: 0.9856 - balanced_acc: 0.9538 - val_loss: 0.3238 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6116
Epoch 35/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1182 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1268 - binary_accuracy: 0.9844 - balanced_acc: 0.823813/19 [===================>..........] - ETA: 0s - loss: 0.1299 - binary_accuracy: 0.9820 - balanced_acc: 0.876119/19 [==============================] - ETA: 0s - loss: 0.1312 - binary_accuracy: 0.9805 - balanced_acc: 0.897119/19 [==============================] - 0s 10ms/step - loss: 0.1312 - binary_accuracy: 0.9805 - balanced_acc: 0.8971 - val_loss: 0.3126 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6737
Epoch 36/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1185 - binary_accuracy: 0.9844 - balanced_acc: 0.9921 7/19 [==========>...................] - ETA: 0s - loss: 0.1195 - binary_accuracy: 0.9911 - balanced_acc: 0.984412/19 [=================>............] - ETA: 0s - loss: 0.1209 - binary_accuracy: 0.9909 - balanced_acc: 0.988718/19 [===========================>..] - ETA: 0s - loss: 0.1189 - binary_accuracy: 0.9896 - balanced_acc: 0.981419/19 [==============================] - 0s 10ms/step - loss: 0.1202 - binary_accuracy: 0.9890 - balanced_acc: 0.9758 - val_loss: 0.3122 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 37/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1322 - binary_accuracy: 0.9844 - balanced_acc: 0.9907 6/19 [========>.....................] - ETA: 0s - loss: 0.1105 - binary_accuracy: 0.9922 - balanced_acc: 0.995613/19 [===================>..........] - ETA: 0s - loss: 0.1087 - binary_accuracy: 0.9940 - balanced_acc: 0.996718/19 [===========================>..] - ETA: 0s - loss: 0.1100 - binary_accuracy: 0.9939 - balanced_acc: 0.996719/19 [==============================] - 0s 11ms/step - loss: 0.1104 - binary_accuracy: 0.9941 - balanced_acc: 0.9969 - val_loss: 0.3150 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6088
Epoch 38/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0868 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1027 - binary_accuracy: 0.9978 - balanced_acc: 0.998814/19 [=====================>........] - ETA: 0s - loss: 0.1056 - binary_accuracy: 0.9978 - balanced_acc: 0.998819/19 [==============================] - 0s 10ms/step - loss: 0.1090 - binary_accuracy: 0.9941 - balanced_acc: 0.9930 - val_loss: 0.3118 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6088
Epoch 39/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0885 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1071 - binary_accuracy: 0.9933 - balanced_acc: 0.985713/19 [===================>..........] - ETA: 0s - loss: 0.1051 - binary_accuracy: 0.9940 - balanced_acc: 0.979519/19 [==============================] - 0s 11ms/step - loss: 0.1057 - binary_accuracy: 0.9932 - balanced_acc: 0.9763 - val_loss: 0.3150 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6504
Epoch 40/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0847 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1051 - binary_accuracy: 0.9888 - balanced_acc: 0.980813/19 [===================>..........] - ETA: 0s - loss: 0.1039 - binary_accuracy: 0.9916 - balanced_acc: 0.982618/19 [===========================>..] - ETA: 0s - loss: 0.1030 - binary_accuracy: 0.9922 - balanced_acc: 0.982319/19 [==============================] - 0s 11ms/step - loss: 0.1034 - binary_accuracy: 0.9924 - balanced_acc: 0.9833 - val_loss: 0.3165 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 41/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1064 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1049 - binary_accuracy: 0.9933 - balanced_acc: 0.979713/19 [===================>..........] - ETA: 0s - loss: 0.0993 - binary_accuracy: 0.9952 - balanced_acc: 0.988419/19 [==============================] - ETA: 0s - loss: 0.0987 - binary_accuracy: 0.9949 - balanced_acc: 0.991219/19 [==============================] - 0s 11ms/step - loss: 0.0987 - binary_accuracy: 0.9949 - balanced_acc: 0.9912 - val_loss: 0.3221 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 42/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0991 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0938 - binary_accuracy: 0.9955 - balanced_acc: 0.997613/19 [===================>..........] - ETA: 0s - loss: 0.0949 - binary_accuracy: 0.9940 - balanced_acc: 0.982719/19 [==============================] - ETA: 0s - loss: 0.0938 - binary_accuracy: 0.9932 - balanced_acc: 0.977919/19 [==============================] - 0s 12ms/step - loss: 0.0938 - binary_accuracy: 0.9932 - balanced_acc: 0.9779 - val_loss: 0.3109 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6504
Epoch 43/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0784 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/19 [========>.....................] - ETA: 0s - loss: 0.1032 - binary_accuracy: 0.9870 - balanced_acc: 0.993011/19 [================>.............] - ETA: 0s - loss: 0.1064 - binary_accuracy: 0.9858 - balanced_acc: 0.959717/19 [=========================>....] - ETA: 0s - loss: 0.1027 - binary_accuracy: 0.9890 - balanced_acc: 0.972919/19 [==============================] - 0s 11ms/step - loss: 0.1018 - binary_accuracy: 0.9898 - balanced_acc: 0.9758 - val_loss: 0.3112 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 44/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0924 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.1009 - binary_accuracy: 0.9888 - balanced_acc: 0.980812/19 [=================>............] - ETA: 0s - loss: 0.0988 - binary_accuracy: 0.9909 - balanced_acc: 0.977718/19 [===========================>..] - ETA: 0s - loss: 0.0981 - binary_accuracy: 0.9922 - balanced_acc: 0.984219/19 [==============================] - 0s 12ms/step - loss: 0.0993 - binary_accuracy: 0.9915 - balanced_acc: 0.9840 - val_loss: 0.3120 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 45/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0820 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0834 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0949 - binary_accuracy: 0.9952 - balanced_acc: 0.991619/19 [==============================] - ETA: 0s - loss: 0.0967 - binary_accuracy: 0.9932 - balanced_acc: 0.963419/19 [==============================] - 0s 11ms/step - loss: 0.0967 - binary_accuracy: 0.9932 - balanced_acc: 0.9634 - val_loss: 0.3127 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 46/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1035 - binary_accuracy: 0.9844 - balanced_acc: 0.9286 7/19 [==========>...................] - ETA: 0s - loss: 0.0988 - binary_accuracy: 0.9933 - balanced_acc: 0.974313/19 [===================>..........] - ETA: 0s - loss: 0.0961 - binary_accuracy: 0.9952 - balanced_acc: 0.985519/19 [==============================] - ETA: 0s - loss: 0.0966 - binary_accuracy: 0.9941 - balanced_acc: 0.982619/19 [==============================] - 0s 10ms/step - loss: 0.0966 - binary_accuracy: 0.9941 - balanced_acc: 0.9826 - val_loss: 0.3126 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 47/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0954 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0944 - binary_accuracy: 0.9955 - balanced_acc: 0.997513/19 [===================>..........] - ETA: 0s - loss: 0.0924 - binary_accuracy: 0.9964 - balanced_acc: 0.998019/19 [==============================] - ETA: 0s - loss: 0.0925 - binary_accuracy: 0.9958 - balanced_acc: 0.993019/19 [==============================] - 0s 11ms/step - loss: 0.0925 - binary_accuracy: 0.9958 - balanced_acc: 0.9930 - val_loss: 0.3106 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 48/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0793 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/19 [========>.....................] - ETA: 0s - loss: 0.0894 - binary_accuracy: 0.9974 - balanced_acc: 0.998611/19 [================>.............] - ETA: 0s - loss: 0.0928 - binary_accuracy: 0.9972 - balanced_acc: 0.992716/19 [========================>.....] - ETA: 0s - loss: 0.0937 - binary_accuracy: 0.9971 - balanced_acc: 0.994519/19 [==============================] - 0s 12ms/step - loss: 0.0949 - binary_accuracy: 0.9966 - balanced_acc: 0.9949 - val_loss: 0.3109 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 49/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0995 - binary_accuracy: 0.9844 - balanced_acc: 0.9917 7/19 [==========>...................] - ETA: 0s - loss: 0.1036 - binary_accuracy: 0.9933 - balanced_acc: 0.990513/19 [===================>..........] - ETA: 0s - loss: 0.0989 - binary_accuracy: 0.9940 - balanced_acc: 0.993618/19 [===========================>..] - ETA: 0s - loss: 0.0960 - binary_accuracy: 0.9948 - balanced_acc: 0.994919/19 [==============================] - 0s 12ms/step - loss: 0.0960 - binary_accuracy: 0.9949 - balanced_acc: 0.9952 - val_loss: 0.3131 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 50/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0965 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0884 - binary_accuracy: 0.9978 - balanced_acc: 0.992113/19 [===================>..........] - ETA: 0s - loss: 0.0944 - binary_accuracy: 0.9952 - balanced_acc: 0.988019/19 [==============================] - ETA: 0s - loss: 0.0921 - binary_accuracy: 0.9958 - balanced_acc: 0.991419/19 [==============================] - 0s 11ms/step - loss: 0.0921 - binary_accuracy: 0.9958 - balanced_acc: 0.9914 - val_loss: 0.3134 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 51/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1070 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/19 [========>.....................] - ETA: 0s - loss: 0.1069 - binary_accuracy: 0.9896 - balanced_acc: 0.960612/19 [=================>............] - ETA: 0s - loss: 0.1082 - binary_accuracy: 0.9870 - balanced_acc: 0.966518/19 [===========================>..] - ETA: 0s - loss: 0.1009 - binary_accuracy: 0.9896 - balanced_acc: 0.972519/19 [==============================] - 0s 11ms/step - loss: 0.1005 - binary_accuracy: 0.9898 - balanced_acc: 0.9740 - val_loss: 0.3106 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 52/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0819 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0959 - binary_accuracy: 0.9933 - balanced_acc: 0.996413/19 [===================>..........] - ETA: 0s - loss: 0.0972 - binary_accuracy: 0.9916 - balanced_acc: 0.943119/19 [==============================] - ETA: 0s - loss: 0.0945 - binary_accuracy: 0.9941 - balanced_acc: 0.961119/19 [==============================] - 0s 11ms/step - loss: 0.0945 - binary_accuracy: 0.9941 - balanced_acc: 0.9611 - val_loss: 0.3099 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'
Fontconfig warning: ignoring UTF-8: not a valid region tag

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3906 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 2ms/step - loss: 0.3794 - binary_accuracy: 0.9266 - balanced_acc: 0.5694

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-52-53Z

Training run 2/648 (flags = list(0.2, 1024, 0.3, 128, 512, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-53-11Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.4474 - binary_accuracy: 0.3672 - balanced_acc: 0.579610/10 [==============================] - ETA: 0s - loss: 1.9001 - binary_accuracy: 0.8609 - balanced_acc: 0.508010/10 [==============================] - 1s 85ms/step - loss: 1.9001 - binary_accuracy: 0.8609 - balanced_acc: 0.5080 - val_loss: 1.5652 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.5050 - binary_accuracy: 0.9531 - balanced_acc: 0.500010/10 [==============================] - ETA: 0s - loss: 1.4198 - binary_accuracy: 0.9186 - balanced_acc: 0.500010/10 [==============================] - 0s 8ms/step - loss: 1.4198 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.2204 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.2070 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 1s 70ms/step - loss: 1.0969 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9620 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5352
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8914 - binary_accuracy: 0.9531 - balanced_acc: 0.571410/10 [==============================] - ETA: 0s - loss: 0.8493 - binary_accuracy: 0.9355 - balanced_acc: 0.615810/10 [==============================] - 0s 8ms/step - loss: 0.8493 - binary_accuracy: 0.9355 - balanced_acc: 0.6158 - val_loss: 0.7802 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5352
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7756 - binary_accuracy: 0.8906 - balanced_acc: 0.562210/10 [==============================] - ETA: 0s - loss: 0.6738 - binary_accuracy: 0.9483 - balanced_acc: 0.717910/10 [==============================] - 0s 8ms/step - loss: 0.6738 - binary_accuracy: 0.9483 - balanced_acc: 0.7179 - val_loss: 0.6718 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.5942 - binary_accuracy: 0.9453 - balanced_acc: 0.708310/10 [==============================] - 1s 69ms/step - loss: 0.5405 - binary_accuracy: 0.9661 - balanced_acc: 0.7937 - val_loss: 0.5767 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6106
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.4676 - binary_accuracy: 0.9844 - balanced_acc: 0.900010/10 [==============================] - ETA: 0s - loss: 0.4423 - binary_accuracy: 0.9813 - balanced_acc: 0.897110/10 [==============================] - 1s 76ms/step - loss: 0.4423 - binary_accuracy: 0.9813 - balanced_acc: 0.8971 - val_loss: 0.5056 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6763
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.3858 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 9/10 [==========================>...] - ETA: 0s - loss: 0.3746 - binary_accuracy: 0.9878 - balanced_acc: 0.951510/10 [==============================] - 0s 8ms/step - loss: 0.3734 - binary_accuracy: 0.9881 - balanced_acc: 0.9564 - val_loss: 0.5113 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5671
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.3314 - binary_accuracy: 0.9922 - balanced_acc: 0.928610/10 [==============================] - ETA: 0s - loss: 0.3228 - binary_accuracy: 0.9881 - balanced_acc: 0.955410/10 [==============================] - 0s 8ms/step - loss: 0.3228 - binary_accuracy: 0.9881 - balanced_acc: 0.9554 - val_loss: 0.4582 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5940
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2785 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.2871 - binary_accuracy: 0.9873 - balanced_acc: 0.947810/10 [==============================] - 0s 8ms/step - loss: 0.2871 - binary_accuracy: 0.9873 - balanced_acc: 0.9478 - val_loss: 0.4070 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6668
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2454 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.2553 - binary_accuracy: 0.9898 - balanced_acc: 0.962110/10 [==============================] - 0s 8ms/step - loss: 0.2553 - binary_accuracy: 0.9898 - balanced_acc: 0.9621 - val_loss: 0.4387 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5519
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2220 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.2645 - binary_accuracy: 0.9830 - balanced_acc: 0.908010/10 [==============================] - 0s 8ms/step - loss: 0.2645 - binary_accuracy: 0.9830 - balanced_acc: 0.9080 - val_loss: 0.4130 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6530
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2739 - binary_accuracy: 0.9922 - balanced_acc: 0.944410/10 [==============================] - ETA: 0s - loss: 0.2433 - binary_accuracy: 0.9830 - balanced_acc: 0.912610/10 [==============================] - 1s 89ms/step - loss: 0.2433 - binary_accuracy: 0.9830 - balanced_acc: 0.9126 - val_loss: 0.3296 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7132
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2019 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 9/10 [==========================>...] - ETA: 0s - loss: 0.1992 - binary_accuracy: 0.9957 - balanced_acc: 0.992610/10 [==============================] - 0s 9ms/step - loss: 0.2006 - binary_accuracy: 0.9949 - balanced_acc: 0.9683 - val_loss: 0.3525 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5809
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1733 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.1801 - binary_accuracy: 0.9924 - balanced_acc: 0.9723 - val_loss: 0.3091 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6045
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1711 - binary_accuracy: 0.9922 - balanced_acc: 0.995610/10 [==============================] - ETA: 0s - loss: 0.1636 - binary_accuracy: 0.9949 - balanced_acc: 0.929610/10 [==============================] - 0s 8ms/step - loss: 0.1636 - binary_accuracy: 0.9949 - balanced_acc: 0.9296 - val_loss: 0.2992 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6966
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1565 - binary_accuracy: 0.9922 - balanced_acc: 0.995710/10 [==============================] - 0s 8ms/step - loss: 0.1469 - binary_accuracy: 0.9975 - balanced_acc: 0.9895 - val_loss: 0.2965 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6781
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1350 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.1344 - binary_accuracy: 0.9983 - balanced_acc: 0.9950 - val_loss: 0.2940 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6609
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1263 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 9/10 [==========================>...] - ETA: 0s - loss: 0.1243 - binary_accuracy: 0.9991 - balanced_acc: 0.995410/10 [==============================] - 1s 71ms/step - loss: 0.1241 - binary_accuracy: 0.9992 - balanced_acc: 0.9958 - val_loss: 0.2726 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7146
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1220 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.1147 - binary_accuracy: 0.9992 - balanced_acc: 0.9950 - val_loss: 0.2867 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6461
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1092 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 3/10 [========>.....................] - ETA: 0s - loss: 0.1076 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 14ms/step - loss: 0.1070 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2704 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6905
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1010 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.1007 - binary_accuracy: 0.9992 - balanced_acc: 0.9962 - val_loss: 0.2772 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6461
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0919 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0982 - binary_accuracy: 0.9975 - balanced_acc: 0.990710/10 [==============================] - 0s 8ms/step - loss: 0.0982 - binary_accuracy: 0.9975 - balanced_acc: 0.9907 - val_loss: 0.2693 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6795
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0904 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0900 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2586 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6604
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0821 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0889 - binary_accuracy: 0.9975 - balanced_acc: 0.988810/10 [==============================] - 0s 9ms/step - loss: 0.0889 - binary_accuracy: 0.9975 - balanced_acc: 0.9888 - val_loss: 0.2617 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6873
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0978 - binary_accuracy: 0.9844 - balanced_acc: 0.991310/10 [==============================] - ETA: 0s - loss: 0.0869 - binary_accuracy: 0.9949 - balanced_acc: 0.981310/10 [==============================] - 0s 8ms/step - loss: 0.0869 - binary_accuracy: 0.9949 - balanced_acc: 0.9813 - val_loss: 0.2360 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7109
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0813 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 1s 71ms/step - loss: 0.0866 - binary_accuracy: 0.9949 - balanced_acc: 0.9754 - val_loss: 0.2490 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7432
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0764 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0889 - binary_accuracy: 0.9941 - balanced_acc: 0.977910/10 [==============================] - 1s 71ms/step - loss: 0.0889 - binary_accuracy: 0.9941 - balanced_acc: 0.9779 - val_loss: 0.2450 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7479
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0815 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0834 - binary_accuracy: 0.9958 - balanced_acc: 0.9825 - val_loss: 0.2951 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5457
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0838 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0788 - binary_accuracy: 0.9975 - balanced_acc: 0.9988 - val_loss: 0.2911 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6244
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0812 - binary_accuracy: 0.9922 - balanced_acc: 0.944410/10 [==============================] - 1s 88ms/step - loss: 0.0791 - binary_accuracy: 0.9966 - balanced_acc: 0.9328 - val_loss: 0.2604 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7803
Epoch 32/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0697 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0763 - binary_accuracy: 0.9966 - balanced_acc: 0.9874 - val_loss: 0.2650 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7299
Epoch 33/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0823 - binary_accuracy: 0.9922 - balanced_acc: 0.995710/10 [==============================] - ETA: 0s - loss: 0.0760 - binary_accuracy: 0.9975 - balanced_acc: 0.989510/10 [==============================] - 0s 8ms/step - loss: 0.0760 - binary_accuracy: 0.9975 - balanced_acc: 0.9895 - val_loss: 0.2764 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7399
Epoch 34/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0631 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0769 - binary_accuracy: 0.9966 - balanced_acc: 0.9903 - val_loss: 0.2531 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6368
Epoch 35/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0670 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 0s 8ms/step - loss: 0.0743 - binary_accuracy: 0.9949 - balanced_acc: 0.9911 - val_loss: 0.2418 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7304
Epoch 36/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0602 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0651 - binary_accuracy: 0.9983 - balanced_acc: 0.9968 - val_loss: 0.2833 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6429
Epoch 37/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0677 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0708 - binary_accuracy: 0.9958 - balanced_acc: 0.9825 - val_loss: 0.2467 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6795
Epoch 38/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0592 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0655 - binary_accuracy: 0.9992 - balanced_acc: 0.995010/10 [==============================] - 0s 8ms/step - loss: 0.0655 - binary_accuracy: 0.9992 - balanced_acc: 0.9950 - val_loss: 0.2683 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6054
Epoch 39/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0612 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.0666 - binary_accuracy: 0.9983 - balanced_acc: 0.9964 - val_loss: 0.2518 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6738
Epoch 40/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0565 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0660 - binary_accuracy: 0.9975 - balanced_acc: 0.9958 - val_loss: 0.2592 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6600
Epoch 41/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0568 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0723 - binary_accuracy: 0.9958 - balanced_acc: 0.9911 - val_loss: 0.2789 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6225
Epoch 42/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0588 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 9/10 [==========================>...] - ETA: 0s - loss: 0.0645 - binary_accuracy: 0.9983 - balanced_acc: 0.985210/10 [==============================] - 0s 8ms/step - loss: 0.0644 - binary_accuracy: 0.9983 - balanced_acc: 0.9867 - val_loss: 0.2664 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6183
Epoch 43/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0569 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.0598 - binary_accuracy: 0.9992 - balanced_acc: 0.9917 - val_loss: 0.2517 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6183
Epoch 44/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0567 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0579 - binary_accuracy: 0.9992 - balanced_acc: 0.9955 - val_loss: 0.2510 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6614
Epoch 45/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0555 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0570 - binary_accuracy: 1.0000 - balanced_acc: 0.950010/10 [==============================] - 0s 8ms/step - loss: 0.0570 - binary_accuracy: 1.0000 - balanced_acc: 0.9500 - val_loss: 0.2506 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 46/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0567 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0557 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2525 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6795
Epoch 47/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0556 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2505 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6795
Epoch 48/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0541 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0545 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0545 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2502 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 49/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0564 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0546 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2501 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6614
Epoch 50/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0542 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.0535 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2534 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 51/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0549 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0539 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2525 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 52/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0523 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2521 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 53/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0511 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0527 - binary_accuracy: 1.0000 - balanced_acc: 0.9500 - val_loss: 0.2512 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 54/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0542 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0531 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0531 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2509 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 55/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0534 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0534 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0534 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2508 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 56/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0520 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2504 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6628
Epoch 57/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0509 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0530 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2500 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6614
Epoch 58/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0525 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.0534 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0534 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2495 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6614
Epoch 59/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0568 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0536 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2492 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6614
Epoch 60/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.0529 - binary_accuracy: 1.0000 - balanced_acc: 0.9500 - val_loss: 0.2490 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6614
Epoch 61/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0535 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.0525 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2490 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6614

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.4300 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3677 - binary_accuracy: 0.9158 - balanced_acc: 0.5764

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-53-11Z

Training run 3/648 (flags = list(0.2, 2048, 0.4, 256, 512, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-53-24Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 2.9448 - binary_accuracy: 0.2422 - balanced_acc: 0.40745/5 [==============================] - 1s 178ms/step - loss: 2.7591 - binary_accuracy: 0.7303 - balanced_acc: 0.4924 - val_loss: 2.5237 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 2.5162 - binary_accuracy: 0.9297 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 2.4698 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.4044 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 2.4099 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.3998 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.3738 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 2.3059 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 2.3713 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.3422 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 2.3784 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.3277 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.2958 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 2.3522 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.2786 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.2473 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 2.2437 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.2324 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.2042 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 2.2116 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.1901 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1646 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1184 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.1470 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1258 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0840 - binary_accuracy: 0.9336 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1070 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0864 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0590 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.0650 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0476 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0316 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.0355 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0438 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0272 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.0339 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0399 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0149 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.0286 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0361 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0210 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 2.0247 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0323 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0376 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.0210 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0284 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0312 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 17ms/step - loss: 2.0187 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0246 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0349 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.0126 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0207 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9595 - binary_accuracy: 0.9414 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 2.0069 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0168 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0252 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 2.0032 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0129 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9992 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 1.9988 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0090 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0253 - binary_accuracy: 0.9062 - balanced_acc: 0.52005/5 [==============================] - 0s 15ms/step - loss: 1.9950 - binary_accuracy: 0.9194 - balanced_acc: 0.5040 - val_loss: 2.0086 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9728 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 1.9978 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0082 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9973 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 17ms/step - loss: 1.9963 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0078 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9838 - binary_accuracy: 0.9219 - balanced_acc: 0.52385/5 [==============================] - 0s 15ms/step - loss: 1.9941 - binary_accuracy: 0.9203 - balanced_acc: 0.5100 - val_loss: 2.0074 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0342 - binary_accuracy: 0.9062 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 1.9926 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0070 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9890 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 1.9961 - binary_accuracy: 0.9194 - balanced_acc: 0.5042 - val_loss: 2.0066 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9824 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 1.9940 - binary_accuracy: 0.9194 - balanced_acc: 0.5045 - val_loss: 2.0062 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9751 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 1.9948 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0058 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0354 - binary_accuracy: 0.8867 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 1.9913 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0054 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0064 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 1.9969 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0049 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 2.0118 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 2ms/step - loss: 1.9831 - binary_accuracy: 0.9402 - balanced_acc: 0.5000

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-53-24Z

Training run 4/648 (flags = list(0.1, 1024, 0.4, 256, 2048, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-53-30Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 3.0519 - binary_accuracy: 0.6719 - balanced_acc: 0.48675/5 [==============================] - ETA: 0s - loss: 4.2108 - binary_accuracy: 0.8668 - balanced_acc: 0.49735/5 [==============================] - 1s 186ms/step - loss: 4.2108 - binary_accuracy: 0.8668 - balanced_acc: 0.4973 - val_loss: 2.3284 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 2.3267 - binary_accuracy: 0.9297 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.2002 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0581 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0371 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 1.9327 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.6322 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 1.5802 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - ETA: 0s - loss: 1.4907 - binary_accuracy: 0.9194 - balanced_acc: 0.50485/5 [==============================] - 0s 17ms/step - loss: 1.4907 - binary_accuracy: 0.9194 - balanced_acc: 0.5048 - val_loss: 1.2704 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 1.2504 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 1s 185ms/step - loss: 1.1125 - binary_accuracy: 0.9177 - balanced_acc: 0.5256 - val_loss: 0.9639 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.5779
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9197 - binary_accuracy: 0.9375 - balanced_acc: 0.71575/5 [==============================] - ETA: 0s - loss: 0.8037 - binary_accuracy: 0.9576 - balanced_acc: 0.78905/5 [==============================] - 1s 147ms/step - loss: 0.8037 - binary_accuracy: 0.9576 - balanced_acc: 0.7890 - val_loss: 0.7742 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6404
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 0.6251 - binary_accuracy: 0.9844 - balanced_acc: 0.90005/5 [==============================] - 0s 16ms/step - loss: 0.5839 - binary_accuracy: 0.9712 - balanced_acc: 0.8975 - val_loss: 0.6560 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5686
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4774 - binary_accuracy: 0.9648 - balanced_acc: 0.86315/5 [==============================] - 0s 16ms/step - loss: 0.4403 - binary_accuracy: 0.9737 - balanced_acc: 0.8809 - val_loss: 0.5404 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5829
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3481 - binary_accuracy: 0.9922 - balanced_acc: 0.92865/5 [==============================] - ETA: 0s - loss: 0.3378 - binary_accuracy: 0.9796 - balanced_acc: 0.95535/5 [==============================] - 0s 17ms/step - loss: 0.3378 - binary_accuracy: 0.9796 - balanced_acc: 0.9553 - val_loss: 0.4706 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5565
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2702 - binary_accuracy: 0.9922 - balanced_acc: 0.96855/5 [==============================] - ETA: 0s - loss: 0.2842 - binary_accuracy: 0.9788 - balanced_acc: 0.92935/5 [==============================] - 1s 143ms/step - loss: 0.2842 - binary_accuracy: 0.9788 - balanced_acc: 0.9293 - val_loss: 0.3801 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6674
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2287 - binary_accuracy: 0.9922 - balanced_acc: 0.97165/5 [==============================] - ETA: 0s - loss: 0.2472 - binary_accuracy: 0.9746 - balanced_acc: 0.90595/5 [==============================] - 1s 150ms/step - loss: 0.2472 - binary_accuracy: 0.9746 - balanced_acc: 0.9059 - val_loss: 0.3596 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6835
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2051 - binary_accuracy: 0.9883 - balanced_acc: 0.99365/5 [==============================] - ETA: 0s - loss: 0.2014 - binary_accuracy: 0.9856 - balanced_acc: 0.95815/5 [==============================] - 0s 17ms/step - loss: 0.2014 - binary_accuracy: 0.9856 - balanced_acc: 0.9581 - val_loss: 0.3719 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5544
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1893 - binary_accuracy: 0.9883 - balanced_acc: 0.96955/5 [==============================] - 1s 139ms/step - loss: 0.1769 - binary_accuracy: 0.9898 - balanced_acc: 0.9557 - val_loss: 0.3452 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6866
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1585 - binary_accuracy: 0.9922 - balanced_acc: 0.99585/5 [==============================] - ETA: 0s - loss: 0.1463 - binary_accuracy: 0.9915 - balanced_acc: 0.97045/5 [==============================] - 0s 17ms/step - loss: 0.1463 - binary_accuracy: 0.9915 - balanced_acc: 0.9704 - val_loss: 0.3506 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6432
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1453 - binary_accuracy: 0.9844 - balanced_acc: 0.96745/5 [==============================] - 0s 15ms/step - loss: 0.1326 - binary_accuracy: 0.9915 - balanced_acc: 0.9741 - val_loss: 0.3637 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6322
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1368 - binary_accuracy: 0.9805 - balanced_acc: 0.93055/5 [==============================] - 0s 16ms/step - loss: 0.1203 - binary_accuracy: 0.9898 - balanced_acc: 0.9725 - val_loss: 0.3509 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5313
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1262 - binary_accuracy: 0.9844 - balanced_acc: 0.93265/5 [==============================] - ETA: 0s - loss: 0.1097 - binary_accuracy: 0.9949 - balanced_acc: 0.98085/5 [==============================] - 0s 17ms/step - loss: 0.1097 - binary_accuracy: 0.9949 - balanced_acc: 0.9808 - val_loss: 0.3243 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6532
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0969 - binary_accuracy: 0.9961 - balanced_acc: 0.97835/5 [==============================] - ETA: 0s - loss: 0.1020 - binary_accuracy: 0.9915 - balanced_acc: 0.96215/5 [==============================] - 0s 16ms/step - loss: 0.1020 - binary_accuracy: 0.9915 - balanced_acc: 0.9621 - val_loss: 0.3209 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6501
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0954 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 1s 201ms/step - loss: 0.0967 - binary_accuracy: 0.9949 - balanced_acc: 0.9836 - val_loss: 0.3140 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7389
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0998 - binary_accuracy: 0.9922 - balanced_acc: 0.99575/5 [==============================] - 1s 153ms/step - loss: 0.1045 - binary_accuracy: 0.9898 - balanced_acc: 0.9537 - val_loss: 0.3295 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7763
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0959 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 17ms/step - loss: 0.1150 - binary_accuracy: 0.9873 - balanced_acc: 0.9454 - val_loss: 0.3791 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6181
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0878 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - ETA: 0s - loss: 0.1185 - binary_accuracy: 0.9856 - balanced_acc: 0.94755/5 [==============================] - 0s 17ms/step - loss: 0.1185 - binary_accuracy: 0.9856 - balanced_acc: 0.9475 - val_loss: 0.3722 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6202
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0868 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 15ms/step - loss: 0.1053 - binary_accuracy: 0.9890 - balanced_acc: 0.9509 - val_loss: 0.3545 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6924
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1083 - binary_accuracy: 0.9922 - balanced_acc: 0.99575/5 [==============================] - ETA: 0s - loss: 0.1094 - binary_accuracy: 0.9881 - balanced_acc: 0.96575/5 [==============================] - 0s 17ms/step - loss: 0.1094 - binary_accuracy: 0.9881 - balanced_acc: 0.9657 - val_loss: 0.3249 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6564
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0974 - binary_accuracy: 0.9883 - balanced_acc: 0.95035/5 [==============================] - ETA: 0s - loss: 0.1017 - binary_accuracy: 0.9898 - balanced_acc: 0.96455/5 [==============================] - 0s 18ms/step - loss: 0.1017 - binary_accuracy: 0.9898 - balanced_acc: 0.9645 - val_loss: 0.3062 - val_binary_accuracy: 0.9492 - val_balanced_acc: 0.7342
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1025 - binary_accuracy: 0.9922 - balanced_acc: 0.99575/5 [==============================] - 0s 16ms/step - loss: 0.0972 - binary_accuracy: 0.9924 - balanced_acc: 0.9711 - val_loss: 0.3307 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7438
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1014 - binary_accuracy: 0.9922 - balanced_acc: 0.97415/5 [==============================] - 0s 15ms/step - loss: 0.0984 - binary_accuracy: 0.9898 - balanced_acc: 0.9595 - val_loss: 0.3187 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7289
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0739 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 16ms/step - loss: 0.0846 - binary_accuracy: 0.9949 - balanced_acc: 0.9885 - val_loss: 0.3712 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6553
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0720 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - ETA: 0s - loss: 0.0819 - binary_accuracy: 0.9949 - balanced_acc: 0.98515/5 [==============================] - 0s 17ms/step - loss: 0.0819 - binary_accuracy: 0.9949 - balanced_acc: 0.9851 - val_loss: 0.3602 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6722
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0804 - binary_accuracy: 0.9922 - balanced_acc: 0.99565/5 [==============================] - 0s 15ms/step - loss: 0.0772 - binary_accuracy: 0.9941 - balanced_acc: 0.9675 - val_loss: 0.3439 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.7347
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0713 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - ETA: 0s - loss: 0.0818 - binary_accuracy: 0.9941 - balanced_acc: 0.98145/5 [==============================] - 0s 17ms/step - loss: 0.0818 - binary_accuracy: 0.9941 - balanced_acc: 0.9814 - val_loss: 0.3508 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6722
Epoch 32/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0739 - binary_accuracy: 0.9922 - balanced_acc: 0.99575/5 [==============================] - ETA: 0s - loss: 0.0707 - binary_accuracy: 0.9958 - balanced_acc: 0.98755/5 [==============================] - 0s 16ms/step - loss: 0.0707 - binary_accuracy: 0.9958 - balanced_acc: 0.9875 - val_loss: 0.3725 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6480
Epoch 33/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0685 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - ETA: 0s - loss: 0.0685 - binary_accuracy: 0.9975 - balanced_acc: 0.99075/5 [==============================] - 0s 18ms/step - loss: 0.0685 - binary_accuracy: 0.9975 - balanced_acc: 0.9907 - val_loss: 0.3799 - val_binary_accuracy: 0.9051 - val_balanced_acc: 0.6348
Epoch 34/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0607 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - ETA: 0s - loss: 0.0669 - binary_accuracy: 0.9983 - balanced_acc: 0.99915/5 [==============================] - 0s 16ms/step - loss: 0.0669 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.3755 - val_binary_accuracy: 0.9051 - val_balanced_acc: 0.6348
Epoch 35/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0634 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 16ms/step - loss: 0.0674 - binary_accuracy: 0.9966 - balanced_acc: 0.9980 - val_loss: 0.3795 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6480
Epoch 36/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0628 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - ETA: 0s - loss: 0.0635 - binary_accuracy: 0.9983 - balanced_acc: 0.99915/5 [==============================] - 0s 16ms/step - loss: 0.0635 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.3791 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6359
Epoch 37/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0588 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 16ms/step - loss: 0.0607 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3741 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6248
Epoch 38/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0581 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 15ms/step - loss: 0.0603 - binary_accuracy: 0.9983 - balanced_acc: 0.9986 - val_loss: 0.3661 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6369
Epoch 39/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0626 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - ETA: 0s - loss: 0.0595 - binary_accuracy: 0.9983 - balanced_acc: 0.99925/5 [==============================] - 0s 17ms/step - loss: 0.0595 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3719 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6248
Epoch 40/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0565 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - ETA: 0s - loss: 0.0570 - binary_accuracy: 0.9992 - balanced_acc: 0.99965/5 [==============================] - 0s 18ms/step - loss: 0.0570 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3660 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 41/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0616 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 15ms/step - loss: 0.0571 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3651 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 42/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0740 - binary_accuracy: 0.9922 - balanced_acc: 0.99575/5 [==============================] - ETA: 0s - loss: 0.0602 - binary_accuracy: 0.9983 - balanced_acc: 0.99915/5 [==============================] - 0s 17ms/step - loss: 0.0602 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.3641 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 43/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0572 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 15ms/step - loss: 0.0576 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3631 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 44/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 14ms/step - loss: 0.0610 - binary_accuracy: 0.9975 - balanced_acc: 0.9988 - val_loss: 0.3627 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 45/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0599 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 16ms/step - loss: 0.0575 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.3623 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 46/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0599 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - ETA: 0s - loss: 0.0569 - binary_accuracy: 0.9992 - balanced_acc: 0.99965/5 [==============================] - 0s 16ms/step - loss: 0.0569 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3617 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 47/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0538 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 16ms/step - loss: 0.0562 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3609 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 48/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0552 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 16ms/step - loss: 0.0561 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3602 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6369
Epoch 49/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0581 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - ETA: 0s - loss: 0.0558 - binary_accuracy: 0.9992 - balanced_acc: 0.99965/5 [==============================] - 0s 17ms/step - loss: 0.0558 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3592 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6369
Epoch 50/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0538 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - ETA: 0s - loss: 0.0576 - binary_accuracy: 0.9983 - balanced_acc: 0.99925/5 [==============================] - 0s 17ms/step - loss: 0.0576 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3586 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6369

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.6497 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 2ms/step - loss: 0.5006 - binary_accuracy: 0.9158 - balanced_acc: 0.5888

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-53-30Z

Training run 5/648 (flags = list(0.1, 512, 0.2, 64, 1024, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-53-42Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 2.0728 - binary_accuracy: 0.4375 - balanced_acc: 0.328812/19 [=================>............] - ETA: 0s - loss: 1.5598 - binary_accuracy: 0.8724 - balanced_acc: 0.485719/19 [==============================] - 1s 48ms/step - loss: 1.4386 - binary_accuracy: 0.8923 - balanced_acc: 0.4910 - val_loss: 1.0965 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0298 - binary_accuracy: 0.9531 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.9776 - binary_accuracy: 0.9118 - balanced_acc: 0.510919/19 [==============================] - 1s 38ms/step - loss: 0.9268 - binary_accuracy: 0.9211 - balanced_acc: 0.5264 - val_loss: 0.7584 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7569 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.6463 - binary_accuracy: 0.9286 - balanced_acc: 0.590819/19 [==============================] - 1s 49ms/step - loss: 0.6266 - binary_accuracy: 0.9313 - balanced_acc: 0.6089 - val_loss: 0.5626 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5583
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4697 - binary_accuracy: 0.9531 - balanced_acc: 0.658514/19 [=====================>........] - ETA: 0s - loss: 0.4485 - binary_accuracy: 0.9487 - balanced_acc: 0.712619/19 [==============================] - 1s 39ms/step - loss: 0.4436 - binary_accuracy: 0.9474 - balanced_acc: 0.7315 - val_loss: 0.4454 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7187
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3936 - binary_accuracy: 0.9688 - balanced_acc: 0.919813/19 [===================>..........] - ETA: 0s - loss: 0.3439 - binary_accuracy: 0.9820 - balanced_acc: 0.933419/19 [==============================] - 0s 6ms/step - loss: 0.3385 - binary_accuracy: 0.9763 - balanced_acc: 0.9118 - val_loss: 0.4356 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6350
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3805 - binary_accuracy: 0.9688 - balanced_acc: 0.875013/19 [===================>..........] - ETA: 0s - loss: 0.2770 - binary_accuracy: 0.9868 - balanced_acc: 0.946319/19 [==============================] - 0s 6ms/step - loss: 0.2694 - binary_accuracy: 0.9856 - balanced_acc: 0.9282 - val_loss: 0.3793 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5854
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2152 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.2154 - binary_accuracy: 0.9904 - balanced_acc: 0.946119/19 [==============================] - 0s 6ms/step - loss: 0.2109 - binary_accuracy: 0.9890 - balanced_acc: 0.9363 - val_loss: 0.3520 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6500
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1673 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1788 - binary_accuracy: 0.9916 - balanced_acc: 0.978419/19 [==============================] - 0s 6ms/step - loss: 0.1805 - binary_accuracy: 0.9915 - balanced_acc: 0.9639 - val_loss: 0.3438 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7003
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1530 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1630 - binary_accuracy: 0.9904 - balanced_acc: 0.962219/19 [==============================] - 0s 6ms/step - loss: 0.1637 - binary_accuracy: 0.9898 - balanced_acc: 0.9690 - val_loss: 0.2881 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6233
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1365 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1386 - binary_accuracy: 0.9944 - balanced_acc: 0.970219/19 [==============================] - 1s 38ms/step - loss: 0.1402 - binary_accuracy: 0.9949 - balanced_acc: 0.9776 - val_loss: 0.2943 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7403
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1120 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1187 - binary_accuracy: 0.9967 - balanced_acc: 0.992819/19 [==============================] - 0s 6ms/step - loss: 0.1185 - binary_accuracy: 0.9949 - balanced_acc: 0.9934 - val_loss: 0.2987 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6100
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1103 - binary_accuracy: 0.9844 - balanced_acc: 0.916714/19 [=====================>........] - ETA: 0s - loss: 0.1038 - binary_accuracy: 0.9944 - balanced_acc: 0.969719/19 [==============================] - 0s 6ms/step - loss: 0.1059 - binary_accuracy: 0.9932 - balanced_acc: 0.9689 - val_loss: 0.2468 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7358
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1412 - binary_accuracy: 0.9688 - balanced_acc: 0.983114/19 [=====================>........] - ETA: 0s - loss: 0.0977 - binary_accuracy: 0.9967 - balanced_acc: 0.986919/19 [==============================] - 0s 5ms/step - loss: 0.0991 - binary_accuracy: 0.9966 - balanced_acc: 0.9899 - val_loss: 0.2914 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6016
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1011 - binary_accuracy: 0.9844 - balanced_acc: 0.991514/19 [=====================>........] - ETA: 0s - loss: 0.1046 - binary_accuracy: 0.9877 - balanced_acc: 0.972319/19 [==============================] - 0s 6ms/step - loss: 0.1037 - binary_accuracy: 0.9864 - balanced_acc: 0.9320 - val_loss: 0.3267 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6117
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1063 - binary_accuracy: 0.9844 - balanced_acc: 0.833314/19 [=====================>........] - ETA: 0s - loss: 0.1072 - binary_accuracy: 0.9911 - balanced_acc: 0.969619/19 [==============================] - 0s 6ms/step - loss: 0.1035 - binary_accuracy: 0.9924 - balanced_acc: 0.9738 - val_loss: 0.2392 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7375
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1168 - binary_accuracy: 0.9844 - balanced_acc: 0.991214/19 [=====================>........] - ETA: 0s - loss: 0.0936 - binary_accuracy: 0.9955 - balanced_acc: 0.985419/19 [==============================] - 0s 6ms/step - loss: 0.0900 - binary_accuracy: 0.9966 - balanced_acc: 0.9629 - val_loss: 0.3012 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5988
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0900 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0857 - binary_accuracy: 0.9964 - balanced_acc: 0.982119/19 [==============================] - 0s 5ms/step - loss: 0.0836 - binary_accuracy: 0.9966 - balanced_acc: 0.9825 - val_loss: 0.2301 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7154
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0706 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0711 - binary_accuracy: 0.9976 - balanced_acc: 0.998719/19 [==============================] - 0s 5ms/step - loss: 0.0707 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2328 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0637 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0653 - binary_accuracy: 0.9988 - balanced_acc: 0.990419/19 [==============================] - 0s 6ms/step - loss: 0.0664 - binary_accuracy: 0.9975 - balanced_acc: 0.9798 - val_loss: 0.2457 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6304
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0602 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0645 - binary_accuracy: 0.9967 - balanced_acc: 0.989819/19 [==============================] - 0s 5ms/step - loss: 0.0636 - binary_accuracy: 0.9975 - balanced_acc: 0.9925 - val_loss: 0.2700 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6749
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0599 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0596 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0587 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2546 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6716
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0561 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0560 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0562 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2438 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6671
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0549 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0554 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2437 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6687
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0556 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0551 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0548 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2422 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6437
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0538 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0538 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0545 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2402 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0515 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0543 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0540 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2355 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6504
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0545 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0532 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2398 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0531 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0526 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0530 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2368 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0529 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0520 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0522 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2344 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0532 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0524 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0521 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2328 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0538 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0520 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0517 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.2329 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0508 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0513 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0515 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2335 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0513 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0514 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2333 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0489 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0513 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0511 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2336 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 35/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0494 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0515 - binary_accuracy: 1.0000 - balanced_acc: 0.961519/19 [==============================] - 0s 6ms/step - loss: 0.0513 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.2337 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 36/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0483 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0512 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0514 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2332 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 37/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0515 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0511 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 7ms/step - loss: 0.0510 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2333 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 38/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0485 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0509 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0514 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2329 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 39/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0523 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0516 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0514 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2333 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 40/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0507 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0513 - binary_accuracy: 0.9988 - balanced_acc: 0.999319/19 [==============================] - 0s 6ms/step - loss: 0.0511 - binary_accuracy: 0.9992 - balanced_acc: 0.9995 - val_loss: 0.2334 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3571 - binary_accuracy: 0.8750 - balanced_acc: 0.466712/12 [==============================] - 0s 1ms/step - loss: 0.3496 - binary_accuracy: 0.9239 - balanced_acc: 0.5805

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-53-42Z

Training run 6/648 (flags = list(0, 256, 0.4, 64, 512, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-53-52Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 1.4446 - binary_accuracy: 0.5625 - balanced_acc: 0.488119/19 [==============================] - ETA: 0s - loss: 1.2766 - binary_accuracy: 0.8584 - balanced_acc: 0.495419/19 [==============================] - 1s 45ms/step - loss: 1.2766 - binary_accuracy: 0.8584 - balanced_acc: 0.4954 - val_loss: 1.1190 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0949 - binary_accuracy: 0.9531 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 1.0588 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9962 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0425 - binary_accuracy: 0.8906 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.9878 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9569 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8652 - binary_accuracy: 0.9531 - balanced_acc: 0.500018/19 [===========================>..] - ETA: 0s - loss: 0.9468 - binary_accuracy: 0.9219 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.9549 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9290 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.9974 - binary_accuracy: 0.8906 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.9216 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9022 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.9806 - binary_accuracy: 0.8750 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.8940 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8765 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.9090 - binary_accuracy: 0.9062 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.8652 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8522 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7762 - binary_accuracy: 0.9531 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.8402 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8281 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8383 - binary_accuracy: 0.9219 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.8147 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8063 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8135 - binary_accuracy: 0.9219 - balanced_acc: 0.500019/19 [==============================] - ETA: 0s - loss: 0.7888 - binary_accuracy: 0.9186 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7888 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7843 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7811 - binary_accuracy: 0.9062 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7622 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7633 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7654 - binary_accuracy: 0.9062 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7454 - binary_accuracy: 0.9194 - balanced_acc: 0.5038 - val_loss: 0.7613 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7576 - binary_accuracy: 0.9219 - balanced_acc: 0.500019/19 [==============================] - ETA: 0s - loss: 0.7458 - binary_accuracy: 0.9186 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7458 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7593 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7737 - binary_accuracy: 0.9219 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7421 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7573 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6955 - binary_accuracy: 0.9531 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7390 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7552 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7834 - binary_accuracy: 0.8906 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7385 - binary_accuracy: 0.9194 - balanced_acc: 0.5066 - val_loss: 0.7531 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8366 - binary_accuracy: 0.8281 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7343 - binary_accuracy: 0.9194 - balanced_acc: 0.5038 - val_loss: 0.7511 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7900 - binary_accuracy: 0.9062 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7321 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7491 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6901 - binary_accuracy: 0.9531 - balanced_acc: 0.625019/19 [==============================] - 0s 4ms/step - loss: 0.7304 - binary_accuracy: 0.9194 - balanced_acc: 0.5066 - val_loss: 0.7470 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7649 - binary_accuracy: 0.9062 - balanced_acc: 0.5000 8/19 [===========>..................] - ETA: 0s - loss: 0.7355 - binary_accuracy: 0.9141 - balanced_acc: 0.500019/19 [==============================] - 0s 6ms/step - loss: 0.7272 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7449 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7810 - binary_accuracy: 0.8906 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7274 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7429 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7795 - binary_accuracy: 0.8906 - balanced_acc: 0.562519/19 [==============================] - 0s 4ms/step - loss: 0.7236 - binary_accuracy: 0.9194 - balanced_acc: 0.5033 - val_loss: 0.7427 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7280 - binary_accuracy: 0.8906 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7236 - binary_accuracy: 0.9203 - balanced_acc: 0.5103 - val_loss: 0.7425 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7505 - binary_accuracy: 0.9062 - balanced_acc: 0.500018/19 [===========================>..] - ETA: 0s - loss: 0.7238 - binary_accuracy: 0.9193 - balanced_acc: 0.504019/19 [==============================] - 0s 4ms/step - loss: 0.7236 - binary_accuracy: 0.9194 - balanced_acc: 0.5038 - val_loss: 0.7422 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7865 - binary_accuracy: 0.8750 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7239 - binary_accuracy: 0.9194 - balanced_acc: 0.5038 - val_loss: 0.7420 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7190 - binary_accuracy: 0.9219 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7241 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7418 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7367 - binary_accuracy: 0.9062 - balanced_acc: 0.500019/19 [==============================] - ETA: 0s - loss: 0.7233 - binary_accuracy: 0.9186 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7233 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7416 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7972 - binary_accuracy: 0.8906 - balanced_acc: 0.562519/19 [==============================] - 0s 4ms/step - loss: 0.7214 - binary_accuracy: 0.9203 - balanced_acc: 0.5086 - val_loss: 0.7414 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6885 - binary_accuracy: 0.9219 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7221 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7412 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7584 - binary_accuracy: 0.8594 - balanced_acc: 0.500019/19 [==============================] - ETA: 0s - loss: 0.7205 - binary_accuracy: 0.9186 - balanced_acc: 0.500019/19 [==============================] - 0s 4ms/step - loss: 0.7205 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7409 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7185 - binary_accuracy: 0.9375 - balanced_acc: 0.600019/19 [==============================] - ETA: 0s - loss: 0.7221 - binary_accuracy: 0.9203 - balanced_acc: 0.509019/19 [==============================] - 0s 4ms/step - loss: 0.7221 - binary_accuracy: 0.9203 - balanced_acc: 0.5090 - val_loss: 0.7407 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.7519 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 993us/step - loss: 0.7224 - binary_accuracy: 0.9402 - balanced_acc: 0.5000

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-53-52Z

Training run 7/648 (flags = list(0, 512, 0.3, 64, 1024, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-53-57Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 2.0704 - binary_accuracy: 0.4375 - balanced_acc: 0.328813/19 [===================>..........] - ETA: 0s - loss: 1.4662 - binary_accuracy: 0.8750 - balanced_acc: 0.486819/19 [==============================] - 1s 56ms/step - loss: 1.3028 - binary_accuracy: 0.8923 - balanced_acc: 0.4910 - val_loss: 0.7780 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7186 - binary_accuracy: 0.9531 - balanced_acc: 0.500012/19 [=================>............] - ETA: 0s - loss: 0.6670 - binary_accuracy: 0.9089 - balanced_acc: 0.518319/19 [==============================] - 0s 6ms/step - loss: 0.5787 - binary_accuracy: 0.9254 - balanced_acc: 0.5677 - val_loss: 0.4462 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3931 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.3165 - binary_accuracy: 0.9442 - balanced_acc: 0.733619/19 [==============================] - 1s 36ms/step - loss: 0.3121 - binary_accuracy: 0.9415 - balanced_acc: 0.7147 - val_loss: 0.3021 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7758
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2296 - binary_accuracy: 0.9688 - balanced_acc: 0.825113/19 [===================>..........] - ETA: 0s - loss: 0.2334 - binary_accuracy: 0.9483 - balanced_acc: 0.726319/19 [==============================] - 0s 6ms/step - loss: 0.2469 - binary_accuracy: 0.9432 - balanced_acc: 0.7482 - val_loss: 0.2722 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6516
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2227 - binary_accuracy: 0.9375 - balanced_acc: 0.776913/19 [===================>..........] - ETA: 0s - loss: 0.2073 - binary_accuracy: 0.9567 - balanced_acc: 0.855319/19 [==============================] - 0s 6ms/step - loss: 0.2142 - binary_accuracy: 0.9559 - balanced_acc: 0.8548 - val_loss: 0.3210 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6116
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3037 - binary_accuracy: 0.9688 - balanced_acc: 0.875013/19 [===================>..........] - ETA: 0s - loss: 0.2017 - binary_accuracy: 0.9615 - balanced_acc: 0.832419/19 [==============================] - 0s 5ms/step - loss: 0.1890 - binary_accuracy: 0.9652 - balanced_acc: 0.8284 - val_loss: 0.3066 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5937
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1607 - binary_accuracy: 0.9531 - balanced_acc: 0.824714/19 [=====================>........] - ETA: 0s - loss: 0.1546 - binary_accuracy: 0.9643 - balanced_acc: 0.879419/19 [==============================] - 0s 5ms/step - loss: 0.1558 - binary_accuracy: 0.9635 - balanced_acc: 0.8695 - val_loss: 0.2586 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6437
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0905 - binary_accuracy: 0.9844 - balanced_acc: 0.833314/19 [=====================>........] - ETA: 0s - loss: 0.1268 - binary_accuracy: 0.9833 - balanced_acc: 0.928619/19 [==============================] - 0s 5ms/step - loss: 0.1391 - binary_accuracy: 0.9754 - balanced_acc: 0.8625 - val_loss: 0.2315 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7120
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0990 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.1500 - binary_accuracy: 0.9727 - balanced_acc: 0.907519/19 [==============================] - 0s 6ms/step - loss: 0.1565 - binary_accuracy: 0.9661 - balanced_acc: 0.8953 - val_loss: 0.3107 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1103 - binary_accuracy: 0.9844 - balanced_acc: 0.991514/19 [=====================>........] - ETA: 0s - loss: 0.1402 - binary_accuracy: 0.9743 - balanced_acc: 0.895419/19 [==============================] - 0s 5ms/step - loss: 0.1456 - binary_accuracy: 0.9729 - balanced_acc: 0.8993 - val_loss: 0.2652 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.7623
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1141 - binary_accuracy: 0.9688 - balanced_acc: 0.982815/19 [======================>.......] - ETA: 0s - loss: 0.1222 - binary_accuracy: 0.9802 - balanced_acc: 0.931319/19 [==============================] - 0s 5ms/step - loss: 0.1231 - binary_accuracy: 0.9779 - balanced_acc: 0.9382 - val_loss: 0.3937 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5888
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1165 - binary_accuracy: 0.9844 - balanced_acc: 0.916714/19 [=====================>........] - ETA: 0s - loss: 0.1253 - binary_accuracy: 0.9821 - balanced_acc: 0.914919/19 [==============================] - 0s 6ms/step - loss: 0.1317 - binary_accuracy: 0.9796 - balanced_acc: 0.9068 - val_loss: 0.2757 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7753
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1899 - binary_accuracy: 0.9688 - balanced_acc: 0.983114/19 [=====================>........] - ETA: 0s - loss: 0.1365 - binary_accuracy: 0.9766 - balanced_acc: 0.925419/19 [==============================] - 0s 6ms/step - loss: 0.1415 - binary_accuracy: 0.9754 - balanced_acc: 0.9305 - val_loss: 0.2440 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7604
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1154 - binary_accuracy: 0.9844 - balanced_acc: 0.900014/19 [=====================>........] - ETA: 0s - loss: 0.1008 - binary_accuracy: 0.9922 - balanced_acc: 0.977719/19 [==============================] - 0s 5ms/step - loss: 0.0962 - binary_accuracy: 0.9941 - balanced_acc: 0.9836 - val_loss: 0.2540 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7054
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0731 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0912 - binary_accuracy: 0.9940 - balanced_acc: 0.987119/19 [==============================] - 0s 6ms/step - loss: 0.0903 - binary_accuracy: 0.9941 - balanced_acc: 0.9821 - val_loss: 0.2489 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7304
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1034 - binary_accuracy: 0.9844 - balanced_acc: 0.991214/19 [=====================>........] - ETA: 0s - loss: 0.0879 - binary_accuracy: 0.9944 - balanced_acc: 0.987419/19 [==============================] - 0s 6ms/step - loss: 0.0837 - binary_accuracy: 0.9958 - balanced_acc: 0.9644 - val_loss: 0.2479 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7454
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0777 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0782 - binary_accuracy: 0.9967 - balanced_acc: 0.992919/19 [==============================] - 0s 5ms/step - loss: 0.0791 - binary_accuracy: 0.9958 - balanced_acc: 0.9877 - val_loss: 0.2549 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7204
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0760 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0762 - binary_accuracy: 0.9967 - balanced_acc: 0.982419/19 [==============================] - 0s 6ms/step - loss: 0.0765 - binary_accuracy: 0.9958 - balanced_acc: 0.9861 - val_loss: 0.2523 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7454
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0756 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0742 - binary_accuracy: 0.9964 - balanced_acc: 0.993319/19 [==============================] - 0s 6ms/step - loss: 0.0734 - binary_accuracy: 0.9966 - balanced_acc: 0.9949 - val_loss: 0.2553 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7454
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0776 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0728 - binary_accuracy: 0.9976 - balanced_acc: 0.998719/19 [==============================] - 0s 6ms/step - loss: 0.0709 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2593 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7188
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0752 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0685 - binary_accuracy: 0.9978 - balanced_acc: 0.994319/19 [==============================] - 0s 5ms/step - loss: 0.0683 - binary_accuracy: 0.9975 - balanced_acc: 0.9953 - val_loss: 0.2641 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7188
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0679 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0653 - binary_accuracy: 0.9988 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.0658 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2620 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7438
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0588 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0611 - binary_accuracy: 0.9989 - balanced_acc: 0.988119/19 [==============================] - 0s 5ms/step - loss: 0.0646 - binary_accuracy: 0.9975 - balanced_acc: 0.9903 - val_loss: 0.2640 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0561 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0635 - binary_accuracy: 0.9976 - balanced_acc: 0.998719/19 [==============================] - 0s 6ms/step - loss: 0.0627 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2635 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0537 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0615 - binary_accuracy: 0.9988 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.0623 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2636 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0563 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0626 - binary_accuracy: 0.9988 - balanced_acc: 0.999319/19 [==============================] - 0s 6ms/step - loss: 0.0623 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2637 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0615 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0605 - binary_accuracy: 0.9988 - balanced_acc: 0.999319/19 [==============================] - 0s 6ms/step - loss: 0.0621 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2636 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0594 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0596 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.0622 - binary_accuracy: 0.9975 - balanced_acc: 0.9925 - val_loss: 0.2637 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0610 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0619 - binary_accuracy: 0.9978 - balanced_acc: 0.998819/19 [==============================] - 0s 5ms/step - loss: 0.0612 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2632 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0640 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0618 - binary_accuracy: 0.9978 - balanced_acc: 0.998819/19 [==============================] - 0s 6ms/step - loss: 0.0611 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2632 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0552 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0621 - binary_accuracy: 0.9976 - balanced_acc: 0.998719/19 [==============================] - 0s 6ms/step - loss: 0.0608 - binary_accuracy: 0.9983 - balanced_acc: 0.9728 - val_loss: 0.2633 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0606 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0608 - binary_accuracy: 0.9978 - balanced_acc: 0.998819/19 [==============================] - 0s 5ms/step - loss: 0.0610 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2635 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0817 - binary_accuracy: 0.9844 - balanced_acc: 0.991913/19 [===================>..........] - ETA: 0s - loss: 0.0603 - binary_accuracy: 0.9988 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.0607 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2628 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7238

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.4474 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.4080 - binary_accuracy: 0.9076 - balanced_acc: 0.5722

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-53-57Z

Training run 8/648 (flags = list(0.1, 1024, 0.3, 256, 2048, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-54-04Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 3.0543 - binary_accuracy: 0.6875 - balanced_acc: 0.45615/5 [==============================] - ETA: 0s - loss: 2.8757 - binary_accuracy: 0.8702 - balanced_acc: 0.49125/5 [==============================] - 1s 185ms/step - loss: 2.8757 - binary_accuracy: 0.8702 - balanced_acc: 0.4912 - val_loss: 2.6783 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 2.6668 - binary_accuracy: 0.9297 - balanced_acc: 0.50005/5 [==============================] - ETA: 0s - loss: 2.6435 - binary_accuracy: 0.9186 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.6435 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.6019 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 2.6086 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.6021 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.5740 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 2.5035 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - ETA: 0s - loss: 2.5668 - binary_accuracy: 0.9186 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.5668 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.5292 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 2.5697 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - ETA: 0s - loss: 2.5163 - binary_accuracy: 0.9186 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.5163 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.4732 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 2.5305 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.4603 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.4220 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 2.4186 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.4059 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.3776 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 2.3830 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.3617 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.3343 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 2.2897 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.3163 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.2892 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 2.2505 - binary_accuracy: 0.9336 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.2706 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.2446 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 2.2213 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.2250 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.2014 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1948 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - ETA: 0s - loss: 2.1953 - binary_accuracy: 0.9186 - balanced_acc: 0.50005/5 [==============================] - 0s 17ms/step - loss: 2.1953 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1971 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1840 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1880 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1928 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1720 - binary_accuracy: 0.9219 - balanced_acc: 0.50003/5 [=================>............] - ETA: 0s - loss: 2.1923 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 22ms/step - loss: 2.1839 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1885 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1759 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1793 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1842 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1969 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - ETA: 0s - loss: 2.1763 - binary_accuracy: 0.9186 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.1763 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1798 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1869 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - ETA: 0s - loss: 2.1723 - binary_accuracy: 0.9186 - balanced_acc: 0.50005/5 [==============================] - 0s 16ms/step - loss: 2.1723 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1754 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1903 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1676 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1710 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1102 - binary_accuracy: 0.9414 - balanced_acc: 0.50005/5 [==============================] - ETA: 0s - loss: 2.1622 - binary_accuracy: 0.9186 - balanced_acc: 0.50005/5 [==============================] - 0s 17ms/step - loss: 2.1622 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1666 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1751 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 2.1575 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1621 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1554 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1522 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1577 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1830 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1487 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1572 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1262 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1470 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1568 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1495 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1474 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1563 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1408 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1481 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1559 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1857 - binary_accuracy: 0.9062 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1470 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1554 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1440 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1478 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1550 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1318 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1457 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1545 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1228 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 14ms/step - loss: 2.1445 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1540 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1958 - binary_accuracy: 0.8867 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1449 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1536 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 2.1592 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 15ms/step - loss: 2.1447 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1531 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 2.1671 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 2ms/step - loss: 2.1316 - binary_accuracy: 0.9402 - balanced_acc: 0.5000

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-54-04Z

Training run 9/648 (flags = list(0.1, 1024, 0.2, 128, 2048, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-54-10Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 3.0562 - binary_accuracy: 0.6953 - balanced_acc: 0.5234 6/10 [=================>............] - ETA: 0s - loss: 2.8365 - binary_accuracy: 0.8789 - balanced_acc: 0.503910/10 [==============================] - 1s 117ms/step - loss: 2.7601 - binary_accuracy: 0.8965 - balanced_acc: 0.5023 - val_loss: 2.6029 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.5303 - binary_accuracy: 0.9531 - balanced_acc: 0.5000 7/10 [====================>.........] - ETA: 0s - loss: 2.6177 - binary_accuracy: 0.9107 - balanced_acc: 0.500010/10 [==============================] - 0s 12ms/step - loss: 2.5896 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.5345 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.5311 - binary_accuracy: 0.9219 - balanced_acc: 0.5000 5/10 [==============>...............] - ETA: 0s - loss: 2.5294 - binary_accuracy: 0.9156 - balanced_acc: 0.500010/10 [==============================] - 0s 13ms/step - loss: 2.4984 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.4350 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.3791 - binary_accuracy: 0.9453 - balanced_acc: 0.5000 7/10 [====================>.........] - ETA: 0s - loss: 2.3971 - binary_accuracy: 0.9230 - balanced_acc: 0.500010/10 [==============================] - 0s 12ms/step - loss: 2.3982 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.3514 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.4101 - binary_accuracy: 0.8828 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 2.3310 - binary_accuracy: 0.9154 - balanced_acc: 0.500010/10 [==============================] - 0s 13ms/step - loss: 2.3177 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.2694 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.2756 - binary_accuracy: 0.9062 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 2.2584 - binary_accuracy: 0.9089 - balanced_acc: 0.500010/10 [==============================] - 0s 13ms/step - loss: 2.2294 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1862 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.1714 - binary_accuracy: 0.9219 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 2.1630 - binary_accuracy: 0.9154 - balanced_acc: 0.500010/10 [==============================] - 0s 13ms/step - loss: 2.1471 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.1097 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.0828 - binary_accuracy: 0.9219 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 2.0924 - binary_accuracy: 0.9076 - balanced_acc: 0.500010/10 [==============================] - 1s 77ms/step - loss: 2.0668 - binary_accuracy: 0.9194 - balanced_acc: 0.5079 - val_loss: 2.0320 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.9897 - binary_accuracy: 0.9453 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 1.9962 - binary_accuracy: 0.9271 - balanced_acc: 0.541810/10 [==============================] - 1s 77ms/step - loss: 1.9879 - binary_accuracy: 0.9245 - balanced_acc: 0.5371 - val_loss: 1.9604 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5338
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.9263 - binary_accuracy: 0.9453 - balanced_acc: 0.6111 7/10 [====================>.........] - ETA: 0s - loss: 1.9084 - binary_accuracy: 0.9342 - balanced_acc: 0.584310/10 [==============================] - 1s 81ms/step - loss: 1.9110 - binary_accuracy: 0.9279 - balanced_acc: 0.5626 - val_loss: 1.8913 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5504
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.8573 - binary_accuracy: 0.9297 - balanced_acc: 0.5909 6/10 [=================>............] - ETA: 0s - loss: 1.8448 - binary_accuracy: 0.9310 - balanced_acc: 0.588010/10 [==============================] - 0s 13ms/step - loss: 1.8386 - binary_accuracy: 0.9288 - balanced_acc: 0.5775 - val_loss: 1.8250 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5504
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.7987 - binary_accuracy: 0.9297 - balanced_acc: 0.6250 6/10 [=================>............] - ETA: 0s - loss: 1.7640 - binary_accuracy: 0.9414 - balanced_acc: 0.620910/10 [==============================] - 0s 13ms/step - loss: 1.7664 - binary_accuracy: 0.9355 - balanced_acc: 0.6342 - val_loss: 1.7657 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5504
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.7253 - binary_accuracy: 0.9375 - balanced_acc: 0.5556 6/10 [=================>............] - ETA: 0s - loss: 1.6954 - binary_accuracy: 0.9453 - balanced_acc: 0.610710/10 [==============================] - 0s 13ms/step - loss: 1.6958 - binary_accuracy: 0.9398 - balanced_acc: 0.6184 - val_loss: 1.7030 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5504
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.6420 - binary_accuracy: 0.9609 - balanced_acc: 0.7222 6/10 [=================>............] - ETA: 0s - loss: 1.6451 - binary_accuracy: 0.9375 - balanced_acc: 0.640310/10 [==============================] - 1s 80ms/step - loss: 1.6290 - binary_accuracy: 0.9457 - balanced_acc: 0.6696 - val_loss: 1.6433 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.5829 - binary_accuracy: 0.9453 - balanced_acc: 0.6500 7/10 [====================>.........] - ETA: 0s - loss: 1.5709 - binary_accuracy: 0.9475 - balanced_acc: 0.708410/10 [==============================] - 0s 12ms/step - loss: 1.5646 - binary_accuracy: 0.9491 - balanced_acc: 0.7373 - val_loss: 1.5910 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.5703 - binary_accuracy: 0.9219 - balanced_acc: 0.7245 6/10 [=================>............] - ETA: 0s - loss: 1.5258 - binary_accuracy: 0.9440 - balanced_acc: 0.732810/10 [==============================] - 0s 13ms/step - loss: 1.5042 - binary_accuracy: 0.9517 - balanced_acc: 0.7079 - val_loss: 1.5361 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.4703 - binary_accuracy: 0.9609 - balanced_acc: 0.8418 6/10 [=================>............] - ETA: 0s - loss: 1.4520 - binary_accuracy: 0.9635 - balanced_acc: 0.808410/10 [==============================] - 0s 12ms/step - loss: 1.4450 - binary_accuracy: 0.9610 - balanced_acc: 0.7570 - val_loss: 1.4915 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.4203 - binary_accuracy: 0.9453 - balanced_acc: 0.6111 6/10 [=================>............] - ETA: 0s - loss: 1.3938 - binary_accuracy: 0.9674 - balanced_acc: 0.775610/10 [==============================] - 0s 13ms/step - loss: 1.3877 - binary_accuracy: 0.9686 - balanced_acc: 0.7935 - val_loss: 1.4397 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.3470 - binary_accuracy: 0.9766 - balanced_acc: 0.8708 7/10 [====================>.........] - ETA: 0s - loss: 1.3406 - binary_accuracy: 0.9754 - balanced_acc: 0.864210/10 [==============================] - 0s 12ms/step - loss: 1.3329 - binary_accuracy: 0.9763 - balanced_acc: 0.8653 - val_loss: 1.3993 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.3239 - binary_accuracy: 0.9531 - balanced_acc: 0.7694 6/10 [=================>............] - ETA: 0s - loss: 1.2895 - binary_accuracy: 0.9805 - balanced_acc: 0.893410/10 [==============================] - 0s 12ms/step - loss: 1.2808 - binary_accuracy: 0.9813 - balanced_acc: 0.9067 - val_loss: 1.3606 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.2639 - binary_accuracy: 0.9688 - balanced_acc: 0.8458 6/10 [=================>............] - ETA: 0s - loss: 1.2441 - binary_accuracy: 0.9818 - balanced_acc: 0.910410/10 [==============================] - 0s 13ms/step - loss: 1.2339 - binary_accuracy: 0.9830 - balanced_acc: 0.9042 - val_loss: 1.3205 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.2243 - binary_accuracy: 0.9844 - balanced_acc: 0.9375 6/10 [=================>............] - ETA: 0s - loss: 1.1950 - binary_accuracy: 0.9909 - balanced_acc: 0.959410/10 [==============================] - 1s 95ms/step - loss: 1.1884 - binary_accuracy: 0.9915 - balanced_acc: 0.9698 - val_loss: 1.2809 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.5870
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1477 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 1.1454 - binary_accuracy: 0.9911 - balanced_acc: 0.954710/10 [==============================] - 0s 11ms/step - loss: 1.1439 - binary_accuracy: 0.9881 - balanced_acc: 0.9472 - val_loss: 1.2473 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.5870
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1046 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 1.1109 - binary_accuracy: 0.9909 - balanced_acc: 0.958910/10 [==============================] - 1s 77ms/step - loss: 1.1027 - binary_accuracy: 0.9924 - balanced_acc: 0.9694 - val_loss: 1.2052 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6454
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0703 - binary_accuracy: 0.9922 - balanced_acc: 0.9957 7/10 [====================>.........] - ETA: 0s - loss: 1.0623 - binary_accuracy: 0.9978 - balanced_acc: 0.992210/10 [==============================] - 0s 12ms/step - loss: 1.0622 - binary_accuracy: 0.9958 - balanced_acc: 0.9758 - val_loss: 1.1729 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6120
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0450 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 1.0313 - binary_accuracy: 0.9948 - balanced_acc: 0.980110/10 [==============================] - 0s 13ms/step - loss: 1.0244 - binary_accuracy: 0.9966 - balanced_acc: 0.9880 - val_loss: 1.1372 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6092
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0002 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.9926 - binary_accuracy: 0.9933 - balanced_acc: 0.957510/10 [==============================] - 0s 12ms/step - loss: 0.9893 - binary_accuracy: 0.9949 - balanced_acc: 0.9702 - val_loss: 1.1158 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6106
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9654 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.9551 - binary_accuracy: 0.9989 - balanced_acc: 0.999410/10 [==============================] - 0s 12ms/step - loss: 0.9536 - binary_accuracy: 0.9975 - balanced_acc: 0.9892 - val_loss: 1.0788 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9361 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.9237 - binary_accuracy: 0.9978 - balanced_acc: 0.993410/10 [==============================] - 0s 12ms/step - loss: 0.9204 - binary_accuracy: 0.9975 - balanced_acc: 0.9950 - val_loss: 1.0495 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6426
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9035 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.8910 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 11ms/step - loss: 0.8881 - binary_accuracy: 0.9983 - balanced_acc: 0.9900 - val_loss: 1.0315 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5519
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8702 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.8640 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.8587 - binary_accuracy: 0.9992 - balanced_acc: 0.9455 - val_loss: 0.9862 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 32/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8428 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.8308 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.8294 - binary_accuracy: 0.9992 - balanced_acc: 0.9962 - val_loss: 0.9697 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 33/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8156 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.8035 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.7996 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.9346 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6426
Epoch 34/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7735 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7789 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7741 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.9125 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 35/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7552 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7573 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7563 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.9092 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 36/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7511 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7546 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.7532 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.9062 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 37/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7520 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.7510 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7515 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.9039 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 38/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7441 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7472 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7483 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8999 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 39/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7456 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7465 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7451 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8988 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 40/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7440 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.7431 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7428 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8962 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 41/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7448 - binary_accuracy: 0.9922 - balanced_acc: 0.9545 7/10 [====================>.........] - ETA: 0s - loss: 0.7421 - binary_accuracy: 0.9989 - balanced_acc: 0.993510/10 [==============================] - 0s 12ms/step - loss: 0.7413 - binary_accuracy: 0.9992 - balanced_acc: 0.9955 - val_loss: 0.8933 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 42/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7377 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7394 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 14ms/step - loss: 0.7380 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.8911 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 43/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7313 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7356 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7352 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8889 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 44/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7308 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.7319 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7323 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8878 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 45/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7309 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.7322 - binary_accuracy: 0.9989 - balanced_acc: 0.999410/10 [==============================] - 0s 13ms/step - loss: 0.7310 - binary_accuracy: 0.9992 - balanced_acc: 0.9496 - val_loss: 0.8877 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 46/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7281 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7299 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.7300 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8875 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 47/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7292 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/10 [==============>...............] - ETA: 0s - loss: 0.7312 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - ETA: 0s - loss: 0.7297 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 14ms/step - loss: 0.7297 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8872 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 48/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7325 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.7296 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7300 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8869 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 49/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7329 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7308 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.7294 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8867 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 50/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7305 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7291 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 13ms/step - loss: 0.7289 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.8865 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 51/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7324 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7292 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7286 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8862 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 52/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7271 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7287 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.7289 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8860 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 53/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7236 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7290 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.7285 - binary_accuracy: 1.0000 - balanced_acc: 0.9500 - val_loss: 0.8856 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 54/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7403 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.7305 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.7285 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.8853 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.9621 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 2ms/step - loss: 0.9196 - binary_accuracy: 0.9375 - balanced_acc: 0.5874

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-54-10Z

Training run 10/648 (flags = list(0.2, 512, 0.3, 64, 1024, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-54-24Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 2.0842 - binary_accuracy: 0.3438 - balanced_acc: 0.278013/19 [===================>..........] - ETA: 0s - loss: 1.5482 - binary_accuracy: 0.8678 - balanced_acc: 0.482919/19 [==============================] - 1s 47ms/step - loss: 1.4447 - binary_accuracy: 0.8872 - balanced_acc: 0.4883 - val_loss: 1.1102 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0452 - binary_accuracy: 0.9531 - balanced_acc: 0.500013/19 [===================>..........] - ETA: 0s - loss: 1.0099 - binary_accuracy: 0.9087 - balanced_acc: 0.500019/19 [==============================] - 0s 6ms/step - loss: 0.9457 - binary_accuracy: 0.9186 - balanced_acc: 0.5055 - val_loss: 0.7788 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7783 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.6698 - binary_accuracy: 0.9241 - balanced_acc: 0.559219/19 [==============================] - 1s 37ms/step - loss: 0.6505 - binary_accuracy: 0.9279 - balanced_acc: 0.5856 - val_loss: 0.5867 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5583
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4934 - binary_accuracy: 0.9531 - balanced_acc: 0.658513/19 [===================>..........] - ETA: 0s - loss: 0.4688 - binary_accuracy: 0.9519 - balanced_acc: 0.709919/19 [==============================] - 1s 55ms/step - loss: 0.4698 - binary_accuracy: 0.9466 - balanced_acc: 0.7291 - val_loss: 0.4686 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4195 - binary_accuracy: 0.9688 - balanced_acc: 0.919813/19 [===================>..........] - ETA: 0s - loss: 0.3678 - binary_accuracy: 0.9772 - balanced_acc: 0.899119/19 [==============================] - 0s 8ms/step - loss: 0.3649 - binary_accuracy: 0.9703 - balanced_acc: 0.8791 - val_loss: 0.4429 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6150
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3916 - binary_accuracy: 0.9531 - balanced_acc: 0.812514/19 [=====================>........] - ETA: 0s - loss: 0.2955 - binary_accuracy: 0.9833 - balanced_acc: 0.939419/19 [==============================] - 0s 5ms/step - loss: 0.2909 - binary_accuracy: 0.9822 - balanced_acc: 0.9154 - val_loss: 0.3948 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5816
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2353 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2374 - binary_accuracy: 0.9855 - balanced_acc: 0.932619/19 [==============================] - 0s 5ms/step - loss: 0.2315 - binary_accuracy: 0.9856 - balanced_acc: 0.9240 - val_loss: 0.3486 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6333
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1838 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1904 - binary_accuracy: 0.9944 - balanced_acc: 0.963919/19 [==============================] - 0s 5ms/step - loss: 0.1914 - binary_accuracy: 0.9941 - balanced_acc: 0.9653 - val_loss: 0.3647 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6986
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1700 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1747 - binary_accuracy: 0.9922 - balanced_acc: 0.976219/19 [==============================] - 0s 5ms/step - loss: 0.1794 - binary_accuracy: 0.9890 - balanced_acc: 0.9716 - val_loss: 0.3065 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6500
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1517 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1538 - binary_accuracy: 0.9922 - balanced_acc: 0.960719/19 [==============================] - 0s 5ms/step - loss: 0.1588 - binary_accuracy: 0.9890 - balanced_acc: 0.9569 - val_loss: 0.3145 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7374
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1286 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1347 - binary_accuracy: 0.9940 - balanced_acc: 0.971819/19 [==============================] - 0s 6ms/step - loss: 0.1354 - binary_accuracy: 0.9949 - balanced_acc: 0.9803 - val_loss: 0.3117 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6083
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1163 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1314 - binary_accuracy: 0.9904 - balanced_acc: 0.951019/19 [==============================] - 0s 6ms/step - loss: 0.1311 - binary_accuracy: 0.9915 - balanced_acc: 0.9606 - val_loss: 0.2971 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6458
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1475 - binary_accuracy: 0.9844 - balanced_acc: 0.991513/19 [===================>..........] - ETA: 0s - loss: 0.1168 - binary_accuracy: 0.9952 - balanced_acc: 0.967319/19 [==============================] - 0s 6ms/step - loss: 0.1170 - binary_accuracy: 0.9949 - balanced_acc: 0.9767 - val_loss: 0.3032 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6458
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1036 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1261 - binary_accuracy: 0.9877 - balanced_acc: 0.965819/19 [==============================] - 0s 6ms/step - loss: 0.1220 - binary_accuracy: 0.9890 - balanced_acc: 0.9579 - val_loss: 0.3551 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6167
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1172 - binary_accuracy: 0.9844 - balanced_acc: 0.833313/19 [===================>..........] - ETA: 0s - loss: 0.1202 - binary_accuracy: 0.9844 - balanced_acc: 0.907419/19 [==============================] - 0s 6ms/step - loss: 0.1159 - binary_accuracy: 0.9881 - balanced_acc: 0.9314 - val_loss: 0.2781 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6920
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1190 - binary_accuracy: 0.9844 - balanced_acc: 0.928614/19 [=====================>........] - ETA: 0s - loss: 0.1016 - binary_accuracy: 0.9978 - balanced_acc: 0.994319/19 [==============================] - 0s 6ms/step - loss: 0.0997 - binary_accuracy: 0.9983 - balanced_acc: 0.9695 - val_loss: 0.2654 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6937
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0965 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0971 - binary_accuracy: 0.9964 - balanced_acc: 0.991019/19 [==============================] - 0s 6ms/step - loss: 0.0961 - binary_accuracy: 0.9975 - balanced_acc: 0.9939 - val_loss: 0.2663 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6937
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0956 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0936 - binary_accuracy: 0.9988 - balanced_acc: 0.994519/19 [==============================] - 0s 6ms/step - loss: 0.0930 - binary_accuracy: 0.9992 - balanced_acc: 0.9962 - val_loss: 0.2656 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6971
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0889 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0914 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0908 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2671 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0918 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0912 - binary_accuracy: 0.9988 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.0906 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2689 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0891 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0881 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0879 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2684 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0840 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0858 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0858 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2644 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0848 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0839 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0848 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2635 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0838 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0846 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0841 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2604 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6971
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0811 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0826 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0833 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2602 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6971
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0786 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0835 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0830 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2601 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0818 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0824 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0832 - binary_accuracy: 0.9992 - balanced_acc: 0.9947 - val_loss: 0.2601 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0846 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0821 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0831 - binary_accuracy: 0.9992 - balanced_acc: 0.9934 - val_loss: 0.2599 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0927 - binary_accuracy: 0.9844 - balanced_acc: 0.900013/19 [===================>..........] - ETA: 0s - loss: 0.0831 - binary_accuracy: 0.9988 - balanced_acc: 0.992319/19 [==============================] - 0s 6ms/step - loss: 0.0835 - binary_accuracy: 0.9992 - balanced_acc: 0.9947 - val_loss: 0.2595 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6971
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0852 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0836 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0826 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2594 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6971
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0808 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0825 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.0819 - binary_accuracy: 0.9992 - balanced_acc: 0.9732 - val_loss: 0.2594 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6971
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0822 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0836 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.0834 - binary_accuracy: 0.9992 - balanced_acc: 0.9995 - val_loss: 0.2597 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6971
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0858 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0812 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0814 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2597 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6971
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0773 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0809 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0810 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2598 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6988

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3682 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3594 - binary_accuracy: 0.9158 - balanced_acc: 0.5887

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-54-24Z

Training run 11/648 (flags = list(0, 256, 0.3, 128, 512, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-54-32Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.4504 - binary_accuracy: 0.4844 - balanced_acc: 0.406010/10 [==============================] - 1s 83ms/step - loss: 0.9441 - binary_accuracy: 0.8736 - balanced_acc: 0.4906 - val_loss: 0.6574 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.5892 - binary_accuracy: 0.9531 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 0.5698 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.4638 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.4442 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 0.3851 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.3492 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2779 - binary_accuracy: 0.9453 - balanced_acc: 0.500010/10 [==============================] - 1s 69ms/step - loss: 0.2799 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.2902 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5504
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2667 - binary_accuracy: 0.9062 - balanced_acc: 0.628910/10 [==============================] - 1s 68ms/step - loss: 0.2358 - binary_accuracy: 0.9355 - balanced_acc: 0.6411 - val_loss: 0.2740 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6361
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1957 - binary_accuracy: 0.9766 - balanced_acc: 0.912410/10 [==============================] - 1s 66ms/step - loss: 0.1992 - binary_accuracy: 0.9576 - balanced_acc: 0.7564 - val_loss: 0.2603 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6539
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1461 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 1s 94ms/step - loss: 0.1713 - binary_accuracy: 0.9644 - balanced_acc: 0.8498 - val_loss: 0.2839 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1363 - binary_accuracy: 0.9766 - balanced_acc: 0.941510/10 [==============================] - 0s 6ms/step - loss: 0.1601 - binary_accuracy: 0.9695 - balanced_acc: 0.8401 - val_loss: 0.3011 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6137
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1546 - binary_accuracy: 0.9766 - balanced_acc: 0.853010/10 [==============================] - 0s 6ms/step - loss: 0.1396 - binary_accuracy: 0.9771 - balanced_acc: 0.9143 - val_loss: 0.2552 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6706
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1326 - binary_accuracy: 0.9844 - balanced_acc: 0.991610/10 [==============================] - 0s 6ms/step - loss: 0.1234 - binary_accuracy: 0.9830 - balanced_acc: 0.9460 - val_loss: 0.2886 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6644
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1133 - binary_accuracy: 0.9844 - balanced_acc: 0.909110/10 [==============================] - 0s 6ms/step - loss: 0.1102 - binary_accuracy: 0.9864 - balanced_acc: 0.9620 - val_loss: 0.3501 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5818
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1003 - binary_accuracy: 0.9844 - balanced_acc: 0.916710/10 [==============================] - 0s 6ms/step - loss: 0.1403 - binary_accuracy: 0.9763 - balanced_acc: 0.9068 - val_loss: 0.3118 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5813
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1311 - binary_accuracy: 0.9688 - balanced_acc: 0.880510/10 [==============================] - 1s 67ms/step - loss: 0.1324 - binary_accuracy: 0.9729 - balanced_acc: 0.8912 - val_loss: 0.2873 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6825
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1202 - binary_accuracy: 0.9766 - balanced_acc: 0.884710/10 [==============================] - 0s 6ms/step - loss: 0.1445 - binary_accuracy: 0.9678 - balanced_acc: 0.8946 - val_loss: 0.3020 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6571
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0947 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 1s 67ms/step - loss: 0.1345 - binary_accuracy: 0.9771 - balanced_acc: 0.8879 - val_loss: 0.2623 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7153
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1247 - binary_accuracy: 0.9844 - balanced_acc: 0.991210/10 [==============================] - 0s 6ms/step - loss: 0.1277 - binary_accuracy: 0.9856 - balanced_acc: 0.8882 - val_loss: 0.2747 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6535
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1433 - binary_accuracy: 0.9766 - balanced_acc: 0.952810/10 [==============================] - 1s 67ms/step - loss: 0.1124 - binary_accuracy: 0.9856 - balanced_acc: 0.9551 - val_loss: 0.2514 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7294
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0796 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0851 - binary_accuracy: 0.9932 - balanced_acc: 0.9825 - val_loss: 0.3164 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6012
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0822 - binary_accuracy: 0.9922 - balanced_acc: 0.937510/10 [==============================] - 0s 7ms/step - loss: 0.0769 - binary_accuracy: 0.9958 - balanced_acc: 0.9921 - val_loss: 0.2930 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5970
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0792 - binary_accuracy: 0.9844 - balanced_acc: 0.991610/10 [==============================] - 0s 6ms/step - loss: 0.0739 - binary_accuracy: 0.9932 - balanced_acc: 0.9298 - val_loss: 0.3045 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6368
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0831 - binary_accuracy: 0.9922 - balanced_acc: 0.950010/10 [==============================] - 0s 6ms/step - loss: 0.0854 - binary_accuracy: 0.9898 - balanced_acc: 0.9673 - val_loss: 0.2614 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7155
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0749 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 1s 68ms/step - loss: 0.1053 - binary_accuracy: 0.9839 - balanced_acc: 0.9204 - val_loss: 0.2992 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7462
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0982 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 1s 70ms/step - loss: 0.1193 - binary_accuracy: 0.9805 - balanced_acc: 0.9121 - val_loss: 0.3017 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7657
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0816 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1182 - binary_accuracy: 0.9856 - balanced_acc: 0.9513 - val_loss: 0.2752 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7404
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0888 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0996 - binary_accuracy: 0.9932 - balanced_acc: 0.9664 - val_loss: 0.3496 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6749
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0932 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.1058 - binary_accuracy: 0.9907 - balanced_acc: 0.9687 - val_loss: 0.3272 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6854
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0788 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.1170 - binary_accuracy: 0.9890 - balanced_acc: 0.9589 - val_loss: 0.3135 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7224
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0821 - binary_accuracy: 0.9922 - balanced_acc: 0.995710/10 [==============================] - 0s 6ms/step - loss: 0.0920 - binary_accuracy: 0.9898 - balanced_acc: 0.9574 - val_loss: 0.3173 - val_binary_accuracy: 0.9051 - val_balanced_acc: 0.6706
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0886 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 0s 6ms/step - loss: 0.0821 - binary_accuracy: 0.9941 - balanced_acc: 0.9873 - val_loss: 0.3260 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6929
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0683 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0752 - binary_accuracy: 0.9941 - balanced_acc: 0.9852 - val_loss: 0.3448 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6569
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0683 - binary_accuracy: 0.9922 - balanced_acc: 0.944410/10 [==============================] - 0s 6ms/step - loss: 0.0737 - binary_accuracy: 0.9932 - balanced_acc: 0.9273 - val_loss: 0.3301 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6620
Epoch 32/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0821 - binary_accuracy: 0.9922 - balanced_acc: 0.961510/10 [==============================] - 0s 6ms/step - loss: 0.0677 - binary_accuracy: 0.9958 - balanced_acc: 0.9866 - val_loss: 0.3227 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6916
Epoch 33/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0595 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0572 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3212 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6449
Epoch 34/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0465 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0594 - binary_accuracy: 0.9975 - balanced_acc: 0.9846 - val_loss: 0.2900 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6516
Epoch 35/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0492 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0503 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2766 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.7209
Epoch 36/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0494 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0489 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2869 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7071
Epoch 37/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0492 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0474 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2930 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6900
Epoch 38/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0449 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0463 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2888 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7085
Epoch 39/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0453 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0456 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2864 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7085
Epoch 40/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0449 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0457 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2864 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.7057
Epoch 41/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0434 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0452 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2874 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 42/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0439 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0439 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2876 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 43/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0419 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 11ms/step - loss: 0.0438 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2869 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 44/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0409 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0429 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2870 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 45/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0435 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0434 - binary_accuracy: 0.9992 - balanced_acc: 0.9496 - val_loss: 0.2868 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 46/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0418 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0427 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2866 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 47/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0421 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0428 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2864 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 48/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0446 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0429 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2864 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 49/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0417 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0423 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2866 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 50/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0422 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0425 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2868 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 51/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0450 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0431 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2868 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 52/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0412 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0425 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2868 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686
Epoch 53/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0412 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.0426 - binary_accuracy: 1.0000 - balanced_acc: 0.9500 - val_loss: 0.2866 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6686

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.4608 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 840us/step - loss: 0.4361 - binary_accuracy: 0.9130 - balanced_acc: 0.5748

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-54-32Z

Training run 12/648 (flags = list(0, 512, 0.2, 256, 1024, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-54-44Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0641 - binary_accuracy: 0.4570 - balanced_acc: 0.50585/5 [==============================] - 1s 221ms/step - loss: 1.6994 - binary_accuracy: 0.8202 - balanced_acc: 0.5012 - val_loss: 1.5578 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 1.5201 - binary_accuracy: 0.9297 - balanced_acc: 0.50005/5 [==============================] - 0s 11ms/step - loss: 1.4763 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.3157 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 1.3107 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 11ms/step - loss: 1.2623 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1781 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 1.1302 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 11ms/step - loss: 1.1084 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0308 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0310 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 10ms/step - loss: 0.9629 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9229 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9190 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 10ms/step - loss: 0.8423 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8141 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 0.7616 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 11ms/step - loss: 0.7333 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7299 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 0.6741 - binary_accuracy: 0.9180 - balanced_acc: 0.54355/5 [==============================] - 0s 10ms/step - loss: 0.6416 - binary_accuracy: 0.9211 - balanced_acc: 0.5123 - val_loss: 0.6638 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.5645 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 1s 132ms/step - loss: 0.5621 - binary_accuracy: 0.9347 - balanced_acc: 0.5986 - val_loss: 0.6013 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5132
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4966 - binary_accuracy: 0.9609 - balanced_acc: 0.70595/5 [==============================] - 1s 131ms/step - loss: 0.4930 - binary_accuracy: 0.9483 - balanced_acc: 0.6940 - val_loss: 0.5491 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5263
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4408 - binary_accuracy: 0.9688 - balanced_acc: 0.81375/5 [==============================] - 1s 135ms/step - loss: 0.4318 - binary_accuracy: 0.9703 - balanced_acc: 0.8456 - val_loss: 0.5105 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5395
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3868 - binary_accuracy: 0.9922 - balanced_acc: 0.95005/5 [==============================] - 1s 131ms/step - loss: 0.3770 - binary_accuracy: 0.9864 - balanced_acc: 0.9358 - val_loss: 0.4637 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.5658
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3476 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 11ms/step - loss: 0.3289 - binary_accuracy: 0.9949 - balanced_acc: 0.9838 - val_loss: 0.4525 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.5658
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3056 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 1s 131ms/step - loss: 0.2904 - binary_accuracy: 0.9949 - balanced_acc: 0.9824 - val_loss: 0.4138 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2683 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 10ms/step - loss: 0.2584 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.4096 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6414
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2413 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.2327 - binary_accuracy: 0.9983 - balanced_acc: 0.9914 - val_loss: 0.3802 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6504
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2176 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 10ms/step - loss: 0.2106 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3793 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5647
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1980 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 1s 208ms/step - loss: 0.1942 - binary_accuracy: 0.9983 - balanced_acc: 0.9949 - val_loss: 0.3473 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6887
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1811 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 1s 132ms/step - loss: 0.1767 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3330 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7150
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1680 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.1639 - binary_accuracy: 0.9983 - balanced_acc: 0.9845 - val_loss: 0.3215 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6514
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1520 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.1498 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3114 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6514
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1398 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 17ms/step - loss: 0.1417 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3221 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5526
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1296 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 1s 127ms/step - loss: 0.1304 - binary_accuracy: 0.9992 - balanced_acc: 0.9955 - val_loss: 0.2822 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7189
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1239 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.1221 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3326 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6141
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1205 - binary_accuracy: 0.9961 - balanced_acc: 0.97625/5 [==============================] - 1s 127ms/step - loss: 0.1157 - binary_accuracy: 0.9975 - balanced_acc: 0.9941 - val_loss: 0.2635 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7250
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1116 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 11ms/step - loss: 0.1073 - binary_accuracy: 0.9992 - balanced_acc: 0.9955 - val_loss: 0.2798 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6383
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1015 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 1s 131ms/step - loss: 0.0999 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2639 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7271
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0946 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0943 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2574 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7271
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0895 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0889 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2678 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6755
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0865 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 11ms/step - loss: 0.0838 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2472 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0804 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0794 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2623 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6130
Epoch 32/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0757 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0749 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2419 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6997
Epoch 33/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0748 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 11ms/step - loss: 0.0722 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2386 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 34/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0667 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 11ms/step - loss: 0.0679 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2410 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 35/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0658 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0648 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2420 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 36/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0624 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0621 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2345 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 37/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0591 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0594 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2304 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7139
Epoch 38/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0570 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0579 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2319 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 39/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0588 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0572 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2409 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 40/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0566 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0564 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2421 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 41/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0572 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0562 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2367 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6745
Epoch 42/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0569 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0558 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2299 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 43/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 15ms/step - loss: 0.0557 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2285 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 44/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0551 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0554 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2312 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 45/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0553 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2339 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6745
Epoch 46/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0556 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0548 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2343 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6745
Epoch 47/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0535 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0545 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2319 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 48/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0544 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0545 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2317 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 49/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0547 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0543 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2317 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 50/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0543 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0543 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2317 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7008
Epoch 51/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0554 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0543 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2317 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 52/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0547 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0542 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2317 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 53/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0543 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2316 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 54/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0561 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 11ms/step - loss: 0.0541 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2315 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 55/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0538 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0541 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2315 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 56/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0548 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0543 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2312 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876
Epoch 57/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0537 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 11ms/step - loss: 0.0541 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2311 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6876

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3501 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 1ms/step - loss: 0.3276 - binary_accuracy: 0.9212 - balanced_acc: 0.5791

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-54-44Z

Training run 13/648 (flags = list(0, 256, 0.3, 128, 256, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-54-57Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.3627 - binary_accuracy: 0.5078 - balanced_acc: 0.384910/10 [==============================] - 1s 102ms/step - loss: 0.8807 - binary_accuracy: 0.8762 - balanced_acc: 0.4885 - val_loss: 0.6299 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.5576 - binary_accuracy: 0.9531 - balanced_acc: 0.500010/10 [==============================] - 0s 5ms/step - loss: 0.5548 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.4447 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.4354 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 5ms/step - loss: 0.3783 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.3389 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2674 - binary_accuracy: 0.9453 - balanced_acc: 0.500010/10 [==============================] - 0s 5ms/step - loss: 0.2847 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.2864 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2670 - binary_accuracy: 0.8828 - balanced_acc: 0.500010/10 [==============================] - 0s 5ms/step - loss: 0.2442 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.2814 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1933 - binary_accuracy: 0.9141 - balanced_acc: 0.541710/10 [==============================] - 1s 65ms/step - loss: 0.2017 - binary_accuracy: 0.9406 - balanced_acc: 0.6305 - val_loss: 0.2708 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5185
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1722 - binary_accuracy: 0.9297 - balanced_acc: 0.550010/10 [==============================] - 1s 65ms/step - loss: 0.1728 - binary_accuracy: 0.9483 - balanced_acc: 0.6941 - val_loss: 0.2511 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5676
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1395 - binary_accuracy: 0.9766 - balanced_acc: 0.850010/10 [==============================] - 1s 67ms/step - loss: 0.1587 - binary_accuracy: 0.9610 - balanced_acc: 0.7589 - val_loss: 0.2637 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6426
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1237 - binary_accuracy: 0.9766 - balanced_acc: 0.853010/10 [==============================] - 0s 5ms/step - loss: 0.1507 - binary_accuracy: 0.9601 - balanced_acc: 0.8226 - val_loss: 0.2323 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6151
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1302 - binary_accuracy: 0.9688 - balanced_acc: 0.931810/10 [==============================] - 1s 65ms/step - loss: 0.1500 - binary_accuracy: 0.9703 - balanced_acc: 0.8859 - val_loss: 0.2558 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6706
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1396 - binary_accuracy: 0.9766 - balanced_acc: 0.863610/10 [==============================] - 1s 64ms/step - loss: 0.1489 - binary_accuracy: 0.9644 - balanced_acc: 0.8857 - val_loss: 0.2622 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6858
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1275 - binary_accuracy: 0.9844 - balanced_acc: 0.954010/10 [==============================] - 1s 64ms/step - loss: 0.1555 - binary_accuracy: 0.9652 - balanced_acc: 0.8490 - val_loss: 0.2455 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6887
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1471 - binary_accuracy: 0.9766 - balanced_acc: 0.936010/10 [==============================] - 1s 104ms/step - loss: 0.1591 - binary_accuracy: 0.9661 - balanced_acc: 0.8514 - val_loss: 0.2599 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7289
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1684 - binary_accuracy: 0.9531 - balanced_acc: 0.923410/10 [==============================] - 1s 63ms/step - loss: 0.1534 - binary_accuracy: 0.9652 - balanced_acc: 0.8905 - val_loss: 0.2465 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7884
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1197 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 1s 64ms/step - loss: 0.1327 - binary_accuracy: 0.9805 - balanced_acc: 0.9366 - val_loss: 0.2354 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7999
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1389 - binary_accuracy: 0.9922 - balanced_acc: 0.995610/10 [==============================] - 0s 5ms/step - loss: 0.1166 - binary_accuracy: 0.9864 - balanced_acc: 0.9038 - val_loss: 0.3033 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5966
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1005 - binary_accuracy: 0.9844 - balanced_acc: 0.991310/10 [==============================] - 0s 5ms/step - loss: 0.1107 - binary_accuracy: 0.9847 - balanced_acc: 0.9286 - val_loss: 0.2403 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7089
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0939 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 0s 5ms/step - loss: 0.1141 - binary_accuracy: 0.9822 - balanced_acc: 0.9442 - val_loss: 0.3096 - val_binary_accuracy: 0.9051 - val_balanced_acc: 0.5815
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1198 - binary_accuracy: 0.9688 - balanced_acc: 0.983310/10 [==============================] - 0s 5ms/step - loss: 0.1136 - binary_accuracy: 0.9805 - balanced_acc: 0.9462 - val_loss: 0.2774 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6539
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1402 - binary_accuracy: 0.9688 - balanced_acc: 0.931810/10 [==============================] - 0s 5ms/step - loss: 0.1143 - binary_accuracy: 0.9822 - balanced_acc: 0.9153 - val_loss: 0.3762 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5614
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1167 - binary_accuracy: 0.9844 - balanced_acc: 0.900010/10 [==============================] - 0s 5ms/step - loss: 0.1139 - binary_accuracy: 0.9822 - balanced_acc: 0.9476 - val_loss: 0.3110 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6126
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1764 - binary_accuracy: 0.9844 - balanced_acc: 0.937510/10 [==============================] - 0s 6ms/step - loss: 0.1165 - binary_accuracy: 0.9864 - balanced_acc: 0.9650 - val_loss: 0.3516 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6002
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0782 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 6ms/step - loss: 0.1026 - binary_accuracy: 0.9890 - balanced_acc: 0.9719 - val_loss: 0.2798 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6866
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0733 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0837 - binary_accuracy: 0.9941 - balanced_acc: 0.9867 - val_loss: 0.2842 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6464
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0698 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0806 - binary_accuracy: 0.9915 - balanced_acc: 0.9687 - val_loss: 0.2734 - val_binary_accuracy: 0.9017 - val_balanced_acc: 0.6855
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1018 - binary_accuracy: 0.9844 - balanced_acc: 0.991310/10 [==============================] - 0s 6ms/step - loss: 0.0748 - binary_accuracy: 0.9924 - balanced_acc: 0.9883 - val_loss: 0.2656 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6793
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0788 - binary_accuracy: 0.9922 - balanced_acc: 0.995710/10 [==============================] - 0s 5ms/step - loss: 0.0737 - binary_accuracy: 0.9941 - balanced_acc: 0.9925 - val_loss: 0.2741 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6511
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0599 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0694 - binary_accuracy: 0.9949 - balanced_acc: 0.9888 - val_loss: 0.2725 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6081
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0696 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 0s 5ms/step - loss: 0.0651 - binary_accuracy: 0.9966 - balanced_acc: 0.9983 - val_loss: 0.2598 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6608
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0636 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0630 - binary_accuracy: 0.9966 - balanced_acc: 0.9983 - val_loss: 0.2583 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6622
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0568 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0606 - binary_accuracy: 0.9975 - balanced_acc: 0.9487 - val_loss: 0.2606 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6483
Epoch 32/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0565 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.0593 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2601 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6512
Epoch 33/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0690 - binary_accuracy: 0.9922 - balanced_acc: 0.995710/10 [==============================] - 0s 5ms/step - loss: 0.0580 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2543 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6497
Epoch 34/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0482 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0584 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2533 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6512
Epoch 35/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0498 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0574 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2500 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6669
Epoch 36/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0535 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0575 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2502 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6669
Epoch 37/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0509 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0560 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2504 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6483
Epoch 38/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0694 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 0s 5ms/step - loss: 0.0578 - binary_accuracy: 0.9975 - balanced_acc: 0.9988 - val_loss: 0.2507 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6498
Epoch 39/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0515 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0558 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2520 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6326
Epoch 40/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0511 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0559 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2524 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6326
Epoch 41/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0530 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0559 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2525 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6326
Epoch 42/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0480 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.0571 - binary_accuracy: 0.9966 - balanced_acc: 0.9937 - val_loss: 0.2525 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6326
Epoch 43/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0481 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0544 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2520 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6326
Epoch 44/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0495 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0566 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2520 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6326
Epoch 45/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0532 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 5ms/step - loss: 0.0562 - binary_accuracy: 0.9975 - balanced_acc: 0.9487 - val_loss: 0.2521 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6326

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3315 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 852us/step - loss: 0.3631 - binary_accuracy: 0.9103 - balanced_acc: 0.5608

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-54-57Z

Training run 14/648 (flags = list(0, 256, 0.2, 128, 2048, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-55-08Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.5532 - binary_accuracy: 0.5156 - balanced_acc: 0.457510/10 [==============================] - 1s 80ms/step - loss: 1.4085 - binary_accuracy: 0.8694 - balanced_acc: 0.5057 - val_loss: 1.2428 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.2181 - binary_accuracy: 0.9531 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 1.1831 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1116 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1073 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 1.1008 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0738 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0216 - binary_accuracy: 0.9453 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0744 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0503 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1303 - binary_accuracy: 0.8828 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 1.0451 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0226 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0392 - binary_accuracy: 0.9062 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0160 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9985 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9946 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.9902 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9747 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9528 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.9653 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9515 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9107 - binary_accuracy: 0.9453 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.9416 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9299 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9127 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 0.9175 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9083 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9023 - binary_accuracy: 0.9141 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8937 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8874 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9031 - binary_accuracy: 0.9062 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8775 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8854 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8675 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8755 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8834 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8514 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8726 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8813 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8729 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8711 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8792 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9453 - binary_accuracy: 0.8828 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8683 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8771 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8859 - binary_accuracy: 0.8984 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8652 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8750 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8535 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8642 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8730 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8112 - binary_accuracy: 0.9375 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8610 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8709 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8611 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8586 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8688 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8528 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 0.8563 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8667 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9440 - binary_accuracy: 0.8750 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 0.8543 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8665 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8358 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8539 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8663 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8529 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8533 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8661 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8587 - binary_accuracy: 0.9141 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8537 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8658 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9037 - binary_accuracy: 0.8984 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8538 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8656 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8571 - binary_accuracy: 0.9141 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8529 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8654 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8664 - binary_accuracy: 0.9062 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8531 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8652 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8244 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8528 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8650 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8976 - binary_accuracy: 0.8828 - balanced_acc: 0.500010/10 [==============================] - 0s 9ms/step - loss: 0.8522 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8647 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8348 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.8528 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8645 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.8777 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 1ms/step - loss: 0.8459 - binary_accuracy: 0.9402 - balanced_acc: 0.5000

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-55-08Z

Training run 15/648 (flags = list(0, 512, 0.3, 64, 256, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-55-12Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 1.6951 - binary_accuracy: 0.6094 - balanced_acc: 0.422018/19 [===========================>..] - ETA: 0s - loss: 1.0092 - binary_accuracy: 0.9019 - balanced_acc: 0.495719/19 [==============================] - 1s 55ms/step - loss: 1.0034 - binary_accuracy: 0.9016 - balanced_acc: 0.4959 - val_loss: 0.6266 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5962 - binary_accuracy: 0.9531 - balanced_acc: 0.500019/19 [==============================] - ETA: 0s - loss: 0.4948 - binary_accuracy: 0.9203 - balanced_acc: 0.522319/19 [==============================] - 0s 4ms/step - loss: 0.4948 - binary_accuracy: 0.9203 - balanced_acc: 0.5223 - val_loss: 0.3986 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3440 - binary_accuracy: 0.8906 - balanced_acc: 0.500019/19 [==============================] - ETA: 0s - loss: 0.3025 - binary_accuracy: 0.9338 - balanced_acc: 0.628419/19 [==============================] - 1s 36ms/step - loss: 0.3025 - binary_accuracy: 0.9338 - balanced_acc: 0.6284 - val_loss: 0.3328 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7911
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3010 - binary_accuracy: 0.9375 - balanced_acc: 0.808719/19 [==============================] - ETA: 0s - loss: 0.2760 - binary_accuracy: 0.9355 - balanced_acc: 0.671719/19 [==============================] - 0s 4ms/step - loss: 0.2760 - binary_accuracy: 0.9355 - balanced_acc: 0.6717 - val_loss: 0.2729 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6516
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2703 - binary_accuracy: 0.9219 - balanced_acc: 0.768219/19 [==============================] - ETA: 0s - loss: 0.2318 - binary_accuracy: 0.9466 - balanced_acc: 0.766319/19 [==============================] - 0s 4ms/step - loss: 0.2318 - binary_accuracy: 0.9466 - balanced_acc: 0.7663 - val_loss: 0.3067 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5455
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3003 - binary_accuracy: 0.9375 - balanced_acc: 0.750019/19 [==============================] - ETA: 0s - loss: 0.2067 - binary_accuracy: 0.9534 - balanced_acc: 0.789019/19 [==============================] - 0s 4ms/step - loss: 0.2067 - binary_accuracy: 0.9534 - balanced_acc: 0.7890 - val_loss: 0.3360 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5400
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2000 - binary_accuracy: 0.9531 - balanced_acc: 0.750019/19 [==============================] - ETA: 0s - loss: 0.1749 - binary_accuracy: 0.9610 - balanced_acc: 0.819019/19 [==============================] - 0s 4ms/step - loss: 0.1749 - binary_accuracy: 0.9610 - balanced_acc: 0.8190 - val_loss: 0.2415 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6488
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0944 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.1543 - binary_accuracy: 0.9720 - balanced_acc: 0.875219/19 [==============================] - 0s 4ms/step - loss: 0.1543 - binary_accuracy: 0.9720 - balanced_acc: 0.8752 - val_loss: 0.2944 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6282
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0986 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.1601 - binary_accuracy: 0.9695 - balanced_acc: 0.909319/19 [==============================] - 0s 4ms/step - loss: 0.1601 - binary_accuracy: 0.9695 - balanced_acc: 0.9093 - val_loss: 0.2929 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1586 - binary_accuracy: 0.9531 - balanced_acc: 0.883119/19 [==============================] - 0s 4ms/step - loss: 0.1719 - binary_accuracy: 0.9652 - balanced_acc: 0.8662 - val_loss: 0.2712 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7358
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1270 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1414 - binary_accuracy: 0.9771 - balanced_acc: 0.9279 - val_loss: 0.3138 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6204
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1016 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.1437 - binary_accuracy: 0.9729 - balanced_acc: 0.898719/19 [==============================] - 0s 4ms/step - loss: 0.1437 - binary_accuracy: 0.9729 - balanced_acc: 0.8987 - val_loss: 0.3032 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6839
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1875 - binary_accuracy: 0.9219 - balanced_acc: 0.866119/19 [==============================] - ETA: 0s - loss: 0.1369 - binary_accuracy: 0.9746 - balanced_acc: 0.913519/19 [==============================] - 0s 4ms/step - loss: 0.1369 - binary_accuracy: 0.9746 - balanced_acc: 0.9135 - val_loss: 0.3019 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6371
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1237 - binary_accuracy: 0.9844 - balanced_acc: 0.991519/19 [==============================] - ETA: 0s - loss: 0.1074 - binary_accuracy: 0.9890 - balanced_acc: 0.977819/19 [==============================] - 0s 4ms/step - loss: 0.1074 - binary_accuracy: 0.9890 - balanced_acc: 0.9778 - val_loss: 0.2998 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6204
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0870 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.0974 - binary_accuracy: 0.9924 - balanced_acc: 0.9854 - val_loss: 0.2983 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6004
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1091 - binary_accuracy: 0.9844 - balanced_acc: 0.991219/19 [==============================] - ETA: 0s - loss: 0.0920 - binary_accuracy: 0.9941 - balanced_acc: 0.963519/19 [==============================] - 0s 4ms/step - loss: 0.0920 - binary_accuracy: 0.9941 - balanced_acc: 0.9635 - val_loss: 0.2953 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6004
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0844 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0884 - binary_accuracy: 0.9949 - balanced_acc: 0.981119/19 [==============================] - 0s 4ms/step - loss: 0.0884 - binary_accuracy: 0.9949 - balanced_acc: 0.9811 - val_loss: 0.2939 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6004
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0887 - binary_accuracy: 0.9844 - balanced_acc: 0.991419/19 [==============================] - ETA: 0s - loss: 0.0830 - binary_accuracy: 0.9949 - balanced_acc: 0.980619/19 [==============================] - 0s 4ms/step - loss: 0.0830 - binary_accuracy: 0.9949 - balanced_acc: 0.9806 - val_loss: 0.2894 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6004
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0811 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.0794 - binary_accuracy: 0.9966 - balanced_acc: 0.9921 - val_loss: 0.2871 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6004
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0739 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0767 - binary_accuracy: 0.9958 - balanced_acc: 0.993819/19 [==============================] - 0s 4ms/step - loss: 0.0767 - binary_accuracy: 0.9958 - balanced_acc: 0.9938 - val_loss: 0.2918 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6004
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0811 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0729 - binary_accuracy: 0.9966 - balanced_acc: 0.994919/19 [==============================] - 0s 4ms/step - loss: 0.0729 - binary_accuracy: 0.9966 - balanced_acc: 0.9949 - val_loss: 0.2846 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6004
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0720 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0703 - binary_accuracy: 0.9975 - balanced_acc: 0.998719/19 [==============================] - 0s 4ms/step - loss: 0.0703 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.2889 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6021
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0666 - binary_accuracy: 1.0000 - balanced_acc: 1.000018/19 [===========================>..] - ETA: 0s - loss: 0.0707 - binary_accuracy: 0.9957 - balanced_acc: 0.988419/19 [==============================] - 0s 4ms/step - loss: 0.0709 - binary_accuracy: 0.9958 - balanced_acc: 0.9890 - val_loss: 0.2728 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6654
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0631 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0686 - binary_accuracy: 0.9983 - balanced_acc: 0.999119/19 [==============================] - 0s 4ms/step - loss: 0.0686 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2740 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6654
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0633 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0670 - binary_accuracy: 0.9992 - balanced_acc: 0.999619/19 [==============================] - 0s 4ms/step - loss: 0.0670 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2755 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6488
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0609 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0665 - binary_accuracy: 0.9992 - balanced_acc: 0.999619/19 [==============================] - 0s 4ms/step - loss: 0.0665 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2761 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6488
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0682 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.0658 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2767 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6504
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0649 - binary_accuracy: 1.0000 - balanced_acc: 1.000011/19 [================>.............] - ETA: 0s - loss: 0.0649 - binary_accuracy: 0.9972 - balanced_acc: 0.998519/19 [==============================] - 0s 6ms/step - loss: 0.0659 - binary_accuracy: 0.9975 - balanced_acc: 0.9947 - val_loss: 0.2768 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6504
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0837 - binary_accuracy: 0.9844 - balanced_acc: 0.900018/19 [===========================>..] - ETA: 0s - loss: 0.0661 - binary_accuracy: 0.9983 - balanced_acc: 0.994019/19 [==============================] - 0s 5ms/step - loss: 0.0661 - binary_accuracy: 0.9983 - balanced_acc: 0.9943 - val_loss: 0.2763 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6504
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0781 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0660 - binary_accuracy: 0.9983 - balanced_acc: 0.999119/19 [==============================] - 0s 4ms/step - loss: 0.0660 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2759 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6504
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0574 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0654 - binary_accuracy: 0.9975 - balanced_acc: 0.964019/19 [==============================] - 0s 4ms/step - loss: 0.0654 - binary_accuracy: 0.9975 - balanced_acc: 0.9640 - val_loss: 0.2771 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6504
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0741 - binary_accuracy: 0.9844 - balanced_acc: 0.991419/19 [==============================] - ETA: 0s - loss: 0.0649 - binary_accuracy: 0.9966 - balanced_acc: 0.995319/19 [==============================] - 0s 4ms/step - loss: 0.0649 - binary_accuracy: 0.9966 - balanced_acc: 0.9953 - val_loss: 0.2778 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6504
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0684 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - ETA: 0s - loss: 0.0646 - binary_accuracy: 0.9983 - balanced_acc: 0.998519/19 [==============================] - 0s 4ms/step - loss: 0.0646 - binary_accuracy: 0.9983 - balanced_acc: 0.9985 - val_loss: 0.2771 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6504

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3854 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3541 - binary_accuracy: 0.9130 - balanced_acc: 0.5750

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-55-12Z

Training run 16/648 (flags = list(0, 1024, 0.3, 256, 1024, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-55-18Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 2.7510 - binary_accuracy: 0.4688 - balanced_acc: 0.41435/5 [==============================] - 1s 158ms/step - loss: 2.3484 - binary_accuracy: 0.8227 - balanced_acc: 0.4829 - val_loss: 2.1034 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0688 - binary_accuracy: 0.9297 - balanced_acc: 0.50005/5 [==============================] - 0s 12ms/step - loss: 1.9769 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.7840 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 1.7804 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 12ms/step - loss: 1.6873 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.5195 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 1.4661 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 12ms/step - loss: 1.4258 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.3112 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 1.3041 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 11ms/step - loss: 1.2041 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1144 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 1.1042 - binary_accuracy: 0.9062 - balanced_acc: 0.52005/5 [==============================] - 1s 131ms/step - loss: 1.0197 - binary_accuracy: 0.9313 - balanced_acc: 0.5972 - val_loss: 0.9603 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5132
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9061 - binary_accuracy: 0.9414 - balanced_acc: 0.62505/5 [==============================] - 0s 11ms/step - loss: 0.8597 - binary_accuracy: 0.9355 - balanced_acc: 0.6177 - val_loss: 0.8528 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5132
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 0.7767 - binary_accuracy: 0.9375 - balanced_acc: 0.67185/5 [==============================] - 1s 128ms/step - loss: 0.7283 - binary_accuracy: 0.9474 - balanced_acc: 0.6933 - val_loss: 0.7344 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5526
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.6379 - binary_accuracy: 0.9688 - balanced_acc: 0.74795/5 [==============================] - 0s 12ms/step - loss: 0.6165 - binary_accuracy: 0.9703 - balanced_acc: 0.8338 - val_loss: 0.6698 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5395
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.5358 - binary_accuracy: 0.9922 - balanced_acc: 0.94125/5 [==============================] - 1s 128ms/step - loss: 0.5252 - binary_accuracy: 0.9830 - balanced_acc: 0.9171 - val_loss: 0.5916 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6414
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4705 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 12ms/step - loss: 0.4489 - binary_accuracy: 0.9958 - balanced_acc: 0.9900 - val_loss: 0.5742 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5263
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4040 - binary_accuracy: 0.9961 - balanced_acc: 0.97505/5 [==============================] - 1s 215ms/step - loss: 0.3944 - binary_accuracy: 0.9890 - balanced_acc: 0.9452 - val_loss: 0.4821 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7250
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3674 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 12ms/step - loss: 0.3467 - binary_accuracy: 0.9949 - balanced_acc: 0.9855 - val_loss: 0.5223 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5395
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3249 - binary_accuracy: 0.9844 - balanced_acc: 0.92295/5 [==============================] - 0s 13ms/step - loss: 0.3084 - binary_accuracy: 0.9924 - balanced_acc: 0.9682 - val_loss: 0.4325 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6997
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2886 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 12ms/step - loss: 0.2754 - binary_accuracy: 0.9983 - balanced_acc: 0.9964 - val_loss: 0.4520 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5395
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2535 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.2478 - binary_accuracy: 0.9966 - balanced_acc: 0.9806 - val_loss: 0.3945 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6361
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2358 - binary_accuracy: 0.9922 - balanced_acc: 0.99575/5 [==============================] - 0s 13ms/step - loss: 0.2258 - binary_accuracy: 0.9966 - balanced_acc: 0.9983 - val_loss: 0.4132 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5526
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2081 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.2042 - binary_accuracy: 0.9975 - balanced_acc: 0.9906 - val_loss: 0.3380 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6926
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1907 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 14ms/step - loss: 0.1833 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3639 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6151
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1746 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1695 - binary_accuracy: 0.9983 - balanced_acc: 0.9845 - val_loss: 0.3144 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7047
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1577 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1547 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3377 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6141
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1465 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1439 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.2977 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6311
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1327 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1341 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2996 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6311
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1312 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1324 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3062 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1315 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1312 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3115 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1317 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1303 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3100 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1288 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1288 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3042 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1272 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1280 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2991 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1266 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1269 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2965 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1281 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1259 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2964 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1264 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 19ms/step - loss: 0.1248 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2977 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 32/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1236 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 14ms/step - loss: 0.1239 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2985 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 33/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1240 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1231 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2983 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 34/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1202 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1231 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2981 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 35/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1236 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1227 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2979 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 36/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1229 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1229 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2974 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 37/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1219 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1228 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2971 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 38/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1206 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1225 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2967 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6120
Epoch 39/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1246 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 12ms/step - loss: 0.1227 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2963 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 40/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1224 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1222 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2959 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 41/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1230 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1223 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2957 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 42/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1242 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 13ms/step - loss: 0.1219 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2954 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3971 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3722 - binary_accuracy: 0.9266 - balanced_acc: 0.5819

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-55-18Z

Training run 17/648 (flags = list(0.2, 256, 0.3, 256, 256, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-55-27Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 1.3561 - binary_accuracy: 0.5234 - balanced_acc: 0.44435/5 [==============================] - 1s 155ms/step - loss: 1.3138 - binary_accuracy: 0.6701 - balanced_acc: 0.4656 - val_loss: 1.2512 - val_binary_accuracy: 0.9017 - val_balanced_acc: 0.4997
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 1.2375 - binary_accuracy: 0.8828 - balanced_acc: 0.47485/5 [==============================] - 1s 126ms/step - loss: 1.2139 - binary_accuracy: 0.8906 - balanced_acc: 0.4919 - val_loss: 1.1618 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 1.1593 - binary_accuracy: 0.9141 - balanced_acc: 0.49795/5 [==============================] - 0s 7ms/step - loss: 1.1309 - binary_accuracy: 0.9160 - balanced_acc: 0.4987 - val_loss: 1.0887 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0628 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 1.0628 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0306 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0439 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 1.0140 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9863 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0032 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.9759 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9535 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9562 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9444 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9297 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9390 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9265 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9129 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8643 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.9095 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9005 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8693 - binary_accuracy: 0.9336 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8955 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8909 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8781 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8857 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8826 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8761 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8820 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8750 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8567 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.8752 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8742 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8712 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8721 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8734 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8598 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8761 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8726 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8917 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.8695 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8718 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8886 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8756 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8710 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8806 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.8728 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8702 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8050 - binary_accuracy: 0.9414 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8730 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8694 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8748 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8714 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8686 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8721 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8724 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8678 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9071 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8679 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8670 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8521 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8653 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8669 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8803 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.8709 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8668 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8726 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.8685 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8667 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8845 - binary_accuracy: 0.9062 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.8629 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8667 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8644 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8719 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8666 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8677 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8649 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8665 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8477 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8682 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8664 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9422 - binary_accuracy: 0.8867 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8698 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8663 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8782 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8674 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8662 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 32/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8802 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 7ms/step - loss: 0.8693 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8661 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.8552 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 911us/step - loss: 0.8420 - binary_accuracy: 0.9402 - balanced_acc: 0.5000

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-55-27Z

Training run 18/648 (flags = list(0.1, 256, 0.4, 64, 1024, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-55-31Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 1.5242 - binary_accuracy: 0.3750 - balanced_acc: 0.569516/19 [========================>.....] - ETA: 0s - loss: 0.8991 - binary_accuracy: 0.8828 - balanced_acc: 0.504319/19 [==============================] - 1s 44ms/step - loss: 0.8601 - binary_accuracy: 0.8897 - balanced_acc: 0.5089 - val_loss: 0.5622 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4960 - binary_accuracy: 0.9531 - balanced_acc: 0.500017/19 [=========================>....] - ETA: 0s - loss: 0.4523 - binary_accuracy: 0.9219 - balanced_acc: 0.567019/19 [==============================] - 0s 5ms/step - loss: 0.4414 - binary_accuracy: 0.9254 - balanced_acc: 0.5863 - val_loss: 0.3927 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3223 - binary_accuracy: 0.9062 - balanced_acc: 0.571417/19 [=========================>....] - ETA: 0s - loss: 0.2792 - binary_accuracy: 0.9421 - balanced_acc: 0.706519/19 [==============================] - 1s 34ms/step - loss: 0.2834 - binary_accuracy: 0.9406 - balanced_acc: 0.7011 - val_loss: 0.2772 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6683
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2099 - binary_accuracy: 0.9688 - balanced_acc: 0.666717/19 [=========================>....] - ETA: 0s - loss: 0.2263 - binary_accuracy: 0.9568 - balanced_acc: 0.808419/19 [==============================] - 0s 4ms/step - loss: 0.2440 - binary_accuracy: 0.9500 - balanced_acc: 0.7857 - val_loss: 0.2995 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6354
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2270 - binary_accuracy: 0.9375 - balanced_acc: 0.714317/19 [=========================>....] - ETA: 0s - loss: 0.2391 - binary_accuracy: 0.9540 - balanced_acc: 0.805419/19 [==============================] - 0s 4ms/step - loss: 0.2390 - binary_accuracy: 0.9525 - balanced_acc: 0.7947 - val_loss: 0.2709 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6050
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2696 - binary_accuracy: 0.9375 - balanced_acc: 0.750017/19 [=========================>....] - ETA: 0s - loss: 0.2038 - binary_accuracy: 0.9605 - balanced_acc: 0.835119/19 [==============================] - 0s 4ms/step - loss: 0.2030 - binary_accuracy: 0.9610 - balanced_acc: 0.8186 - val_loss: 0.2702 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6099
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1372 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.1745 - binary_accuracy: 0.9596 - balanced_acc: 0.855819/19 [==============================] - 0s 4ms/step - loss: 0.1773 - binary_accuracy: 0.9593 - balanced_acc: 0.8490 - val_loss: 0.2590 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6521
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1048 - binary_accuracy: 0.9844 - balanced_acc: 0.833317/19 [=========================>....] - ETA: 0s - loss: 0.1684 - binary_accuracy: 0.9651 - balanced_acc: 0.853619/19 [==============================] - 0s 5ms/step - loss: 0.1761 - binary_accuracy: 0.9644 - balanced_acc: 0.8269 - val_loss: 0.3119 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6004
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1332 - binary_accuracy: 0.9844 - balanced_acc: 0.900017/19 [=========================>....] - ETA: 0s - loss: 0.1754 - binary_accuracy: 0.9623 - balanced_acc: 0.869619/19 [==============================] - 1s 49ms/step - loss: 0.1733 - binary_accuracy: 0.9635 - balanced_acc: 0.8819 - val_loss: 0.2593 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7357
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1670 - binary_accuracy: 0.9688 - balanced_acc: 0.983116/19 [========================>.....] - ETA: 0s - loss: 0.1522 - binary_accuracy: 0.9717 - balanced_acc: 0.877119/19 [==============================] - 1s 35ms/step - loss: 0.1602 - binary_accuracy: 0.9695 - balanced_acc: 0.8741 - val_loss: 0.2603 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7675
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1010 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.1361 - binary_accuracy: 0.9724 - balanced_acc: 0.918719/19 [==============================] - 0s 4ms/step - loss: 0.1416 - binary_accuracy: 0.9703 - balanced_acc: 0.9160 - val_loss: 0.2717 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6521
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1159 - binary_accuracy: 0.9844 - balanced_acc: 0.916717/19 [=========================>....] - ETA: 0s - loss: 0.1613 - binary_accuracy: 0.9642 - balanced_acc: 0.866019/19 [==============================] - 0s 4ms/step - loss: 0.1643 - binary_accuracy: 0.9627 - balanced_acc: 0.8558 - val_loss: 0.2635 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7053
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2243 - binary_accuracy: 0.9375 - balanced_acc: 0.874618/19 [===========================>..] - ETA: 0s - loss: 0.1629 - binary_accuracy: 0.9696 - balanced_acc: 0.874019/19 [==============================] - 0s 4ms/step - loss: 0.1630 - binary_accuracy: 0.9695 - balanced_acc: 0.8675 - val_loss: 0.2826 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6483
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1362 - binary_accuracy: 0.9531 - balanced_acc: 0.700017/19 [=========================>....] - ETA: 0s - loss: 0.1530 - binary_accuracy: 0.9743 - balanced_acc: 0.903119/19 [==============================] - 0s 4ms/step - loss: 0.1561 - binary_accuracy: 0.9737 - balanced_acc: 0.8833 - val_loss: 0.3586 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5650
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1430 - binary_accuracy: 0.9844 - balanced_acc: 0.833317/19 [=========================>....] - ETA: 0s - loss: 0.1682 - binary_accuracy: 0.9660 - balanced_acc: 0.840119/19 [==============================] - 0s 5ms/step - loss: 0.1735 - binary_accuracy: 0.9644 - balanced_acc: 0.8487 - val_loss: 0.2580 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7341
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1645 - binary_accuracy: 0.9844 - balanced_acc: 0.991217/19 [=========================>....] - ETA: 0s - loss: 0.1760 - binary_accuracy: 0.9642 - balanced_acc: 0.873019/19 [==============================] - 0s 5ms/step - loss: 0.1714 - binary_accuracy: 0.9661 - balanced_acc: 0.8469 - val_loss: 0.3230 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6721
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1429 - binary_accuracy: 0.9844 - balanced_acc: 0.954517/19 [=========================>....] - ETA: 0s - loss: 0.1449 - binary_accuracy: 0.9789 - balanced_acc: 0.917119/19 [==============================] - 0s 5ms/step - loss: 0.1481 - binary_accuracy: 0.9788 - balanced_acc: 0.9126 - val_loss: 0.3376 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6021
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1171 - binary_accuracy: 0.9844 - balanced_acc: 0.916717/19 [=========================>....] - ETA: 0s - loss: 0.1342 - binary_accuracy: 0.9789 - balanced_acc: 0.924919/19 [==============================] - 0s 5ms/step - loss: 0.1350 - binary_accuracy: 0.9779 - balanced_acc: 0.9219 - val_loss: 0.2774 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7409
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1000 - binary_accuracy: 1.0000 - balanced_acc: 1.000018/19 [===========================>..] - ETA: 0s - loss: 0.1479 - binary_accuracy: 0.9740 - balanced_acc: 0.874319/19 [==============================] - 1s 36ms/step - loss: 0.1502 - binary_accuracy: 0.9737 - balanced_acc: 0.8677 - val_loss: 0.2390 - val_binary_accuracy: 0.9492 - val_balanced_acc: 0.8542
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1314 - binary_accuracy: 0.9688 - balanced_acc: 0.908018/19 [===========================>..] - ETA: 0s - loss: 0.1467 - binary_accuracy: 0.9748 - balanced_acc: 0.926519/19 [==============================] - 0s 4ms/step - loss: 0.1478 - binary_accuracy: 0.9737 - balanced_acc: 0.9284 - val_loss: 0.3158 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7665
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1370 - binary_accuracy: 0.9844 - balanced_acc: 0.928618/19 [===========================>..] - ETA: 0s - loss: 0.1390 - binary_accuracy: 0.9826 - balanced_acc: 0.924819/19 [==============================] - 0s 4ms/step - loss: 0.1399 - binary_accuracy: 0.9813 - balanced_acc: 0.9112 - val_loss: 0.3275 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6237
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1445 - binary_accuracy: 0.9844 - balanced_acc: 0.937517/19 [=========================>....] - ETA: 0s - loss: 0.1442 - binary_accuracy: 0.9779 - balanced_acc: 0.931919/19 [==============================] - 0s 4ms/step - loss: 0.1435 - binary_accuracy: 0.9779 - balanced_acc: 0.9382 - val_loss: 0.3532 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6892
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1304 - binary_accuracy: 0.9844 - balanced_acc: 0.991217/19 [=========================>....] - ETA: 0s - loss: 0.1504 - binary_accuracy: 0.9743 - balanced_acc: 0.908819/19 [==============================] - 0s 4ms/step - loss: 0.1580 - binary_accuracy: 0.9729 - balanced_acc: 0.9118 - val_loss: 0.3099 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7192
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1380 - binary_accuracy: 0.9844 - balanced_acc: 0.916717/19 [=========================>....] - ETA: 0s - loss: 0.1455 - binary_accuracy: 0.9752 - balanced_acc: 0.892219/19 [==============================] - 0s 5ms/step - loss: 0.1475 - binary_accuracy: 0.9746 - balanced_acc: 0.9022 - val_loss: 0.3022 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7425
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1099 - binary_accuracy: 0.9844 - balanced_acc: 0.991118/19 [===========================>..] - ETA: 0s - loss: 0.1593 - binary_accuracy: 0.9722 - balanced_acc: 0.907219/19 [==============================] - 0s 4ms/step - loss: 0.1649 - binary_accuracy: 0.9695 - balanced_acc: 0.8910 - val_loss: 0.3464 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6021
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1039 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.1994 - binary_accuracy: 0.9559 - balanced_acc: 0.866619/19 [==============================] - 0s 4ms/step - loss: 0.1974 - binary_accuracy: 0.9576 - balanced_acc: 0.8750 - val_loss: 0.3388 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6404
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2008 - binary_accuracy: 0.9688 - balanced_acc: 0.833317/19 [=========================>....] - ETA: 0s - loss: 0.1881 - binary_accuracy: 0.9688 - balanced_acc: 0.855619/19 [==============================] - 0s 4ms/step - loss: 0.1871 - binary_accuracy: 0.9695 - balanced_acc: 0.8677 - val_loss: 0.3359 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7496
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1799 - binary_accuracy: 0.9688 - balanced_acc: 0.928617/19 [=========================>....] - ETA: 0s - loss: 0.1667 - binary_accuracy: 0.9779 - balanced_acc: 0.924619/19 [==============================] - 0s 4ms/step - loss: 0.1648 - binary_accuracy: 0.9788 - balanced_acc: 0.9321 - val_loss: 0.3061 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.8129
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1618 - binary_accuracy: 0.9688 - balanced_acc: 0.983117/19 [=========================>....] - ETA: 0s - loss: 0.1251 - binary_accuracy: 0.9862 - balanced_acc: 0.945619/19 [==============================] - 0s 4ms/step - loss: 0.1269 - binary_accuracy: 0.9847 - balanced_acc: 0.9494 - val_loss: 0.3048 - val_binary_accuracy: 0.9492 - val_balanced_acc: 0.7788
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1135 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.1125 - binary_accuracy: 0.9936 - balanced_acc: 0.996519/19 [==============================] - 0s 4ms/step - loss: 0.1119 - binary_accuracy: 0.9932 - balanced_acc: 0.9964 - val_loss: 0.3228 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6738
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0885 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.1084 - binary_accuracy: 0.9917 - balanced_acc: 0.972519/19 [==============================] - 0s 4ms/step - loss: 0.1071 - binary_accuracy: 0.9924 - balanced_acc: 0.9491 - val_loss: 0.3318 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6538
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1440 - binary_accuracy: 0.9688 - balanced_acc: 0.982818/19 [===========================>..] - ETA: 0s - loss: 0.1021 - binary_accuracy: 0.9931 - balanced_acc: 0.984619/19 [==============================] - 0s 4ms/step - loss: 0.1023 - binary_accuracy: 0.9924 - balanced_acc: 0.9767 - val_loss: 0.3299 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7188
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1125 - binary_accuracy: 0.9844 - balanced_acc: 0.991918/19 [===========================>..] - ETA: 0s - loss: 0.0953 - binary_accuracy: 0.9948 - balanced_acc: 0.985319/19 [==============================] - 0s 4ms/step - loss: 0.0964 - binary_accuracy: 0.9941 - balanced_acc: 0.9850 - val_loss: 0.3284 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7421
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0860 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0953 - binary_accuracy: 0.9954 - balanced_acc: 0.992119/19 [==============================] - 0s 4ms/step - loss: 0.0945 - binary_accuracy: 0.9958 - balanced_acc: 0.9929 - val_loss: 0.3242 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7221
Epoch 35/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0806 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0929 - binary_accuracy: 0.9972 - balanced_acc: 0.969119/19 [==============================] - 0s 4ms/step - loss: 0.0919 - binary_accuracy: 0.9975 - balanced_acc: 0.9723 - val_loss: 0.3297 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7254
Epoch 36/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0747 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0895 - binary_accuracy: 0.9945 - balanced_acc: 0.965319/19 [==============================] - 0s 5ms/step - loss: 0.0894 - binary_accuracy: 0.9941 - balanced_acc: 0.9678 - val_loss: 0.3145 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7454
Epoch 37/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0814 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0844 - binary_accuracy: 0.9982 - balanced_acc: 0.999019/19 [==============================] - 0s 4ms/step - loss: 0.0844 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.3299 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7004
Epoch 38/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0796 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0886 - binary_accuracy: 0.9936 - balanced_acc: 0.981219/19 [==============================] - 0s 4ms/step - loss: 0.0881 - binary_accuracy: 0.9941 - balanced_acc: 0.9831 - val_loss: 0.3196 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7454
Epoch 39/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0785 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0820 - binary_accuracy: 0.9972 - balanced_acc: 0.994119/19 [==============================] - 0s 4ms/step - loss: 0.0823 - binary_accuracy: 0.9975 - balanced_acc: 0.9948 - val_loss: 0.3141 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 40/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0766 - binary_accuracy: 1.0000 - balanced_acc: 1.000016/19 [========================>.....] - ETA: 0s - loss: 0.0835 - binary_accuracy: 0.9971 - balanced_acc: 0.995019/19 [==============================] - 0s 5ms/step - loss: 0.0820 - binary_accuracy: 0.9975 - balanced_acc: 0.9958 - val_loss: 0.3144 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 41/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0737 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0785 - binary_accuracy: 0.9982 - balanced_acc: 0.994619/19 [==============================] - 0s 4ms/step - loss: 0.0810 - binary_accuracy: 0.9966 - balanced_acc: 0.9881 - val_loss: 0.3153 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 42/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0889 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0768 - binary_accuracy: 0.9991 - balanced_acc: 0.999519/19 [==============================] - 0s 4ms/step - loss: 0.0768 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3146 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 43/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0695 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0839 - binary_accuracy: 0.9963 - balanced_acc: 0.998019/19 [==============================] - 0s 4ms/step - loss: 0.0837 - binary_accuracy: 0.9966 - balanced_acc: 0.9982 - val_loss: 0.3153 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 44/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0731 - binary_accuracy: 1.0000 - balanced_acc: 1.000016/19 [========================>.....] - ETA: 0s - loss: 0.0820 - binary_accuracy: 0.9951 - balanced_acc: 0.997419/19 [==============================] - 0s 5ms/step - loss: 0.0828 - binary_accuracy: 0.9949 - balanced_acc: 0.9974 - val_loss: 0.3159 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 45/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0752 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0801 - binary_accuracy: 0.9963 - balanced_acc: 0.991119/19 [==============================] - 0s 5ms/step - loss: 0.0794 - binary_accuracy: 0.9966 - balanced_acc: 0.9657 - val_loss: 0.3158 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 46/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0773 - binary_accuracy: 1.0000 - balanced_acc: 1.000016/19 [========================>.....] - ETA: 0s - loss: 0.0762 - binary_accuracy: 0.9990 - balanced_acc: 0.994819/19 [==============================] - 0s 5ms/step - loss: 0.0792 - binary_accuracy: 0.9983 - balanced_acc: 0.9952 - val_loss: 0.3159 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 47/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0786 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0753 - binary_accuracy: 0.9991 - balanced_acc: 0.999519/19 [==============================] - 0s 4ms/step - loss: 0.0763 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3153 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 48/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0656 - binary_accuracy: 1.0000 - balanced_acc: 1.000016/19 [========================>.....] - ETA: 0s - loss: 0.0770 - binary_accuracy: 0.9980 - balanced_acc: 0.998919/19 [==============================] - 0s 5ms/step - loss: 0.0769 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.3157 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437
Epoch 49/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0723 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.0786 - binary_accuracy: 0.9972 - balanced_acc: 0.998519/19 [==============================] - 0s 5ms/step - loss: 0.0781 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3162 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7437

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.5253 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 962us/step - loss: 0.3904 - binary_accuracy: 0.9266 - balanced_acc: 0.5819

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-55-31Z

Training run 19/648 (flags = list(0.1, 1024, 0.3, 128, 2048, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-55-40Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 3.0581 - binary_accuracy: 0.6562 - balanced_acc: 0.3993 7/10 [====================>.........] - ETA: 0s - loss: 3.4052 - binary_accuracy: 0.8806 - balanced_acc: 0.485610/10 [==============================] - 1s 87ms/step - loss: 3.0896 - binary_accuracy: 0.8923 - balanced_acc: 0.4899 - val_loss: 2.0623 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.9894 - binary_accuracy: 0.9531 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 1.9221 - binary_accuracy: 0.9036 - balanced_acc: 0.499310/10 [==============================] - 0s 12ms/step - loss: 1.7520 - binary_accuracy: 0.9177 - balanced_acc: 0.4996 - val_loss: 1.3077 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.3010 - binary_accuracy: 0.9219 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 1.1517 - binary_accuracy: 0.9310 - balanced_acc: 0.608210/10 [==============================] - 1s 72ms/step - loss: 1.0850 - binary_accuracy: 0.9288 - balanced_acc: 0.6142 - val_loss: 0.8260 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6445
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7762 - binary_accuracy: 0.9688 - balanced_acc: 0.8489 7/10 [====================>.........] - ETA: 0s - loss: 0.6949 - binary_accuracy: 0.9475 - balanced_acc: 0.708910/10 [==============================] - 1s 77ms/step - loss: 0.6731 - binary_accuracy: 0.9449 - balanced_acc: 0.7388 - val_loss: 0.5521 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6752
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.5415 - binary_accuracy: 0.9453 - balanced_acc: 0.8534 6/10 [=================>............] - ETA: 0s - loss: 0.4595 - binary_accuracy: 0.9661 - balanced_acc: 0.844410/10 [==============================] - 0s 13ms/step - loss: 0.4456 - binary_accuracy: 0.9584 - balanced_acc: 0.7988 - val_loss: 0.4228 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6333
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.3459 - binary_accuracy: 0.9609 - balanced_acc: 0.8290 7/10 [====================>.........] - ETA: 0s - loss: 0.3213 - binary_accuracy: 0.9721 - balanced_acc: 0.890710/10 [==============================] - 0s 11ms/step - loss: 0.3075 - binary_accuracy: 0.9729 - balanced_acc: 0.8480 - val_loss: 0.3773 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.5447
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2434 - binary_accuracy: 0.9766 - balanced_acc: 0.8500 7/10 [====================>.........] - ETA: 0s - loss: 0.2464 - binary_accuracy: 0.9665 - balanced_acc: 0.872510/10 [==============================] - 0s 12ms/step - loss: 0.2388 - binary_accuracy: 0.9686 - balanced_acc: 0.8513 - val_loss: 0.3220 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6692
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1868 - binary_accuracy: 0.9844 - balanced_acc: 0.9915 6/10 [=================>............] - ETA: 0s - loss: 0.1967 - binary_accuracy: 0.9805 - balanced_acc: 0.926310/10 [==============================] - 0s 12ms/step - loss: 0.2011 - binary_accuracy: 0.9746 - balanced_acc: 0.8457 - val_loss: 0.3323 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.5734
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1530 - binary_accuracy: 0.9844 - balanced_acc: 0.9244 6/10 [=================>............] - ETA: 0s - loss: 0.1579 - binary_accuracy: 0.9831 - balanced_acc: 0.915010/10 [==============================] - 0s 12ms/step - loss: 0.1756 - binary_accuracy: 0.9763 - balanced_acc: 0.9211 - val_loss: 0.3661 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.5276
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1623 - binary_accuracy: 0.9766 - balanced_acc: 0.8847 7/10 [====================>.........] - ETA: 0s - loss: 0.1590 - binary_accuracy: 0.9821 - balanced_acc: 0.919910/10 [==============================] - 0s 11ms/step - loss: 0.1597 - binary_accuracy: 0.9805 - balanced_acc: 0.9240 - val_loss: 0.3386 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6030
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1691 - binary_accuracy: 0.9766 - balanced_acc: 0.8636 7/10 [====================>.........] - ETA: 0s - loss: 0.1435 - binary_accuracy: 0.9844 - balanced_acc: 0.930910/10 [==============================] - 0s 12ms/step - loss: 0.1416 - binary_accuracy: 0.9839 - balanced_acc: 0.9346 - val_loss: 0.3369 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6340
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1396 - binary_accuracy: 0.9844 - balanced_acc: 0.9540 7/10 [====================>.........] - ETA: 0s - loss: 0.1231 - binary_accuracy: 0.9877 - balanced_acc: 0.941010/10 [==============================] - 0s 12ms/step - loss: 0.1351 - binary_accuracy: 0.9839 - balanced_acc: 0.9141 - val_loss: 0.3411 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6206
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1531 - binary_accuracy: 0.9609 - balanced_acc: 0.8249 6/10 [=================>............] - ETA: 0s - loss: 0.1221 - binary_accuracy: 0.9870 - balanced_acc: 0.947610/10 [==============================] - 1s 119ms/step - loss: 0.1335 - binary_accuracy: 0.9754 - balanced_acc: 0.9161 - val_loss: 0.3157 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7509
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1196 - binary_accuracy: 0.9844 - balanced_acc: 0.9916 7/10 [====================>.........] - ETA: 0s - loss: 0.1437 - binary_accuracy: 0.9788 - balanced_acc: 0.927110/10 [==============================] - 1s 73ms/step - loss: 0.1533 - binary_accuracy: 0.9779 - balanced_acc: 0.9123 - val_loss: 0.2931 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7567
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1581 - binary_accuracy: 0.9844 - balanced_acc: 0.9458 7/10 [====================>.........] - ETA: 0s - loss: 0.1466 - binary_accuracy: 0.9788 - balanced_acc: 0.906610/10 [==============================] - 0s 12ms/step - loss: 0.1448 - binary_accuracy: 0.9779 - balanced_acc: 0.9216 - val_loss: 0.2640 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7538
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1407 - binary_accuracy: 0.9922 - balanced_acc: 0.9956 7/10 [====================>.........] - ETA: 0s - loss: 0.1389 - binary_accuracy: 0.9766 - balanced_acc: 0.923310/10 [==============================] - 0s 11ms/step - loss: 0.1303 - binary_accuracy: 0.9805 - balanced_acc: 0.8873 - val_loss: 0.3953 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5781
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1080 - binary_accuracy: 0.9844 - balanced_acc: 0.9572 6/10 [=================>............] - ETA: 0s - loss: 0.1213 - binary_accuracy: 0.9857 - balanced_acc: 0.936510/10 [==============================] - 0s 12ms/step - loss: 0.1206 - binary_accuracy: 0.9864 - balanced_acc: 0.9458 - val_loss: 0.3348 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6322
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0958 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.1243 - binary_accuracy: 0.9821 - balanced_acc: 0.937210/10 [==============================] - 0s 11ms/step - loss: 0.1193 - binary_accuracy: 0.9839 - balanced_acc: 0.9339 - val_loss: 0.3257 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6402
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1252 - binary_accuracy: 0.9766 - balanced_acc: 0.9875 7/10 [====================>.........] - ETA: 0s - loss: 0.1205 - binary_accuracy: 0.9821 - balanced_acc: 0.936310/10 [==============================] - 0s 12ms/step - loss: 0.1203 - binary_accuracy: 0.9830 - balanced_acc: 0.9508 - val_loss: 0.2614 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6118
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0980 - binary_accuracy: 0.9922 - balanced_acc: 0.9958 7/10 [====================>.........] - ETA: 0s - loss: 0.1060 - binary_accuracy: 0.9877 - balanced_acc: 0.953310/10 [==============================] - 0s 12ms/step - loss: 0.1092 - binary_accuracy: 0.9864 - balanced_acc: 0.9510 - val_loss: 0.2986 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5767
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0885 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.1132 - binary_accuracy: 0.9900 - balanced_acc: 0.951210/10 [==============================] - 0s 12ms/step - loss: 0.1103 - binary_accuracy: 0.9907 - balanced_acc: 0.9649 - val_loss: 0.3001 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6849
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1083 - binary_accuracy: 0.9922 - balanced_acc: 0.9688 7/10 [====================>.........] - ETA: 0s - loss: 0.1045 - binary_accuracy: 0.9877 - balanced_acc: 0.960310/10 [==============================] - 0s 11ms/step - loss: 0.1045 - binary_accuracy: 0.9890 - balanced_acc: 0.9621 - val_loss: 0.2811 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6507
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0865 - binary_accuracy: 0.9922 - balanced_acc: 0.9958 7/10 [====================>.........] - ETA: 0s - loss: 0.1037 - binary_accuracy: 0.9888 - balanced_acc: 0.952610/10 [==============================] - 0s 12ms/step - loss: 0.1028 - binary_accuracy: 0.9881 - balanced_acc: 0.9583 - val_loss: 0.2919 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6090
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0841 - binary_accuracy: 0.9922 - balanced_acc: 0.9958 7/10 [====================>.........] - ETA: 0s - loss: 0.0901 - binary_accuracy: 0.9922 - balanced_acc: 0.986810/10 [==============================] - 0s 14ms/step - loss: 0.0882 - binary_accuracy: 0.9932 - balanced_acc: 0.9866 - val_loss: 0.3248 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6175
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0711 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0786 - binary_accuracy: 0.9948 - balanced_acc: 0.976710/10 [==============================] - 0s 12ms/step - loss: 0.0795 - binary_accuracy: 0.9949 - balanced_acc: 0.9852 - val_loss: 0.3309 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6175
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0802 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0769 - binary_accuracy: 0.9967 - balanced_acc: 0.978410/10 [==============================] - 0s 12ms/step - loss: 0.0758 - binary_accuracy: 0.9975 - balanced_acc: 0.9849 - val_loss: 0.3385 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6127
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0758 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0721 - binary_accuracy: 0.9989 - balanced_acc: 0.999410/10 [==============================] - 0s 12ms/step - loss: 0.0712 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3493 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.5591
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0646 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0701 - binary_accuracy: 0.9974 - balanced_acc: 0.998610/10 [==============================] - 0s 12ms/step - loss: 0.0703 - binary_accuracy: 0.9975 - balanced_acc: 0.9892 - val_loss: 0.3476 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6189
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0680 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0677 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.0672 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3316 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6294
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0656 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0671 - binary_accuracy: 0.9989 - balanced_acc: 0.988110/10 [==============================] - 0s 11ms/step - loss: 0.0682 - binary_accuracy: 0.9983 - balanced_acc: 0.9912 - val_loss: 0.3300 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6294
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0678 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0690 - binary_accuracy: 0.9967 - balanced_acc: 0.984510/10 [==============================] - 0s 12ms/step - loss: 0.0679 - binary_accuracy: 0.9975 - balanced_acc: 0.9392 - val_loss: 0.3376 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6203
Epoch 32/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0767 - binary_accuracy: 0.9922 - balanced_acc: 0.9957 6/10 [=================>............] - ETA: 0s - loss: 0.0689 - binary_accuracy: 0.9961 - balanced_acc: 0.997910/10 [==============================] - 0s 12ms/step - loss: 0.0669 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3482 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5800
Epoch 33/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0605 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0608 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.0622 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3156 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6341
Epoch 34/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0594 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0612 - binary_accuracy: 0.9989 - balanced_acc: 0.999410/10 [==============================] - 0s 12ms/step - loss: 0.0628 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3108 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6203
Epoch 35/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0544 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0617 - binary_accuracy: 0.9967 - balanced_acc: 0.998210/10 [==============================] - 0s 12ms/step - loss: 0.0616 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3117 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6203
Epoch 36/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0621 - binary_accuracy: 0.9922 - balanced_acc: 0.9958 7/10 [====================>.........] - ETA: 0s - loss: 0.0642 - binary_accuracy: 0.9944 - balanced_acc: 0.996910/10 [==============================] - 0s 11ms/step - loss: 0.0619 - binary_accuracy: 0.9958 - balanced_acc: 0.9978 - val_loss: 0.3127 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.5786
Epoch 37/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0598 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0586 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 11ms/step - loss: 0.0591 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3134 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.5786
Epoch 38/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0607 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0615 - binary_accuracy: 0.9989 - balanced_acc: 0.994010/10 [==============================] - 0s 11ms/step - loss: 0.0612 - binary_accuracy: 0.9992 - balanced_acc: 0.9958 - val_loss: 0.3126 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5800
Epoch 39/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0563 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0599 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 11ms/step - loss: 0.0593 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3135 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5800
Epoch 40/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0574 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0605 - binary_accuracy: 0.9989 - balanced_acc: 0.999410/10 [==============================] - 0s 11ms/step - loss: 0.0601 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3135 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5800
Epoch 41/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0627 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0597 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0603 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3132 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6217
Epoch 42/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0552 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0601 - binary_accuracy: 0.9989 - balanced_acc: 0.999410/10 [==============================] - 0s 12ms/step - loss: 0.0591 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3133 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6217
Epoch 43/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0546 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0627 - binary_accuracy: 0.9955 - balanced_acc: 0.986310/10 [==============================] - 0s 12ms/step - loss: 0.0634 - binary_accuracy: 0.9958 - balanced_acc: 0.9884 - val_loss: 0.3136 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6217
Epoch 44/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0566 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.0580 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 12ms/step - loss: 0.0580 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3148 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6217

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.4473 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 2ms/step - loss: 0.4407 - binary_accuracy: 0.9158 - balanced_acc: 0.5762

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-55-40Z

Training run 20/648 (flags = list(0, 1024, 0.4, 64, 512, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-55-51Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 2.4498 - binary_accuracy: 0.3594 - balanced_acc: 0.469512/19 [=================>............] - ETA: 0s - loss: 1.8542 - binary_accuracy: 0.8659 - balanced_acc: 0.497519/19 [==============================] - 1s 49ms/step - loss: 1.7035 - binary_accuracy: 0.8880 - balanced_acc: 0.4984 - val_loss: 1.2708 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.2051 - binary_accuracy: 0.9531 - balanced_acc: 0.500012/19 [=================>............] - ETA: 0s - loss: 1.1595 - binary_accuracy: 0.9076 - balanced_acc: 0.506019/19 [==============================] - 1s 37ms/step - loss: 1.0666 - binary_accuracy: 0.9220 - balanced_acc: 0.5411 - val_loss: 0.8611 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5417
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8612 - binary_accuracy: 0.9062 - balanced_acc: 0.571411/19 [================>.............] - ETA: 0s - loss: 0.7571 - binary_accuracy: 0.9290 - balanced_acc: 0.578519/19 [==============================] - 1s 37ms/step - loss: 0.7169 - binary_accuracy: 0.9338 - balanced_acc: 0.6324 - val_loss: 0.6377 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5833
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5422 - binary_accuracy: 0.9688 - balanced_acc: 0.825111/19 [================>.............] - ETA: 0s - loss: 0.5096 - binary_accuracy: 0.9730 - balanced_acc: 0.803119/19 [==============================] - 1s 37ms/step - loss: 0.5057 - binary_accuracy: 0.9601 - balanced_acc: 0.7950 - val_loss: 0.5104 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7386
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4568 - binary_accuracy: 0.9688 - balanced_acc: 0.919810/19 [==============>...............] - ETA: 0s - loss: 0.4070 - binary_accuracy: 0.9828 - balanced_acc: 0.934219/19 [==============================] - 0s 7ms/step - loss: 0.4000 - binary_accuracy: 0.9746 - balanced_acc: 0.9113 - val_loss: 0.4817 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5883
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4186 - binary_accuracy: 0.9531 - balanced_acc: 0.812511/19 [================>.............] - ETA: 0s - loss: 0.3172 - binary_accuracy: 0.9886 - balanced_acc: 0.962719/19 [==============================] - 0s 6ms/step - loss: 0.3174 - binary_accuracy: 0.9805 - balanced_acc: 0.9167 - val_loss: 0.4064 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6475
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2577 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.2582 - binary_accuracy: 0.9883 - balanced_acc: 0.956819/19 [==============================] - 0s 6ms/step - loss: 0.2507 - binary_accuracy: 0.9873 - balanced_acc: 0.9538 - val_loss: 0.3705 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6454
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1996 - binary_accuracy: 1.0000 - balanced_acc: 1.000011/19 [================>.............] - ETA: 0s - loss: 0.2155 - binary_accuracy: 0.9915 - balanced_acc: 0.978219/19 [==============================] - 0s 7ms/step - loss: 0.2154 - binary_accuracy: 0.9890 - balanced_acc: 0.9527 - val_loss: 0.3584 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6458
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1779 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.1885 - binary_accuracy: 0.9883 - balanced_acc: 0.961119/19 [==============================] - 0s 6ms/step - loss: 0.1891 - binary_accuracy: 0.9890 - balanced_acc: 0.9736 - val_loss: 0.3293 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6071
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1590 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.1601 - binary_accuracy: 0.9948 - balanced_acc: 0.977119/19 [==============================] - 0s 6ms/step - loss: 0.1697 - binary_accuracy: 0.9907 - balanced_acc: 0.9620 - val_loss: 0.3054 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7346
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1442 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.1430 - binary_accuracy: 0.9961 - balanced_acc: 0.977119/19 [==============================] - 0s 6ms/step - loss: 0.1435 - binary_accuracy: 0.9941 - balanced_acc: 0.9832 - val_loss: 0.3286 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5804
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1244 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.1360 - binary_accuracy: 0.9922 - balanced_acc: 0.955919/19 [==============================] - 0s 6ms/step - loss: 0.1377 - binary_accuracy: 0.9915 - balanced_acc: 0.9581 - val_loss: 0.2957 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6920
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1408 - binary_accuracy: 0.9844 - balanced_acc: 0.991512/19 [=================>............] - ETA: 0s - loss: 0.1163 - binary_accuracy: 0.9961 - balanced_acc: 0.971519/19 [==============================] - 0s 6ms/step - loss: 0.1152 - binary_accuracy: 0.9958 - balanced_acc: 0.9728 - val_loss: 0.2851 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6520
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1023 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.1068 - binary_accuracy: 0.9961 - balanced_acc: 0.984119/19 [==============================] - 0s 6ms/step - loss: 0.1054 - binary_accuracy: 0.9958 - balanced_acc: 0.9857 - val_loss: 0.3398 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5621
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0916 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.1000 - binary_accuracy: 0.9922 - balanced_acc: 0.946719/19 [==============================] - 0s 6ms/step - loss: 0.0982 - binary_accuracy: 0.9941 - balanced_acc: 0.9659 - val_loss: 0.2746 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6537
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1061 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0911 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0896 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.2661 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6920
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0858 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0867 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0868 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2712 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6454
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0871 - binary_accuracy: 1.0000 - balanced_acc: 1.000011/19 [================>.............] - ETA: 0s - loss: 0.0852 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0852 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2694 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0835 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0842 - binary_accuracy: 0.9987 - balanced_acc: 0.999319/19 [==============================] - 0s 6ms/step - loss: 0.0838 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2674 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0841 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0828 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0827 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2648 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0847 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0819 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0811 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2628 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0792 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0789 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0799 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2614 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0777 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0775 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0787 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2599 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0779 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0782 - binary_accuracy: 0.9987 - balanced_acc: 0.999319/19 [==============================] - 0s 6ms/step - loss: 0.0773 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2591 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0743 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0762 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0767 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2590 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0735 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0766 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0763 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2587 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0781 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0764 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0763 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2586 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0764 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0754 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0760 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2585 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0761 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0752 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0760 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2582 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0775 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0767 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0759 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2578 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0747 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/19 [==============>...............] - ETA: 0s - loss: 0.0761 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 7ms/step - loss: 0.0755 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.2577 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0742 - binary_accuracy: 1.0000 - balanced_acc: 1.000011/19 [================>.............] - ETA: 0s - loss: 0.0756 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0755 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2578 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0781 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0754 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0754 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2572 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0713 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0754 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0750 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2572 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6287

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3632 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 1ms/step - loss: 0.3438 - binary_accuracy: 0.9212 - balanced_acc: 0.5791

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-55-51Z

Training run 21/648 (flags = list(0.1, 1024, 0.4, 128, 256, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-56-00Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.1569 - binary_accuracy: 0.3906 - balanced_acc: 0.456210/10 [==============================] - 1s 135ms/step - loss: 1.6483 - binary_accuracy: 0.8634 - balanced_acc: 0.4956 - val_loss: 1.3602 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.2998 - binary_accuracy: 0.9531 - balanced_acc: 0.500010/10 [==============================] - 0s 8ms/step - loss: 1.2411 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0747 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0665 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 1s 68ms/step - loss: 0.9722 - binary_accuracy: 0.9177 - balanced_acc: 0.4996 - val_loss: 0.8653 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7932 - binary_accuracy: 0.9453 - balanced_acc: 0.500010/10 [==============================] - 1s 68ms/step - loss: 0.7654 - binary_accuracy: 0.9338 - balanced_acc: 0.5984 - val_loss: 0.7117 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5338
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.7091 - binary_accuracy: 0.8906 - balanced_acc: 0.562210/10 [==============================] - 0s 7ms/step - loss: 0.6213 - binary_accuracy: 0.9449 - balanced_acc: 0.6937 - val_loss: 0.6290 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.5629 - binary_accuracy: 0.9297 - balanced_acc: 0.625010/10 [==============================] - 1s 66ms/step - loss: 0.5080 - binary_accuracy: 0.9584 - balanced_acc: 0.7509 - val_loss: 0.5462 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.5870
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.4495 - binary_accuracy: 0.9766 - balanced_acc: 0.850010/10 [==============================] - 1s 66ms/step - loss: 0.4219 - binary_accuracy: 0.9729 - balanced_acc: 0.8524 - val_loss: 0.4822 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6995
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.3687 - binary_accuracy: 0.9922 - balanced_acc: 0.950010/10 [==============================] - 0s 7ms/step - loss: 0.3593 - binary_accuracy: 0.9873 - balanced_acc: 0.9394 - val_loss: 0.4837 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5671
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.3194 - binary_accuracy: 0.9844 - balanced_acc: 0.857110/10 [==============================] - 0s 7ms/step - loss: 0.3104 - binary_accuracy: 0.9881 - balanced_acc: 0.9539 - val_loss: 0.4639 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5338
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2734 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 1s 65ms/step - loss: 0.2860 - binary_accuracy: 0.9873 - balanced_acc: 0.9474 - val_loss: 0.3850 - val_binary_accuracy: 0.9525 - val_balanced_acc: 0.7669
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2470 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.2563 - binary_accuracy: 0.9847 - balanced_acc: 0.9442 - val_loss: 0.3901 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6211
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2160 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.2469 - binary_accuracy: 0.9839 - balanced_acc: 0.9222 - val_loss: 0.3618 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6450
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2279 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.2303 - binary_accuracy: 0.9856 - balanced_acc: 0.9179 - val_loss: 0.3421 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6566
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2021 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1977 - binary_accuracy: 0.9941 - balanced_acc: 0.9725 - val_loss: 0.3639 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5809
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1762 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1842 - binary_accuracy: 0.9915 - balanced_acc: 0.9690 - val_loss: 0.3047 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6368
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1711 - binary_accuracy: 0.9922 - balanced_acc: 0.995610/10 [==============================] - 0s 7ms/step - loss: 0.1617 - binary_accuracy: 0.9966 - balanced_acc: 0.9425 - val_loss: 0.3415 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6088
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1604 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1498 - binary_accuracy: 0.9992 - balanced_acc: 0.9958 - val_loss: 0.2867 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6933
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1408 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1378 - binary_accuracy: 0.9966 - balanced_acc: 0.9856 - val_loss: 0.2997 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6629
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1288 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1302 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3052 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6240
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1264 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1211 - binary_accuracy: 0.9975 - balanced_acc: 0.9837 - val_loss: 0.2894 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6643
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1110 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1132 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2993 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6060
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1142 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1116 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2944 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6060
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1078 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1101 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2916 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6643
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1058 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1091 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2882 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1071 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1092 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2879 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1080 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1073 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2863 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1086 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1064 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2877 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1033 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1049 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2871 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1058 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.1042 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2835 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1071 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1031 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2827 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1024 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1027 - binary_accuracy: 1.0000 - balanced_acc: 0.9500 - val_loss: 0.2828 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 32/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1033 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1025 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2831 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 33/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1077 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1028 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2827 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 34/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0969 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 8ms/step - loss: 0.1025 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2822 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 35/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0998 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1029 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2820 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 36/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0994 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1017 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2819 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 37/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1018 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1020 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2819 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 38/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0985 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1026 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2814 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 39/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1033 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1017 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2817 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657
Epoch 40/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1012 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1008 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2814 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6657

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3771 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3681 - binary_accuracy: 0.9266 - balanced_acc: 0.5819

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-56-00Z

Training run 22/648 (flags = list(0, 2048, 0.2, 256, 2048, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-56-09Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 4.0904 - binary_accuracy: 0.6172 - balanced_acc: 0.45664/5 [=======================>......] - ETA: 0s - loss: 3.7424 - binary_accuracy: 0.8438 - balanced_acc: 0.48925/5 [==============================] - 1s 251ms/step - loss: 3.6838 - binary_accuracy: 0.8550 - balanced_acc: 0.4913 - val_loss: 3.1638 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 3.1275 - binary_accuracy: 0.9297 - balanced_acc: 0.50004/5 [=======================>......] - ETA: 0s - loss: 2.9890 - binary_accuracy: 0.9131 - balanced_acc: 0.50005/5 [==============================] - 0s 22ms/step - loss: 2.9469 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.6007 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 2.5900 - binary_accuracy: 0.9180 - balanced_acc: 0.50004/5 [=======================>......] - ETA: 0s - loss: 2.4114 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 24ms/step - loss: 2.3842 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 2.0851 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 2.0030 - binary_accuracy: 0.9453 - balanced_acc: 0.50004/5 [=======================>......] - ETA: 0s - loss: 1.9169 - binary_accuracy: 0.9229 - balanced_acc: 0.50005/5 [==============================] - 0s 24ms/step - loss: 1.9016 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.6749 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 1.6491 - binary_accuracy: 0.9023 - balanced_acc: 0.50004/5 [=======================>......] - ETA: 0s - loss: 1.5186 - binary_accuracy: 0.9199 - balanced_acc: 0.50005/5 [==============================] - 1s 152ms/step - loss: 1.5017 - binary_accuracy: 0.9203 - balanced_acc: 0.5143 - val_loss: 1.3437 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5132
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 1.3171 - binary_accuracy: 0.9141 - balanced_acc: 0.56004/5 [=======================>......] - ETA: 0s - loss: 1.2162 - binary_accuracy: 0.9287 - balanced_acc: 0.57765/5 [==============================] - 0s 25ms/step - loss: 1.1962 - binary_accuracy: 0.9296 - balanced_acc: 0.5714 - val_loss: 1.1105 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0268 - binary_accuracy: 0.9297 - balanced_acc: 0.55004/5 [=======================>......] - ETA: 0s - loss: 0.9701 - binary_accuracy: 0.9307 - balanced_acc: 0.57535/5 [==============================] - 0s 25ms/step - loss: 0.9584 - binary_accuracy: 0.9304 - balanced_acc: 0.5817 - val_loss: 0.9180 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5132
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8317 - binary_accuracy: 0.9570 - balanced_acc: 0.78054/5 [=======================>......] - ETA: 0s - loss: 0.7831 - binary_accuracy: 0.9668 - balanced_acc: 0.83505/5 [==============================] - 1s 159ms/step - loss: 0.7737 - binary_accuracy: 0.9678 - balanced_acc: 0.8372 - val_loss: 0.7734 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5263
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.6580 - binary_accuracy: 0.9766 - balanced_acc: 0.81944/5 [=======================>......] - ETA: 0s - loss: 0.6412 - binary_accuracy: 0.9697 - balanced_acc: 0.83525/5 [==============================] - 1s 156ms/step - loss: 0.6316 - binary_accuracy: 0.9703 - balanced_acc: 0.8318 - val_loss: 0.6805 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5526
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.5378 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.5221 - binary_accuracy: 0.9912 - balanced_acc: 0.97075/5 [==============================] - 1s 152ms/step - loss: 0.5160 - binary_accuracy: 0.9915 - balanced_acc: 0.9689 - val_loss: 0.5910 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.5789
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4524 - binary_accuracy: 0.9961 - balanced_acc: 0.99793/5 [=================>............] - ETA: 0s - loss: 0.4379 - binary_accuracy: 0.9961 - balanced_acc: 0.98485/5 [==============================] - 0s 27ms/step - loss: 0.4289 - binary_accuracy: 0.9949 - balanced_acc: 0.9888 - val_loss: 0.5429 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5395
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3717 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.3695 - binary_accuracy: 0.9902 - balanced_acc: 0.95755/5 [==============================] - 1s 153ms/step - loss: 0.3653 - binary_accuracy: 0.9915 - balanced_acc: 0.9660 - val_loss: 0.4527 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7321
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3378 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.3160 - binary_accuracy: 0.9980 - balanced_acc: 0.99905/5 [==============================] - 0s 24ms/step - loss: 0.3155 - binary_accuracy: 0.9958 - balanced_acc: 0.9859 - val_loss: 0.4906 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6283
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2901 - binary_accuracy: 0.9961 - balanced_acc: 0.97504/5 [=======================>......] - ETA: 0s - loss: 0.2742 - binary_accuracy: 0.9980 - balanced_acc: 0.99325/5 [==============================] - 0s 25ms/step - loss: 0.2708 - binary_accuracy: 0.9983 - balanced_acc: 0.9946 - val_loss: 0.3932 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6926
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2514 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.2431 - binary_accuracy: 0.9961 - balanced_acc: 0.98575/5 [==============================] - 0s 26ms/step - loss: 0.2404 - binary_accuracy: 0.9966 - balanced_acc: 0.9886 - val_loss: 0.3934 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6201
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2160 - binary_accuracy: 1.0000 - balanced_acc: 1.00003/5 [=================>............] - ETA: 0s - loss: 0.2136 - binary_accuracy: 0.9974 - balanced_acc: 0.98895/5 [==============================] - 0s 26ms/step - loss: 0.2084 - binary_accuracy: 0.9975 - balanced_acc: 0.9881 - val_loss: 0.3565 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6432
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1916 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.1850 - binary_accuracy: 0.9980 - balanced_acc: 0.99895/5 [==============================] - 0s 25ms/step - loss: 0.1837 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.3517 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5395
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1692 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.1638 - binary_accuracy: 0.9990 - balanced_acc: 0.99465/5 [==============================] - 0s 24ms/step - loss: 0.1647 - binary_accuracy: 0.9983 - balanced_acc: 0.9949 - val_loss: 0.3162 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6673
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1504 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.1482 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 24ms/step - loss: 0.1466 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2883 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7068
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1374 - binary_accuracy: 1.0000 - balanced_acc: 1.00003/5 [=================>............] - ETA: 0s - loss: 0.1357 - binary_accuracy: 0.9987 - balanced_acc: 0.99935/5 [==============================] - 0s 27ms/step - loss: 0.1350 - binary_accuracy: 0.9975 - balanced_acc: 0.9841 - val_loss: 0.3066 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5444
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1217 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.1208 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 26ms/step - loss: 0.1206 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2745 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6936
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1110 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.1114 - binary_accuracy: 0.9990 - balanced_acc: 0.99955/5 [==============================] - 0s 25ms/step - loss: 0.1164 - binary_accuracy: 0.9966 - balanced_acc: 0.9796 - val_loss: 0.2832 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6766
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1002 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.1019 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 26ms/step - loss: 0.1027 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2709 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6957
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1023 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.1023 - binary_accuracy: 0.9990 - balanced_acc: 0.99955/5 [==============================] - 0s 26ms/step - loss: 0.1019 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2656 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6936
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1001 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.1003 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 24ms/step - loss: 0.1005 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2681 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6815
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1007 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0993 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 24ms/step - loss: 0.0993 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2741 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6262
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0983 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0982 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 24ms/step - loss: 0.0983 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2746 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6262
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0960 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0969 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 24ms/step - loss: 0.0973 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2706 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0960 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0964 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 26ms/step - loss: 0.0963 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2661 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0975 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0956 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 24ms/step - loss: 0.0955 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2649 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6805
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0954 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0945 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 25ms/step - loss: 0.0945 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2668 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 32/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0937 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0936 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 23ms/step - loss: 0.0937 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2673 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 33/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0937 - binary_accuracy: 1.0000 - balanced_acc: 1.00003/5 [=================>............] - ETA: 0s - loss: 0.0931 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 25ms/step - loss: 0.0930 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2670 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 34/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0899 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0930 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 23ms/step - loss: 0.0930 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2667 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 35/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0935 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0930 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 23ms/step - loss: 0.0929 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2664 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 36/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0927 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0930 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 22ms/step - loss: 0.0927 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2659 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180
Epoch 37/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0919 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0927 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 23ms/step - loss: 0.0928 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2656 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180
Epoch 38/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0922 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 23ms/step - loss: 0.0925 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2652 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180
Epoch 39/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0939 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0923 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 24ms/step - loss: 0.0925 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2650 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180
Epoch 40/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0927 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0927 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 28ms/step - loss: 0.0925 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2647 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180
Epoch 41/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0932 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0921 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 23ms/step - loss: 0.0923 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2646 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180
Epoch 42/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0940 - binary_accuracy: 1.0000 - balanced_acc: 1.00003/5 [=================>............] - ETA: 0s - loss: 0.0927 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 25ms/step - loss: 0.0922 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2644 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3620 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 3ms/step - loss: 0.3443 - binary_accuracy: 0.9239 - balanced_acc: 0.5805

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-56-09Z

Training run 23/648 (flags = list(0.2, 256, 0.4, 64, 2048, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-56-22Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 1.5539 - binary_accuracy: 0.5312 - balanced_acc: 0.562713/19 [===================>..........] - ETA: 0s - loss: 1.1144 - binary_accuracy: 0.8822 - balanced_acc: 0.504819/19 [==============================] - 1s 43ms/step - loss: 1.0346 - binary_accuracy: 0.8974 - balanced_acc: 0.5033 - val_loss: 0.7920 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7310 - binary_accuracy: 0.9531 - balanced_acc: 0.500013/19 [===================>..........] - ETA: 0s - loss: 0.7322 - binary_accuracy: 0.9087 - balanced_acc: 0.500019/19 [==============================] - 0s 6ms/step - loss: 0.6834 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.5791 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5944 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.4986 - binary_accuracy: 0.9208 - balanced_acc: 0.519319/19 [==============================] - 1s 56ms/step - loss: 0.4877 - binary_accuracy: 0.9211 - balanced_acc: 0.5274 - val_loss: 0.4573 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3693 - binary_accuracy: 0.9531 - balanced_acc: 0.500013/19 [===================>..........] - ETA: 0s - loss: 0.3603 - binary_accuracy: 0.9435 - balanced_acc: 0.615419/19 [==============================] - 1s 38ms/step - loss: 0.3651 - binary_accuracy: 0.9398 - balanced_acc: 0.6472 - val_loss: 0.3766 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5833
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3387 - binary_accuracy: 0.9531 - balanced_acc: 0.848413/19 [===================>..........] - ETA: 0s - loss: 0.2927 - binary_accuracy: 0.9724 - balanced_acc: 0.827119/19 [==============================] - 1s 37ms/step - loss: 0.2892 - binary_accuracy: 0.9669 - balanced_acc: 0.8316 - val_loss: 0.3578 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6117
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2918 - binary_accuracy: 0.9375 - balanced_acc: 0.750014/19 [=====================>........] - ETA: 0s - loss: 0.2365 - binary_accuracy: 0.9788 - balanced_acc: 0.908319/19 [==============================] - 1s 37ms/step - loss: 0.2330 - binary_accuracy: 0.9796 - balanced_acc: 0.8978 - val_loss: 0.3344 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2115 - binary_accuracy: 0.9688 - balanced_acc: 0.833313/19 [===================>..........] - ETA: 0s - loss: 0.1968 - binary_accuracy: 0.9748 - balanced_acc: 0.884519/19 [==============================] - 0s 5ms/step - loss: 0.1908 - binary_accuracy: 0.9813 - balanced_acc: 0.9122 - val_loss: 0.3189 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6350
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1475 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1619 - binary_accuracy: 0.9922 - balanced_acc: 0.971019/19 [==============================] - 0s 5ms/step - loss: 0.1628 - binary_accuracy: 0.9898 - balanced_acc: 0.9418 - val_loss: 0.3380 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5650
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1355 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1380 - binary_accuracy: 0.9933 - balanced_acc: 0.975219/19 [==============================] - 0s 5ms/step - loss: 0.1415 - binary_accuracy: 0.9915 - balanced_acc: 0.9799 - val_loss: 0.3195 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6367
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1329 - binary_accuracy: 0.9844 - balanced_acc: 0.991514/19 [=====================>........] - ETA: 0s - loss: 0.1289 - binary_accuracy: 0.9944 - balanced_acc: 0.982119/19 [==============================] - 1s 40ms/step - loss: 0.1301 - binary_accuracy: 0.9924 - balanced_acc: 0.9769 - val_loss: 0.2914 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6788
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1034 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1155 - binary_accuracy: 0.9940 - balanced_acc: 0.982919/19 [==============================] - 0s 5ms/step - loss: 0.1129 - binary_accuracy: 0.9949 - balanced_acc: 0.9879 - val_loss: 0.3018 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6167
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0991 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1033 - binary_accuracy: 0.9955 - balanced_acc: 0.977419/19 [==============================] - 1s 36ms/step - loss: 0.1065 - binary_accuracy: 0.9949 - balanced_acc: 0.9800 - val_loss: 0.2391 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7438
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1349 - binary_accuracy: 0.9844 - balanced_acc: 0.991513/19 [===================>..........] - ETA: 0s - loss: 0.0952 - binary_accuracy: 0.9988 - balanced_acc: 0.999319/19 [==============================] - 0s 5ms/step - loss: 0.0985 - binary_accuracy: 0.9966 - balanced_acc: 0.9899 - val_loss: 0.2877 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1002 - binary_accuracy: 0.9844 - balanced_acc: 0.900014/19 [=====================>........] - ETA: 0s - loss: 0.0984 - binary_accuracy: 0.9933 - balanced_acc: 0.972319/19 [==============================] - 0s 5ms/step - loss: 0.0979 - binary_accuracy: 0.9924 - balanced_acc: 0.9445 - val_loss: 0.2875 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6132
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0773 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0983 - binary_accuracy: 0.9922 - balanced_acc: 0.960419/19 [==============================] - 0s 5ms/step - loss: 0.0993 - binary_accuracy: 0.9915 - balanced_acc: 0.9662 - val_loss: 0.2434 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6954
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1363 - binary_accuracy: 0.9688 - balanced_acc: 0.919814/19 [=====================>........] - ETA: 0s - loss: 0.0922 - binary_accuracy: 0.9922 - balanced_acc: 0.963319/19 [==============================] - 0s 5ms/step - loss: 0.0902 - binary_accuracy: 0.9941 - balanced_acc: 0.9467 - val_loss: 0.2372 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6471
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0748 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0894 - binary_accuracy: 0.9955 - balanced_acc: 0.982719/19 [==============================] - 0s 5ms/step - loss: 0.0869 - binary_accuracy: 0.9966 - balanced_acc: 0.9873 - val_loss: 0.2303 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7204
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0728 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0725 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.0737 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2390 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7188
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0713 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0765 - binary_accuracy: 0.9944 - balanced_acc: 0.980319/19 [==============================] - 0s 5ms/step - loss: 0.0756 - binary_accuracy: 0.9949 - balanced_acc: 0.9850 - val_loss: 0.2590 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6704
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0674 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0694 - binary_accuracy: 0.9978 - balanced_acc: 0.977019/19 [==============================] - 0s 5ms/step - loss: 0.0710 - binary_accuracy: 0.9966 - balanced_acc: 0.9816 - val_loss: 0.2441 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7404
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0686 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0721 - binary_accuracy: 0.9967 - balanced_acc: 0.980919/19 [==============================] - 0s 5ms/step - loss: 0.0713 - binary_accuracy: 0.9975 - balanced_acc: 0.9859 - val_loss: 0.2347 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7354
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0733 - binary_accuracy: 0.9844 - balanced_acc: 0.9375 8/19 [===========>..................] - ETA: 0s - loss: 0.0666 - binary_accuracy: 0.9961 - balanced_acc: 0.991219/19 [==============================] - 0s 7ms/step - loss: 0.0702 - binary_accuracy: 0.9949 - balanced_acc: 0.9827 - val_loss: 0.2494 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6671
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0569 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0588 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0604 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2463 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6671
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0574 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0598 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0593 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2454 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6687
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0561 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0582 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0594 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2457 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0583 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0597 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.0589 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2409 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0581 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0573 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0572 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2420 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0555 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2456 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6537
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0593 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0553 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0556 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2415 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6537
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0595 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0549 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 7ms/step - loss: 0.0546 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2381 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6537
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0522 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0556 - binary_accuracy: 0.9989 - balanced_acc: 0.988119/19 [==============================] - 0s 5ms/step - loss: 0.0549 - binary_accuracy: 0.9992 - balanced_acc: 0.9649 - val_loss: 0.2425 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6537
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0546 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0531 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2373 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6721
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0556 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0529 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0531 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2369 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6721
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0493 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0534 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2376 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6721
Epoch 35/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0512 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0535 - binary_accuracy: 1.0000 - balanced_acc: 0.964319/19 [==============================] - 0s 5ms/step - loss: 0.0532 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.2375 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6721
Epoch 36/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0500 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0535 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0531 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2376 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 37/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0531 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0522 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0530 - binary_accuracy: 0.9992 - balanced_acc: 0.9962 - val_loss: 0.2384 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 38/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0492 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0527 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0527 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2383 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 39/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0559 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0530 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0525 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2389 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 40/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0626 - binary_accuracy: 0.9844 - balanced_acc: 0.875014/19 [=====================>........] - ETA: 0s - loss: 0.0530 - binary_accuracy: 0.9989 - balanced_acc: 0.991119/19 [==============================] - 0s 5ms/step - loss: 0.0528 - binary_accuracy: 0.9992 - balanced_acc: 0.9934 - val_loss: 0.2388 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 41/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0504 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0528 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0526 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2387 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 42/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0553 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0533 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0529 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2381 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.4004 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3570 - binary_accuracy: 0.9185 - balanced_acc: 0.5777

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-56-22Z

Training run 24/648 (flags = list(0, 512, 0.4, 128, 256, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-56-33Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.6995 - binary_accuracy: 0.5859 - balanced_acc: 0.462510/10 [==============================] - 1s 88ms/step - loss: 1.5643 - binary_accuracy: 0.8329 - balanced_acc: 0.4838 - val_loss: 1.4076 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.3936 - binary_accuracy: 0.9531 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.3537 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.2849 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.2862 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.2736 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.2392 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1930 - binary_accuracy: 0.9453 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.2399 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.2154 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.2921 - binary_accuracy: 0.8828 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.2152 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1919 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.2184 - binary_accuracy: 0.9062 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.1919 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1689 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1830 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.1651 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1468 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1215 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.1414 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1248 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0837 - binary_accuracy: 0.9453 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.1143 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1038 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0780 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0888 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0830 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0735 - binary_accuracy: 0.9141 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0662 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0627 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0846 - binary_accuracy: 0.9062 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0518 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0608 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0344 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0532 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0587 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0376 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0493 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0567 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0381 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0486 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0546 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1110 - binary_accuracy: 0.8828 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0411 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0525 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0733 - binary_accuracy: 0.8984 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0437 - binary_accuracy: 0.9194 - balanced_acc: 0.5042 - val_loss: 1.0505 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0337 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0426 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0484 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.9817 - binary_accuracy: 0.9375 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0378 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0464 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0392 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0339 - binary_accuracy: 0.9194 - balanced_acc: 0.5056 - val_loss: 1.0443 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0331 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0346 - binary_accuracy: 0.9194 - balanced_acc: 0.5042 - val_loss: 1.0423 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1218 - binary_accuracy: 0.8750 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0313 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0421 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0106 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0281 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0418 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0379 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0321 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0416 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0319 - binary_accuracy: 0.9141 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0318 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0414 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0914 - binary_accuracy: 0.8984 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0295 - binary_accuracy: 0.9194 - balanced_acc: 0.5045 - val_loss: 1.0412 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0374 - binary_accuracy: 0.9141 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0260 - binary_accuracy: 0.9194 - balanced_acc: 0.5056 - val_loss: 1.0410 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0504 - binary_accuracy: 0.9062 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0331 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0408 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0093 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0290 - binary_accuracy: 0.9194 - balanced_acc: 0.5056 - val_loss: 1.0405 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0816 - binary_accuracy: 0.8828 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0291 - binary_accuracy: 0.9194 - balanced_acc: 0.5071 - val_loss: 1.0403 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0085 - binary_accuracy: 0.9297 - balanced_acc: 0.500010/10 [==============================] - 0s 6ms/step - loss: 1.0306 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0401 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 1.0616 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 1ms/step - loss: 1.0266 - binary_accuracy: 0.9402 - balanced_acc: 0.5000

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-56-33Z

Training run 25/648 (flags = list(0.2, 2048, 0.2, 256, 2048, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-56-37Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 4.0946 - binary_accuracy: 0.5703 - balanced_acc: 0.45054/5 [=======================>......] - ETA: 0s - loss: 7.3193 - binary_accuracy: 0.8320 - balanced_acc: 0.48765/5 [==============================] - 1s 274ms/step - loss: 6.8065 - binary_accuracy: 0.8448 - balanced_acc: 0.4901 - val_loss: 3.4807 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 3.4762 - binary_accuracy: 0.9297 - balanced_acc: 0.50004/5 [=======================>......] - ETA: 0s - loss: 3.4082 - binary_accuracy: 0.9131 - balanced_acc: 0.50005/5 [==============================] - 0s 23ms/step - loss: 3.3837 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 3.2155 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 3.2013 - binary_accuracy: 0.9180 - balanced_acc: 0.50004/5 [=======================>......] - ETA: 0s - loss: 3.0239 - binary_accuracy: 0.9248 - balanced_acc: 0.53075/5 [==============================] - 0s 24ms/step - loss: 2.9915 - binary_accuracy: 0.9211 - balanced_acc: 0.5246 - val_loss: 2.5790 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 2.5067 - binary_accuracy: 0.9453 - balanced_acc: 0.50004/5 [=======================>......] - ETA: 0s - loss: 2.3693 - binary_accuracy: 0.9268 - balanced_acc: 0.52995/5 [==============================] - 1s 159ms/step - loss: 2.3402 - binary_accuracy: 0.9237 - balanced_acc: 0.5408 - val_loss: 2.0010 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6340
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9830 - binary_accuracy: 0.9297 - balanced_acc: 0.78274/5 [=======================>......] - ETA: 0s - loss: 1.7926 - binary_accuracy: 0.9473 - balanced_acc: 0.74305/5 [==============================] - 0s 21ms/step - loss: 1.7690 - binary_accuracy: 0.9423 - balanced_acc: 0.7202 - val_loss: 1.5079 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5889
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 1.4362 - binary_accuracy: 0.9414 - balanced_acc: 0.73574/5 [=======================>......] - ETA: 0s - loss: 1.3097 - binary_accuracy: 0.9551 - balanced_acc: 0.81055/5 [==============================] - 0s 23ms/step - loss: 1.2821 - binary_accuracy: 0.9584 - balanced_acc: 0.8277 - val_loss: 1.1385 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5544
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0323 - binary_accuracy: 0.9766 - balanced_acc: 0.85004/5 [=======================>......] - ETA: 0s - loss: 0.9380 - binary_accuracy: 0.9736 - balanced_acc: 0.88345/5 [==============================] - 0s 22ms/step - loss: 0.9255 - binary_accuracy: 0.9729 - balanced_acc: 0.8710 - val_loss: 0.8829 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5544
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 0.7400 - binary_accuracy: 0.9766 - balanced_acc: 0.90884/5 [=======================>......] - ETA: 0s - loss: 0.6884 - binary_accuracy: 0.9766 - balanced_acc: 0.90695/5 [==============================] - 0s 22ms/step - loss: 0.6815 - binary_accuracy: 0.9729 - balanced_acc: 0.8710 - val_loss: 0.7826 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5565
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.5288 - binary_accuracy: 0.9922 - balanced_acc: 0.92864/5 [=======================>......] - ETA: 0s - loss: 0.5256 - binary_accuracy: 0.9785 - balanced_acc: 0.94425/5 [==============================] - 0s 23ms/step - loss: 0.5143 - binary_accuracy: 0.9805 - balanced_acc: 0.9463 - val_loss: 0.5959 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6322
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4173 - binary_accuracy: 0.9922 - balanced_acc: 0.99584/5 [=======================>......] - ETA: 0s - loss: 0.4177 - binary_accuracy: 0.9863 - balanced_acc: 0.95255/5 [==============================] - 0s 21ms/step - loss: 0.4143 - binary_accuracy: 0.9847 - balanced_acc: 0.9522 - val_loss: 0.5085 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5939
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3450 - binary_accuracy: 0.9922 - balanced_acc: 0.97164/5 [=======================>......] - ETA: 0s - loss: 0.3470 - binary_accuracy: 0.9805 - balanced_acc: 0.93465/5 [==============================] - 0s 24ms/step - loss: 0.3434 - binary_accuracy: 0.9805 - balanced_acc: 0.9456 - val_loss: 0.5231 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5434
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3065 - binary_accuracy: 0.9688 - balanced_acc: 0.82294/5 [=======================>......] - ETA: 0s - loss: 0.2923 - binary_accuracy: 0.9863 - balanced_acc: 0.92825/5 [==============================] - 0s 22ms/step - loss: 0.2906 - binary_accuracy: 0.9864 - balanced_acc: 0.9412 - val_loss: 0.4546 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5423
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2657 - binary_accuracy: 0.9844 - balanced_acc: 0.94314/5 [=======================>......] - ETA: 0s - loss: 0.2653 - binary_accuracy: 0.9854 - balanced_acc: 0.91325/5 [==============================] - 1s 151ms/step - loss: 0.2697 - binary_accuracy: 0.9822 - balanced_acc: 0.9207 - val_loss: 0.3912 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7421
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2603 - binary_accuracy: 0.9844 - balanced_acc: 0.96864/5 [=======================>......] - ETA: 0s - loss: 0.2407 - binary_accuracy: 0.9824 - balanced_acc: 0.94515/5 [==============================] - 0s 23ms/step - loss: 0.2388 - binary_accuracy: 0.9822 - balanced_acc: 0.9540 - val_loss: 0.4410 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5807
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2072 - binary_accuracy: 0.9922 - balanced_acc: 0.97163/5 [=================>............] - ETA: 0s - loss: 0.2213 - binary_accuracy: 0.9818 - balanced_acc: 0.89615/5 [==============================] - 1s 150ms/step - loss: 0.2248 - binary_accuracy: 0.9813 - balanced_acc: 0.9177 - val_loss: 0.3912 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7560
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2273 - binary_accuracy: 0.9766 - balanced_acc: 0.98713/5 [=================>............] - ETA: 0s - loss: 0.2243 - binary_accuracy: 0.9766 - balanced_acc: 0.95455/5 [==============================] - 0s 25ms/step - loss: 0.2175 - binary_accuracy: 0.9771 - balanced_acc: 0.9139 - val_loss: 0.4020 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6280
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1980 - binary_accuracy: 0.9766 - balanced_acc: 0.92834/5 [=======================>......] - ETA: 0s - loss: 0.1915 - binary_accuracy: 0.9854 - balanced_acc: 0.94965/5 [==============================] - 0s 23ms/step - loss: 0.1891 - binary_accuracy: 0.9847 - balanced_acc: 0.9423 - val_loss: 0.3813 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6585
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1813 - binary_accuracy: 0.9805 - balanced_acc: 0.93054/5 [=======================>......] - ETA: 0s - loss: 0.1695 - binary_accuracy: 0.9863 - balanced_acc: 0.94415/5 [==============================] - 0s 22ms/step - loss: 0.1712 - binary_accuracy: 0.9856 - balanced_acc: 0.9421 - val_loss: 0.3555 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7048
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1768 - binary_accuracy: 0.9805 - balanced_acc: 0.98964/5 [=======================>......] - ETA: 0s - loss: 0.1674 - binary_accuracy: 0.9844 - balanced_acc: 0.96365/5 [==============================] - 0s 24ms/step - loss: 0.1649 - binary_accuracy: 0.9839 - balanced_acc: 0.9479 - val_loss: 0.3434 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7299
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1503 - binary_accuracy: 0.9883 - balanced_acc: 0.97304/5 [=======================>......] - ETA: 0s - loss: 0.1503 - binary_accuracy: 0.9912 - balanced_acc: 0.95965/5 [==============================] - 0s 26ms/step - loss: 0.1477 - binary_accuracy: 0.9915 - balanced_acc: 0.9566 - val_loss: 0.4031 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5686
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1291 - binary_accuracy: 0.9961 - balanced_acc: 0.97624/5 [=======================>......] - ETA: 0s - loss: 0.1379 - binary_accuracy: 0.9912 - balanced_acc: 0.97355/5 [==============================] - 0s 24ms/step - loss: 0.1396 - binary_accuracy: 0.9890 - balanced_acc: 0.9656 - val_loss: 0.3590 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7410
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1358 - binary_accuracy: 0.9883 - balanced_acc: 0.94004/5 [=======================>......] - ETA: 0s - loss: 0.1304 - binary_accuracy: 0.9912 - balanced_acc: 0.98185/5 [==============================] - 0s 24ms/step - loss: 0.1305 - binary_accuracy: 0.9907 - balanced_acc: 0.9781 - val_loss: 0.3651 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6380
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1130 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.1186 - binary_accuracy: 0.9922 - balanced_acc: 0.96375/5 [==============================] - 0s 22ms/step - loss: 0.1235 - binary_accuracy: 0.9907 - balanced_acc: 0.9688 - val_loss: 0.3398 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6643
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1240 - binary_accuracy: 0.9883 - balanced_acc: 0.97194/5 [=======================>......] - ETA: 0s - loss: 0.1227 - binary_accuracy: 0.9883 - balanced_acc: 0.96045/5 [==============================] - 0s 23ms/step - loss: 0.1199 - binary_accuracy: 0.9898 - balanced_acc: 0.9683 - val_loss: 0.3229 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7247
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1121 - binary_accuracy: 0.9922 - balanced_acc: 0.99573/5 [=================>............] - ETA: 0s - loss: 0.1154 - binary_accuracy: 0.9935 - balanced_acc: 0.97775/5 [==============================] - 0s 25ms/step - loss: 0.1143 - binary_accuracy: 0.9941 - balanced_acc: 0.9853 - val_loss: 0.3193 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7410
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1077 - binary_accuracy: 0.9961 - balanced_acc: 0.97924/5 [=======================>......] - ETA: 0s - loss: 0.1025 - binary_accuracy: 0.9971 - balanced_acc: 0.98775/5 [==============================] - 0s 22ms/step - loss: 0.1034 - binary_accuracy: 0.9966 - balanced_acc: 0.9894 - val_loss: 0.3326 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7036
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1034 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.1015 - binary_accuracy: 0.9932 - balanced_acc: 0.97955/5 [==============================] - 0s 22ms/step - loss: 0.1030 - binary_accuracy: 0.9915 - balanced_acc: 0.9815 - val_loss: 0.3496 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0963 - binary_accuracy: 0.9971 - balanced_acc: 0.98665/5 [==============================] - 0s 21ms/step - loss: 0.0985 - binary_accuracy: 0.9966 - balanced_acc: 0.9885 - val_loss: 0.3531 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0880 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0964 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 22ms/step - loss: 0.0956 - binary_accuracy: 0.9966 - balanced_acc: 0.9983 - val_loss: 0.3478 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7047
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0916 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0922 - binary_accuracy: 0.9980 - balanced_acc: 0.99905/5 [==============================] - 0s 32ms/step - loss: 0.0917 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3478 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7168
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0891 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0883 - binary_accuracy: 0.9980 - balanced_acc: 0.99905/5 [==============================] - 0s 23ms/step - loss: 0.0887 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3534 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 32/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0845 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0889 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 22ms/step - loss: 0.0883 - binary_accuracy: 0.9966 - balanced_acc: 0.9983 - val_loss: 0.3605 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7068
Epoch 33/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0865 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.0847 - binary_accuracy: 0.9980 - balanced_acc: 0.99895/5 [==============================] - 0s 24ms/step - loss: 0.0860 - binary_accuracy: 0.9975 - balanced_acc: 0.9985 - val_loss: 0.3530 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 34/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0757 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0829 - binary_accuracy: 0.9990 - balanced_acc: 0.99955/5 [==============================] - 0s 24ms/step - loss: 0.0822 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3490 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 35/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0804 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0822 - binary_accuracy: 0.9971 - balanced_acc: 0.99845/5 [==============================] - 0s 24ms/step - loss: 0.0825 - binary_accuracy: 0.9966 - balanced_acc: 0.9928 - val_loss: 0.3465 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7036
Epoch 36/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0785 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0800 - binary_accuracy: 0.9980 - balanced_acc: 0.99895/5 [==============================] - 0s 21ms/step - loss: 0.0790 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.3462 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7036
Epoch 37/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0794 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0854 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 24ms/step - loss: 0.0838 - binary_accuracy: 0.9966 - balanced_acc: 0.9983 - val_loss: 0.3470 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 38/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0755 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0774 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 22ms/step - loss: 0.0788 - binary_accuracy: 0.9992 - balanced_acc: 0.9993 - val_loss: 0.3477 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 39/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0851 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.0794 - binary_accuracy: 0.9980 - balanced_acc: 0.99895/5 [==============================] - 0s 22ms/step - loss: 0.0791 - binary_accuracy: 0.9983 - balanced_acc: 0.9992 - val_loss: 0.3477 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 40/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0768 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0804 - binary_accuracy: 0.9971 - balanced_acc: 0.99845/5 [==============================] - 0s 22ms/step - loss: 0.0794 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3476 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 41/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0797 - binary_accuracy: 0.9961 - balanced_acc: 0.99794/5 [=======================>......] - ETA: 0s - loss: 0.0781 - binary_accuracy: 0.9971 - balanced_acc: 0.99845/5 [==============================] - 0s 23ms/step - loss: 0.0784 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3476 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 42/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0912 - binary_accuracy: 0.9922 - balanced_acc: 0.99574/5 [=======================>......] - ETA: 0s - loss: 0.0787 - binary_accuracy: 0.9971 - balanced_acc: 0.99845/5 [==============================] - 0s 29ms/step - loss: 0.0781 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3473 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 43/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0746 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0766 - binary_accuracy: 0.9990 - balanced_acc: 0.99955/5 [==============================] - 0s 24ms/step - loss: 0.0762 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.3468 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 44/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0776 - binary_accuracy: 1.0000 - balanced_acc: 1.00004/5 [=======================>......] - ETA: 0s - loss: 0.0769 - binary_accuracy: 0.9990 - balanced_acc: 0.99955/5 [==============================] - 0s 24ms/step - loss: 0.0775 - binary_accuracy: 0.9983 - balanced_acc: 0.9989 - val_loss: 0.3459 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 45/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0842 - binary_accuracy: 0.9922 - balanced_acc: 0.99574/5 [=======================>......] - ETA: 0s - loss: 0.0784 - binary_accuracy: 0.9971 - balanced_acc: 0.99845/5 [==============================] - 0s 25ms/step - loss: 0.0776 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3454 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.6467 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 4ms/step - loss: 0.4833 - binary_accuracy: 0.9049 - balanced_acc: 0.5707

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-56-37Z

Training run 26/648 (flags = list(0, 512, 0.2, 256, 512, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-56-49Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 1.9670 - binary_accuracy: 0.1836 - balanced_acc: 0.45355/5 [==============================] - 1s 155ms/step - loss: 1.7670 - binary_accuracy: 0.7608 - balanced_acc: 0.4907 - val_loss: 1.1114 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 1.1079 - binary_accuracy: 0.9297 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9906 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9483 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8997 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.8488 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.7520 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 0.6946 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 10ms/step - loss: 0.6750 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.6129 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 0.5774 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 10ms/step - loss: 0.5222 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.5079 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4512 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.4084 - binary_accuracy: 0.9347 - balanced_acc: 0.6364 - val_loss: 0.4610 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3492 - binary_accuracy: 0.9375 - balanced_acc: 0.60005/5 [==============================] - 1s 131ms/step - loss: 0.3270 - binary_accuracy: 0.9466 - balanced_acc: 0.7193 - val_loss: 0.3745 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6461
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2914 - binary_accuracy: 0.9805 - balanced_acc: 0.95015/5 [==============================] - 1s 127ms/step - loss: 0.2649 - binary_accuracy: 0.9729 - balanced_acc: 0.8284 - val_loss: 0.3452 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6464
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2043 - binary_accuracy: 0.9844 - balanced_acc: 0.89085/5 [==============================] - 0s 9ms/step - loss: 0.2128 - binary_accuracy: 0.9822 - balanced_acc: 0.9257 - val_loss: 0.3195 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6048
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1644 - binary_accuracy: 0.9883 - balanced_acc: 0.96645/5 [==============================] - 1s 190ms/step - loss: 0.1747 - binary_accuracy: 0.9822 - balanced_acc: 0.9348 - val_loss: 0.3026 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7328
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1531 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 10ms/step - loss: 0.1654 - binary_accuracy: 0.9788 - balanced_acc: 0.9145 - val_loss: 0.2992 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6975
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1136 - binary_accuracy: 0.9961 - balanced_acc: 0.97505/5 [==============================] - 0s 9ms/step - loss: 0.1551 - binary_accuracy: 0.9864 - balanced_acc: 0.9557 - val_loss: 0.3083 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6411
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1424 - binary_accuracy: 0.9883 - balanced_acc: 0.96955/5 [==============================] - 0s 10ms/step - loss: 0.1570 - binary_accuracy: 0.9754 - balanced_acc: 0.8857 - val_loss: 0.2809 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.7165
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1532 - binary_accuracy: 0.9766 - balanced_acc: 0.96445/5 [==============================] - 0s 10ms/step - loss: 0.1409 - binary_accuracy: 0.9788 - balanced_acc: 0.9179 - val_loss: 0.2944 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6883
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1238 - binary_accuracy: 0.9922 - balanced_acc: 0.97165/5 [==============================] - 0s 10ms/step - loss: 0.1354 - binary_accuracy: 0.9856 - balanced_acc: 0.9440 - val_loss: 0.3169 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5889
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1215 - binary_accuracy: 0.9922 - balanced_acc: 0.95655/5 [==============================] - 0s 11ms/step - loss: 0.1205 - binary_accuracy: 0.9898 - balanced_acc: 0.9619 - val_loss: 0.2734 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7178
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1035 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 10ms/step - loss: 0.1045 - binary_accuracy: 0.9941 - balanced_acc: 0.9738 - val_loss: 0.2937 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6742
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0932 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0943 - binary_accuracy: 0.9975 - balanced_acc: 0.9984 - val_loss: 0.3495 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.5281
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0803 - binary_accuracy: 0.9961 - balanced_acc: 0.96675/5 [==============================] - 0s 16ms/step - loss: 0.0865 - binary_accuracy: 0.9924 - balanced_acc: 0.9718 - val_loss: 0.2810 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6642
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0765 - binary_accuracy: 0.9922 - balanced_acc: 0.99575/5 [==============================] - 1s 134ms/step - loss: 0.0877 - binary_accuracy: 0.9890 - balanced_acc: 0.9535 - val_loss: 0.2709 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7773
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0773 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 11ms/step - loss: 0.0990 - binary_accuracy: 0.9873 - balanced_acc: 0.9402 - val_loss: 0.3265 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.7105
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0758 - binary_accuracy: 0.9961 - balanced_acc: 0.98005/5 [==============================] - 0s 10ms/step - loss: 0.1045 - binary_accuracy: 0.9847 - balanced_acc: 0.9473 - val_loss: 0.4248 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5374
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0781 - binary_accuracy: 0.9922 - balanced_acc: 0.94745/5 [==============================] - 0s 10ms/step - loss: 0.1157 - binary_accuracy: 0.9788 - balanced_acc: 0.9316 - val_loss: 0.3249 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6806
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0908 - binary_accuracy: 0.9922 - balanced_acc: 0.97415/5 [==============================] - 0s 9ms/step - loss: 0.1014 - binary_accuracy: 0.9856 - balanced_acc: 0.9209 - val_loss: 0.3125 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0938 - binary_accuracy: 0.9883 - balanced_acc: 0.99365/5 [==============================] - 0s 10ms/step - loss: 0.1043 - binary_accuracy: 0.9864 - balanced_acc: 0.9585 - val_loss: 0.3308 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5565
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0884 - binary_accuracy: 0.9961 - balanced_acc: 0.97925/5 [==============================] - 0s 10ms/step - loss: 0.0877 - binary_accuracy: 0.9966 - balanced_acc: 0.9832 - val_loss: 0.2857 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7442
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0868 - binary_accuracy: 0.9961 - balanced_acc: 0.97625/5 [==============================] - 0s 9ms/step - loss: 0.0849 - binary_accuracy: 0.9958 - balanced_acc: 0.9768 - val_loss: 0.2865 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7421
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0775 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 10ms/step - loss: 0.0823 - binary_accuracy: 0.9966 - balanced_acc: 0.9877 - val_loss: 0.3019 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7005
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0704 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0761 - binary_accuracy: 0.9983 - balanced_acc: 0.9948 - val_loss: 0.3647 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6201
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0859 - binary_accuracy: 0.9883 - balanced_acc: 0.94835/5 [==============================] - 0s 9ms/step - loss: 0.0754 - binary_accuracy: 0.9958 - balanced_acc: 0.9885 - val_loss: 0.2668 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7168
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0647 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0621 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2766 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7047
Epoch 32/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0609 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0604 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2872 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7057
Epoch 33/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0592 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0591 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2884 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7047
Epoch 34/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0580 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2848 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7047
Epoch 35/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0584 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0567 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2789 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7047
Epoch 36/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0555 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2748 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7036
Epoch 37/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0543 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0541 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2736 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7036
Epoch 38/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0522 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0528 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2720 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7036
Epoch 39/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0526 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0517 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2708 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7036
Epoch 40/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0515 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0510 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2676 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 41/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0513 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0506 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2674 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 42/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0522 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0505 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2671 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 43/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0497 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 18ms/step - loss: 0.0504 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2668 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 44/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0499 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0500 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2664 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 45/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0495 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0496 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2662 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 46/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0507 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0500 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2658 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 47/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0494 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0500 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2656 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 48/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0499 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0500 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2655 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 49/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0497 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.0494 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2654 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026
Epoch 50/250
1/5 [=====>........................] - ETA: 0s - loss: 0.0498 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.0497 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2654 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7026

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3763 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.4017 - binary_accuracy: 0.9158 - balanced_acc: 0.5957

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-56-49Z

Training run 27/648 (flags = list(0.2, 1024, 0.4, 128, 256, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-56-57Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.1539 - binary_accuracy: 0.4297 - balanced_acc: 0.477910/10 [==============================] - 1s 87ms/step - loss: 1.7240 - binary_accuracy: 0.8677 - balanced_acc: 0.4978 - val_loss: 1.2408 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.1776 - binary_accuracy: 0.9531 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 1.0908 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8382 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8468 - binary_accuracy: 0.9219 - balanced_acc: 0.500010/10 [==============================] - 0s 8ms/step - loss: 0.7083 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.5466 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.4871 - binary_accuracy: 0.9453 - balanced_acc: 0.500010/10 [==============================] - 0s 7ms/step - loss: 0.4681 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.4024 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.4041 - binary_accuracy: 0.8828 - balanced_acc: 0.500010/10 [==============================] - 1s 66ms/step - loss: 0.3615 - binary_accuracy: 0.9203 - balanced_acc: 0.5337 - val_loss: 0.3379 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6023
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2870 - binary_accuracy: 0.9375 - balanced_acc: 0.666710/10 [==============================] - 0s 7ms/step - loss: 0.2838 - binary_accuracy: 0.9372 - balanced_acc: 0.6339 - val_loss: 0.2964 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2296 - binary_accuracy: 0.9688 - balanced_acc: 0.800010/10 [==============================] - 0s 7ms/step - loss: 0.2352 - binary_accuracy: 0.9474 - balanced_acc: 0.7194 - val_loss: 0.2934 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5907
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1816 - binary_accuracy: 0.9688 - balanced_acc: 0.845810/10 [==============================] - 1s 67ms/step - loss: 0.2238 - binary_accuracy: 0.9576 - balanced_acc: 0.7774 - val_loss: 0.3089 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6735
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1831 - binary_accuracy: 0.9766 - balanced_acc: 0.853010/10 [==============================] - 0s 7ms/step - loss: 0.2156 - binary_accuracy: 0.9550 - balanced_acc: 0.8432 - val_loss: 0.3005 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6202
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1682 - binary_accuracy: 0.9844 - balanced_acc: 0.991610/10 [==============================] - 1s 66ms/step - loss: 0.2258 - binary_accuracy: 0.9584 - balanced_acc: 0.8384 - val_loss: 0.2732 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7092
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1906 - binary_accuracy: 0.9688 - balanced_acc: 0.900510/10 [==============================] - 0s 7ms/step - loss: 0.2119 - binary_accuracy: 0.9550 - balanced_acc: 0.8418 - val_loss: 0.3133 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6027
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1720 - binary_accuracy: 0.9766 - balanced_acc: 0.912410/10 [==============================] - 0s 7ms/step - loss: 0.2193 - binary_accuracy: 0.9576 - balanced_acc: 0.8045 - val_loss: 0.2933 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6141
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2049 - binary_accuracy: 0.9766 - balanced_acc: 0.987410/10 [==============================] - 1s 65ms/step - loss: 0.2243 - binary_accuracy: 0.9567 - balanced_acc: 0.7942 - val_loss: 0.2831 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7135
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1937 - binary_accuracy: 0.9688 - balanced_acc: 0.931810/10 [==============================] - 0s 7ms/step - loss: 0.1891 - binary_accuracy: 0.9703 - balanced_acc: 0.8788 - val_loss: 0.2682 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.5719
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1497 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1950 - binary_accuracy: 0.9678 - balanced_acc: 0.8630 - val_loss: 0.2527 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6183
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1896 - binary_accuracy: 0.9609 - balanced_acc: 0.920110/10 [==============================] - 0s 7ms/step - loss: 0.1640 - binary_accuracy: 0.9771 - balanced_acc: 0.8498 - val_loss: 0.2707 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6064
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1456 - binary_accuracy: 0.9844 - balanced_acc: 0.957210/10 [==============================] - 0s 7ms/step - loss: 0.1418 - binary_accuracy: 0.9763 - balanced_acc: 0.8878 - val_loss: 0.2636 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6354
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1312 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 0s 7ms/step - loss: 0.1389 - binary_accuracy: 0.9796 - balanced_acc: 0.8999 - val_loss: 0.2451 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6706
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1242 - binary_accuracy: 0.9766 - balanced_acc: 0.929210/10 [==============================] - 1s 65ms/step - loss: 0.1450 - binary_accuracy: 0.9754 - balanced_acc: 0.9081 - val_loss: 0.2495 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7580
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1371 - binary_accuracy: 0.9766 - balanced_acc: 0.987410/10 [==============================] - 0s 7ms/step - loss: 0.1357 - binary_accuracy: 0.9822 - balanced_acc: 0.9347 - val_loss: 0.3597 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6877
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1155 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1773 - binary_accuracy: 0.9729 - balanced_acc: 0.8844 - val_loss: 0.3384 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6078
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1960 - binary_accuracy: 0.9688 - balanced_acc: 0.875010/10 [==============================] - 0s 7ms/step - loss: 0.1885 - binary_accuracy: 0.9652 - balanced_acc: 0.8260 - val_loss: 0.2791 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6104
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1342 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1873 - binary_accuracy: 0.9686 - balanced_acc: 0.8545 - val_loss: 0.2784 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6654
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1808 - binary_accuracy: 0.9688 - balanced_acc: 0.891510/10 [==============================] - 0s 7ms/step - loss: 0.1837 - binary_accuracy: 0.9712 - balanced_acc: 0.8561 - val_loss: 0.2842 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7425
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1612 - binary_accuracy: 0.9844 - balanced_acc: 0.991510/10 [==============================] - 1s 66ms/step - loss: 0.1954 - binary_accuracy: 0.9712 - balanced_acc: 0.8677 - val_loss: 0.2837 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.7630
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2310 - binary_accuracy: 0.9609 - balanced_acc: 0.944110/10 [==============================] - 0s 7ms/step - loss: 0.1928 - binary_accuracy: 0.9669 - balanced_acc: 0.8563 - val_loss: 0.3147 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7185
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1947 - binary_accuracy: 0.9844 - balanced_acc: 0.991510/10 [==============================] - 0s 7ms/step - loss: 0.2106 - binary_accuracy: 0.9644 - balanced_acc: 0.8561 - val_loss: 0.3390 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6294
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1725 - binary_accuracy: 0.9844 - balanced_acc: 0.916710/10 [==============================] - 0s 7ms/step - loss: 0.2009 - binary_accuracy: 0.9661 - balanced_acc: 0.8771 - val_loss: 0.2937 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7063
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1865 - binary_accuracy: 0.9609 - balanced_acc: 0.876310/10 [==============================] - 0s 7ms/step - loss: 0.1731 - binary_accuracy: 0.9754 - balanced_acc: 0.9120 - val_loss: 0.3867 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5842
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1855 - binary_accuracy: 0.9844 - balanced_acc: 0.933310/10 [==============================] - 0s 7ms/step - loss: 0.1833 - binary_accuracy: 0.9737 - balanced_acc: 0.8846 - val_loss: 0.3333 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6017
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1470 - binary_accuracy: 0.9922 - balanced_acc: 0.944410/10 [==============================] - 0s 7ms/step - loss: 0.1727 - binary_accuracy: 0.9737 - balanced_acc: 0.8441 - val_loss: 0.3579 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6811
Epoch 32/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1578 - binary_accuracy: 0.9844 - balanced_acc: 0.991310/10 [==============================] - 1s 103ms/step - loss: 0.1633 - binary_accuracy: 0.9830 - balanced_acc: 0.9227 - val_loss: 0.2899 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7679
Epoch 33/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1712 - binary_accuracy: 0.9766 - balanced_acc: 0.946010/10 [==============================] - 0s 8ms/step - loss: 0.1669 - binary_accuracy: 0.9796 - balanced_acc: 0.9248 - val_loss: 0.3475 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6000
Epoch 34/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1105 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1763 - binary_accuracy: 0.9712 - balanced_acc: 0.8930 - val_loss: 0.3023 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6558
Epoch 35/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1825 - binary_accuracy: 0.9531 - balanced_acc: 0.820710/10 [==============================] - 1s 67ms/step - loss: 0.1716 - binary_accuracy: 0.9678 - balanced_acc: 0.8698 - val_loss: 0.2901 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7713
Epoch 36/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1484 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 0s 7ms/step - loss: 0.1908 - binary_accuracy: 0.9712 - balanced_acc: 0.8888 - val_loss: 0.2976 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7129
Epoch 37/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1462 - binary_accuracy: 0.9922 - balanced_acc: 0.954510/10 [==============================] - 0s 7ms/step - loss: 0.1572 - binary_accuracy: 0.9805 - balanced_acc: 0.9246 - val_loss: 0.3065 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6985
Epoch 38/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1453 - binary_accuracy: 0.9766 - balanced_acc: 0.987510/10 [==============================] - 0s 8ms/step - loss: 0.1712 - binary_accuracy: 0.9695 - balanced_acc: 0.8878 - val_loss: 0.3060 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6197
Epoch 39/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1575 - binary_accuracy: 0.9766 - balanced_acc: 0.936010/10 [==============================] - 0s 7ms/step - loss: 0.1548 - binary_accuracy: 0.9763 - balanced_acc: 0.9123 - val_loss: 0.3180 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6364
Epoch 40/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1282 - binary_accuracy: 0.9922 - balanced_acc: 0.944410/10 [==============================] - 0s 7ms/step - loss: 0.1442 - binary_accuracy: 0.9839 - balanced_acc: 0.9520 - val_loss: 0.3255 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6430
Epoch 41/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1133 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1330 - binary_accuracy: 0.9881 - balanced_acc: 0.9724 - val_loss: 0.2951 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7494
Epoch 42/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1157 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1344 - binary_accuracy: 0.9822 - balanced_acc: 0.9160 - val_loss: 0.3263 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6615
Epoch 43/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1099 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1463 - binary_accuracy: 0.9788 - balanced_acc: 0.9198 - val_loss: 0.3538 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6203
Epoch 44/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1360 - binary_accuracy: 0.9766 - balanced_acc: 0.884710/10 [==============================] - 0s 7ms/step - loss: 0.1550 - binary_accuracy: 0.9746 - balanced_acc: 0.9197 - val_loss: 0.3153 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6971
Epoch 45/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1682 - binary_accuracy: 0.9453 - balanced_acc: 0.861610/10 [==============================] - 0s 7ms/step - loss: 0.1511 - binary_accuracy: 0.9771 - balanced_acc: 0.8627 - val_loss: 0.3297 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5961
Epoch 46/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1430 - binary_accuracy: 0.9844 - balanced_acc: 0.916710/10 [==============================] - 0s 7ms/step - loss: 0.1351 - binary_accuracy: 0.9890 - balanced_acc: 0.9560 - val_loss: 0.3267 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6378
Epoch 47/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1726 - binary_accuracy: 0.9766 - balanced_acc: 0.912410/10 [==============================] - 0s 7ms/step - loss: 0.1318 - binary_accuracy: 0.9856 - balanced_acc: 0.9454 - val_loss: 0.3024 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6516
Epoch 48/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1267 - binary_accuracy: 0.9844 - balanced_acc: 0.940210/10 [==============================] - 0s 7ms/step - loss: 0.1288 - binary_accuracy: 0.9864 - balanced_acc: 0.9557 - val_loss: 0.2928 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6520
Epoch 49/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1324 - binary_accuracy: 0.9766 - balanced_acc: 0.906210/10 [==============================] - 0s 7ms/step - loss: 0.1178 - binary_accuracy: 0.9924 - balanced_acc: 0.9881 - val_loss: 0.2982 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 50/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1077 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1154 - binary_accuracy: 0.9915 - balanced_acc: 0.9705 - val_loss: 0.3087 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 51/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1209 - binary_accuracy: 0.9922 - balanced_acc: 0.961510/10 [==============================] - 0s 7ms/step - loss: 0.1118 - binary_accuracy: 0.9924 - balanced_acc: 0.9232 - val_loss: 0.3059 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 52/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1072 - binary_accuracy: 0.9922 - balanced_acc: 0.995810/10 [==============================] - 0s 8ms/step - loss: 0.1125 - binary_accuracy: 0.9907 - balanced_acc: 0.9740 - val_loss: 0.2944 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 53/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1035 - binary_accuracy: 0.9922 - balanced_acc: 0.950010/10 [==============================] - 0s 7ms/step - loss: 0.1125 - binary_accuracy: 0.9924 - balanced_acc: 0.9330 - val_loss: 0.3012 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 54/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1071 - binary_accuracy: 0.9922 - balanced_acc: 0.964310/10 [==============================] - 0s 7ms/step - loss: 0.1111 - binary_accuracy: 0.9924 - balanced_acc: 0.9736 - val_loss: 0.3052 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 55/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0948 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1042 - binary_accuracy: 0.9915 - balanced_acc: 0.9703 - val_loss: 0.2969 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 56/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0947 - binary_accuracy: 0.9922 - balanced_acc: 0.944410/10 [==============================] - 0s 8ms/step - loss: 0.1015 - binary_accuracy: 0.9924 - balanced_acc: 0.9762 - val_loss: 0.2963 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 57/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1067 - binary_accuracy: 0.9766 - balanced_acc: 0.870810/10 [==============================] - 0s 7ms/step - loss: 0.1032 - binary_accuracy: 0.9881 - balanced_acc: 0.9616 - val_loss: 0.2967 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 58/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1033 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1064 - binary_accuracy: 0.9898 - balanced_acc: 0.9787 - val_loss: 0.2971 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 59/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0931 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1071 - binary_accuracy: 0.9898 - balanced_acc: 0.9658 - val_loss: 0.2980 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 60/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1037 - binary_accuracy: 0.9922 - balanced_acc: 0.995710/10 [==============================] - 0s 8ms/step - loss: 0.0980 - binary_accuracy: 0.9949 - balanced_acc: 0.9331 - val_loss: 0.2979 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 61/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0906 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1006 - binary_accuracy: 0.9915 - balanced_acc: 0.9891 - val_loss: 0.2985 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6463
Epoch 62/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1299 - binary_accuracy: 0.9766 - balanced_acc: 0.929210/10 [==============================] - 0s 7ms/step - loss: 0.1098 - binary_accuracy: 0.9881 - balanced_acc: 0.9625 - val_loss: 0.2984 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6463
Epoch 63/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0984 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 7ms/step - loss: 0.1057 - binary_accuracy: 0.9915 - balanced_acc: 0.9724 - val_loss: 0.2972 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 64/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1053 - binary_accuracy: 0.9922 - balanced_acc: 0.995710/10 [==============================] - 0s 7ms/step - loss: 0.0988 - binary_accuracy: 0.9907 - balanced_acc: 0.9203 - val_loss: 0.2967 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629
Epoch 65/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1159 - binary_accuracy: 0.9688 - balanced_acc: 0.845810/10 [==============================] - 0s 7ms/step - loss: 0.1008 - binary_accuracy: 0.9915 - balanced_acc: 0.9695 - val_loss: 0.2965 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6629

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.4278 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3699 - binary_accuracy: 0.9239 - balanced_acc: 0.5805

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-56-57Z

Training run 28/648 (flags = list(0, 256, 0.4, 64, 2048, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-57-10Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 1.5530 - binary_accuracy: 0.5312 - balanced_acc: 0.562712/19 [=================>............] - ETA: 0s - loss: 1.3808 - binary_accuracy: 0.8672 - balanced_acc: 0.497819/19 [==============================] - 1s 48ms/step - loss: 1.3068 - binary_accuracy: 0.8889 - balanced_acc: 0.4986 - val_loss: 1.1253 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0801 - binary_accuracy: 0.9531 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.1193 - binary_accuracy: 0.9107 - balanced_acc: 0.500019/19 [==============================] - 0s 6ms/step - loss: 1.0985 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0622 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 1.1225 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.0517 - binary_accuracy: 0.9196 - balanced_acc: 0.500019/19 [==============================] - 0s 5ms/step - loss: 1.0491 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0185 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.9361 - binary_accuracy: 0.9531 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.9970 - binary_accuracy: 0.9230 - balanced_acc: 0.500019/19 [==============================] - 0s 6ms/step - loss: 1.0033 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9773 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0494 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.9657 - binary_accuracy: 0.9185 - balanced_acc: 0.500019/19 [==============================] - 0s 5ms/step - loss: 0.9623 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9387 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0043 - binary_accuracy: 0.8750 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.9341 - binary_accuracy: 0.9118 - balanced_acc: 0.500019/19 [==============================] - 0s 5ms/step - loss: 0.9177 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9017 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.9335 - binary_accuracy: 0.9062 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.8919 - binary_accuracy: 0.9152 - balanced_acc: 0.500019/19 [==============================] - 0s 5ms/step - loss: 0.8807 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8678 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7793 - binary_accuracy: 0.9531 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.8478 - binary_accuracy: 0.9152 - balanced_acc: 0.500019/19 [==============================] - 0s 5ms/step - loss: 0.8426 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8338 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8364 - binary_accuracy: 0.9219 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.8074 - binary_accuracy: 0.9185 - balanced_acc: 0.500019/19 [==============================] - 0s 5ms/step - loss: 0.8073 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8038 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7828 - binary_accuracy: 0.9219 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.7638 - binary_accuracy: 0.9241 - balanced_acc: 0.508919/19 [==============================] - 0s 5ms/step - loss: 0.7700 - binary_accuracy: 0.9194 - balanced_acc: 0.5066 - val_loss: 0.7738 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7611 - binary_accuracy: 0.9062 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.7428 - binary_accuracy: 0.9196 - balanced_acc: 0.541419/19 [==============================] - 1s 37ms/step - loss: 0.7353 - binary_accuracy: 0.9245 - balanced_acc: 0.5393 - val_loss: 0.7455 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7133 - binary_accuracy: 0.9062 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.6989 - binary_accuracy: 0.9297 - balanced_acc: 0.561719/19 [==============================] - 0s 5ms/step - loss: 0.7014 - binary_accuracy: 0.9271 - balanced_acc: 0.5586 - val_loss: 0.7210 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6989 - binary_accuracy: 0.9219 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.6621 - binary_accuracy: 0.9375 - balanced_acc: 0.560419/19 [==============================] - 0s 5ms/step - loss: 0.6685 - binary_accuracy: 0.9321 - balanced_acc: 0.5676 - val_loss: 0.6948 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6723 - binary_accuracy: 0.9219 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.6455 - binary_accuracy: 0.9330 - balanced_acc: 0.633719/19 [==============================] - 0s 5ms/step - loss: 0.6354 - binary_accuracy: 0.9389 - balanced_acc: 0.6416 - val_loss: 0.6715 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5930 - binary_accuracy: 0.9531 - balanced_acc: 0.500013/19 [===================>..........] - ETA: 0s - loss: 0.6034 - binary_accuracy: 0.9459 - balanced_acc: 0.646019/19 [==============================] - 1s 39ms/step - loss: 0.6062 - binary_accuracy: 0.9415 - balanced_acc: 0.6370 - val_loss: 0.6486 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5333
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6253 - binary_accuracy: 0.9219 - balanced_acc: 0.705511/19 [================>.............] - ETA: 0s - loss: 0.6005 - binary_accuracy: 0.9347 - balanced_acc: 0.687519/19 [==============================] - 0s 6ms/step - loss: 0.5770 - binary_accuracy: 0.9483 - balanced_acc: 0.7059 - val_loss: 0.6331 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5734 - binary_accuracy: 0.9531 - balanced_acc: 0.863614/19 [=====================>........] - ETA: 0s - loss: 0.5497 - binary_accuracy: 0.9520 - balanced_acc: 0.730819/19 [==============================] - 0s 5ms/step - loss: 0.5468 - binary_accuracy: 0.9534 - balanced_acc: 0.7187 - val_loss: 0.6138 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5693 - binary_accuracy: 0.9062 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.5186 - binary_accuracy: 0.9676 - balanced_acc: 0.774919/19 [==============================] - 1s 38ms/step - loss: 0.5201 - binary_accuracy: 0.9652 - balanced_acc: 0.7795 - val_loss: 0.5990 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5417
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4943 - binary_accuracy: 0.9688 - balanced_acc: 0.750014/19 [=====================>........] - ETA: 0s - loss: 0.5006 - binary_accuracy: 0.9699 - balanced_acc: 0.844719/19 [==============================] - 0s 5ms/step - loss: 0.4955 - binary_accuracy: 0.9720 - balanced_acc: 0.8427 - val_loss: 0.5804 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5417
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5120 - binary_accuracy: 0.9531 - balanced_acc: 0.824713/19 [===================>..........] - ETA: 0s - loss: 0.4764 - binary_accuracy: 0.9796 - balanced_acc: 0.874819/19 [==============================] - 0s 6ms/step - loss: 0.4718 - binary_accuracy: 0.9822 - balanced_acc: 0.8992 - val_loss: 0.5719 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5417
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4848 - binary_accuracy: 0.9375 - balanced_acc: 0.776914/19 [=====================>........] - ETA: 0s - loss: 0.4547 - binary_accuracy: 0.9810 - balanced_acc: 0.903519/19 [==============================] - 1s 37ms/step - loss: 0.4506 - binary_accuracy: 0.9822 - balanced_acc: 0.8960 - val_loss: 0.5578 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5917
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4441 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4329 - binary_accuracy: 0.9911 - balanced_acc: 0.964519/19 [==============================] - 0s 5ms/step - loss: 0.4313 - binary_accuracy: 0.9924 - balanced_acc: 0.9706 - val_loss: 0.5581 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5417
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4136 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4127 - binary_accuracy: 0.9933 - balanced_acc: 0.958919/19 [==============================] - 1s 36ms/step - loss: 0.4133 - binary_accuracy: 0.9915 - balanced_acc: 0.9574 - val_loss: 0.5280 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6333
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3995 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.3991 - binary_accuracy: 0.9952 - balanced_acc: 0.981019/19 [==============================] - 0s 5ms/step - loss: 0.3967 - binary_accuracy: 0.9949 - balanced_acc: 0.9813 - val_loss: 0.5352 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5917
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3795 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.3792 - binary_accuracy: 0.9989 - balanced_acc: 0.995519/19 [==============================] - 0s 5ms/step - loss: 0.3815 - binary_accuracy: 0.9958 - balanced_acc: 0.9853 - val_loss: 0.5101 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6167
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3612 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.3718 - binary_accuracy: 0.9944 - balanced_acc: 0.979719/19 [==============================] - 0s 5ms/step - loss: 0.3687 - binary_accuracy: 0.9958 - balanced_acc: 0.9850 - val_loss: 0.5137 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6167
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3561 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.3549 - binary_accuracy: 0.9964 - balanced_acc: 0.970519/19 [==============================] - 0s 5ms/step - loss: 0.3543 - binary_accuracy: 0.9958 - balanced_acc: 0.9728 - val_loss: 0.4931 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6150
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3516 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.3419 - binary_accuracy: 0.9978 - balanced_acc: 0.990519/19 [==============================] - 0s 5ms/step - loss: 0.3434 - binary_accuracy: 0.9966 - balanced_acc: 0.9811 - val_loss: 0.4916 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6167
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3325 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.3317 - binary_accuracy: 0.9989 - balanced_acc: 0.994019/19 [==============================] - 1s 55ms/step - loss: 0.3306 - binary_accuracy: 0.9992 - balanced_acc: 0.9956 - val_loss: 0.4824 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6399
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3223 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.3208 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.3195 - binary_accuracy: 0.9975 - balanced_acc: 0.9930 - val_loss: 0.4772 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6167
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3084 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.3104 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 1s 37ms/step - loss: 0.3087 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.4641 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3058 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2978 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2982 - binary_accuracy: 0.9992 - balanced_acc: 0.9934 - val_loss: 0.4568 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2983 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2889 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 7ms/step - loss: 0.2890 - binary_accuracy: 0.9992 - balanced_acc: 0.9995 - val_loss: 0.4477 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6150
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2752 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2805 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2799 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4341 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 35/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2719 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2725 - binary_accuracy: 1.0000 - balanced_acc: 0.964319/19 [==============================] - 0s 5ms/step - loss: 0.2719 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.4385 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 36/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2590 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2652 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2634 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4244 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 37/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2608 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2553 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2560 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4228 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 38/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2452 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2494 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.2491 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.4196 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6150
Epoch 39/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2450 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.2427 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2413 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4035 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 40/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2350 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2368 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.2366 - binary_accuracy: 0.9992 - balanced_acc: 0.9995 - val_loss: 0.4043 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 41/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2341 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2362 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2359 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4064 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 42/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2373 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.2364 - binary_accuracy: 0.9988 - balanced_acc: 0.999319/19 [==============================] - 0s 6ms/step - loss: 0.2352 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.4072 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 43/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2310 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2340 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2343 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4066 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 44/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2306 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2332 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2336 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4066 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 45/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2290 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.2336 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2330 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.4060 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 46/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2313 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2319 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2322 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4054 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 47/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2320 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2319 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2315 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4037 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 48/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2274 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.2302 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2308 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4025 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 49/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2272 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2306 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2301 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4023 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 50/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2302 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2299 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2297 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4022 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 51/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2346 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2294 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2296 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4021 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 52/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2251 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.2306 - binary_accuracy: 1.0000 - balanced_acc: 1.000017/19 [=========================>....] - ETA: 0s - loss: 0.2295 - binary_accuracy: 1.0000 - balanced_acc: 0.970619/19 [==============================] - 0s 8ms/step - loss: 0.2295 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.4021 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 53/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2243 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2295 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2294 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.4019 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 54/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2361 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2304 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.2292 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4019 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 55/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2287 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2287 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2293 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4019 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 56/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2274 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.2297 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2293 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4018 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 57/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2224 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2287 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2291 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.4017 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 58/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2272 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.2301 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2291 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4015 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 59/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2270 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2280 - binary_accuracy: 1.0000 - balanced_acc: 0.964319/19 [==============================] - 0s 5ms/step - loss: 0.2289 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.4015 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 60/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2302 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2288 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2289 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.4014 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400
Epoch 61/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2304 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2294 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.2288 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.4014 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6400

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.4480 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 1ms/step - loss: 0.4559 - binary_accuracy: 0.9348 - balanced_acc: 0.5665

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-57-10Z

Training run 29/648 (flags = list(0.2, 1024, 0.4, 64, 256, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-57-24Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 2.1688 - binary_accuracy: 0.3906 - balanced_acc: 0.394912/19 [=================>............] - ETA: 0s - loss: 1.5874 - binary_accuracy: 0.8685 - balanced_acc: 0.491219/19 [==============================] - 1s 45ms/step - loss: 1.4247 - binary_accuracy: 0.8897 - balanced_acc: 0.4945 - val_loss: 0.9288 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8878 - binary_accuracy: 0.9531 - balanced_acc: 0.500012/19 [=================>............] - ETA: 0s - loss: 0.8250 - binary_accuracy: 0.9062 - balanced_acc: 0.503019/19 [==============================] - 0s 6ms/step - loss: 0.7221 - binary_accuracy: 0.9211 - balanced_acc: 0.5137 - val_loss: 0.5248 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5023 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 0.4080 - binary_accuracy: 0.9297 - balanced_acc: 0.597019/19 [==============================] - 1s 36ms/step - loss: 0.4093 - binary_accuracy: 0.9288 - balanced_acc: 0.5928 - val_loss: 0.3597 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6890
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3446 - binary_accuracy: 0.9375 - balanced_acc: 0.650314/19 [=====================>........] - ETA: 0s - loss: 0.3203 - binary_accuracy: 0.9286 - balanced_acc: 0.580119/19 [==============================] - 0s 5ms/step - loss: 0.3323 - binary_accuracy: 0.9271 - balanced_acc: 0.6088 - val_loss: 0.3004 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6299
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3152 - binary_accuracy: 0.9062 - balanced_acc: 0.696714/19 [=====================>........] - ETA: 0s - loss: 0.2801 - binary_accuracy: 0.9397 - balanced_acc: 0.692619/19 [==============================] - 0s 5ms/step - loss: 0.2838 - binary_accuracy: 0.9355 - balanced_acc: 0.6912 - val_loss: 0.2907 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6038
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2819 - binary_accuracy: 0.9219 - balanced_acc: 0.687514/19 [=====================>........] - ETA: 0s - loss: 0.2465 - binary_accuracy: 0.9308 - balanced_acc: 0.682119/19 [==============================] - 0s 5ms/step - loss: 0.2408 - binary_accuracy: 0.9347 - balanced_acc: 0.6881 - val_loss: 0.3512 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5250
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2630 - binary_accuracy: 0.9219 - balanced_acc: 0.583314/19 [=====================>........] - ETA: 0s - loss: 0.2214 - binary_accuracy: 0.9408 - balanced_acc: 0.755919/19 [==============================] - 0s 5ms/step - loss: 0.2230 - binary_accuracy: 0.9432 - balanced_acc: 0.7417 - val_loss: 0.2578 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6650
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1497 - binary_accuracy: 0.9844 - balanced_acc: 0.833314/19 [=====================>........] - ETA: 0s - loss: 0.1972 - binary_accuracy: 0.9621 - balanced_acc: 0.806719/19 [==============================] - 0s 5ms/step - loss: 0.2106 - binary_accuracy: 0.9584 - balanced_acc: 0.7871 - val_loss: 0.3079 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6266
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1836 - binary_accuracy: 0.9688 - balanced_acc: 0.800014/19 [=====================>........] - ETA: 0s - loss: 0.2094 - binary_accuracy: 0.9565 - balanced_acc: 0.861319/19 [==============================] - 0s 5ms/step - loss: 0.2261 - binary_accuracy: 0.9483 - balanced_acc: 0.8166 - val_loss: 0.2997 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5883
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1817 - binary_accuracy: 0.9688 - balanced_acc: 0.983114/19 [=====================>........] - ETA: 0s - loss: 0.2046 - binary_accuracy: 0.9598 - balanced_acc: 0.835519/19 [==============================] - 1s 36ms/step - loss: 0.2186 - binary_accuracy: 0.9559 - balanced_acc: 0.8277 - val_loss: 0.2984 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7140
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1858 - binary_accuracy: 0.9844 - balanced_acc: 0.916714/19 [=====================>........] - ETA: 0s - loss: 0.1997 - binary_accuracy: 0.9643 - balanced_acc: 0.869719/19 [==============================] - 0s 6ms/step - loss: 0.2016 - binary_accuracy: 0.9610 - balanced_acc: 0.8655 - val_loss: 0.2822 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6550
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1901 - binary_accuracy: 0.9531 - balanced_acc: 0.750014/19 [=====================>........] - ETA: 0s - loss: 0.1884 - binary_accuracy: 0.9609 - balanced_acc: 0.822119/19 [==============================] - 0s 7ms/step - loss: 0.1997 - binary_accuracy: 0.9576 - balanced_acc: 0.8394 - val_loss: 0.2940 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6766
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1745 - binary_accuracy: 0.9375 - balanced_acc: 0.783113/19 [===================>..........] - ETA: 0s - loss: 0.2019 - binary_accuracy: 0.9567 - balanced_acc: 0.769219/19 [==============================] - 0s 6ms/step - loss: 0.2151 - binary_accuracy: 0.9542 - balanced_acc: 0.7928 - val_loss: 0.2753 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6733
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3106 - binary_accuracy: 0.9375 - balanced_acc: 0.600013/19 [===================>..........] - ETA: 0s - loss: 0.2211 - binary_accuracy: 0.9639 - balanced_acc: 0.828219/19 [==============================] - 0s 6ms/step - loss: 0.2124 - binary_accuracy: 0.9644 - balanced_acc: 0.8280 - val_loss: 0.3269 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6316
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1466 - binary_accuracy: 0.9844 - balanced_acc: 0.833313/19 [===================>..........] - ETA: 0s - loss: 0.1820 - binary_accuracy: 0.9675 - balanced_acc: 0.861319/19 [==============================] - 0s 6ms/step - loss: 0.1928 - binary_accuracy: 0.9635 - balanced_acc: 0.8732 - val_loss: 0.3139 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6226
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1615 - binary_accuracy: 0.9688 - balanced_acc: 0.919814/19 [=====================>........] - ETA: 0s - loss: 0.2369 - binary_accuracy: 0.9531 - balanced_acc: 0.848619/19 [==============================] - 0s 6ms/step - loss: 0.2219 - binary_accuracy: 0.9576 - balanced_acc: 0.8450 - val_loss: 0.3291 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5783
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2375 - binary_accuracy: 0.9375 - balanced_acc: 0.818213/19 [===================>..........] - ETA: 0s - loss: 0.1934 - binary_accuracy: 0.9675 - balanced_acc: 0.852019/19 [==============================] - 0s 5ms/step - loss: 0.1899 - binary_accuracy: 0.9661 - balanced_acc: 0.8499 - val_loss: 0.3227 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5638
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2049 - binary_accuracy: 0.9219 - balanced_acc: 0.732814/19 [=====================>........] - ETA: 0s - loss: 0.1782 - binary_accuracy: 0.9632 - balanced_acc: 0.836719/19 [==============================] - 0s 5ms/step - loss: 0.1710 - binary_accuracy: 0.9661 - balanced_acc: 0.8688 - val_loss: 0.3202 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6021
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1152 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1601 - binary_accuracy: 0.9784 - balanced_acc: 0.934119/19 [==============================] - 1s 37ms/step - loss: 0.1688 - binary_accuracy: 0.9720 - balanced_acc: 0.9117 - val_loss: 0.2769 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.8461
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1989 - binary_accuracy: 0.9531 - balanced_acc: 0.899412/19 [=================>............] - ETA: 0s - loss: 0.1844 - binary_accuracy: 0.9635 - balanced_acc: 0.857319/19 [==============================] - 0s 6ms/step - loss: 0.1909 - binary_accuracy: 0.9669 - balanced_acc: 0.8771 - val_loss: 0.3431 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6521
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1910 - binary_accuracy: 0.9375 - balanced_acc: 0.776913/19 [===================>..........] - ETA: 0s - loss: 0.1808 - binary_accuracy: 0.9639 - balanced_acc: 0.834119/19 [==============================] - 0s 6ms/step - loss: 0.1828 - binary_accuracy: 0.9644 - balanced_acc: 0.8318 - val_loss: 0.2951 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1620 - binary_accuracy: 0.9844 - balanced_acc: 0.937513/19 [===================>..........] - ETA: 0s - loss: 0.1654 - binary_accuracy: 0.9772 - balanced_acc: 0.903319/19 [==============================] - 0s 6ms/step - loss: 0.1723 - binary_accuracy: 0.9712 - balanced_acc: 0.8663 - val_loss: 0.2975 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6904
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1293 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1814 - binary_accuracy: 0.9621 - balanced_acc: 0.854319/19 [==============================] - 0s 5ms/step - loss: 0.1973 - binary_accuracy: 0.9593 - balanced_acc: 0.8632 - val_loss: 0.2859 - val_binary_accuracy: 0.9085 - val_balanced_acc: 0.6174
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2120 - binary_accuracy: 0.9531 - balanced_acc: 0.899414/19 [=====================>........] - ETA: 0s - loss: 0.2123 - binary_accuracy: 0.9576 - balanced_acc: 0.816019/19 [==============================] - 0s 5ms/step - loss: 0.2122 - binary_accuracy: 0.9567 - balanced_acc: 0.8211 - val_loss: 0.2720 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7025
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1586 - binary_accuracy: 0.9844 - balanced_acc: 0.991113/19 [===================>..........] - ETA: 0s - loss: 0.1930 - binary_accuracy: 0.9651 - balanced_acc: 0.803019/19 [==============================] - 0s 6ms/step - loss: 0.2096 - binary_accuracy: 0.9593 - balanced_acc: 0.8372 - val_loss: 0.2587 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6683
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1436 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1853 - binary_accuracy: 0.9676 - balanced_acc: 0.850719/19 [==============================] - 0s 6ms/step - loss: 0.1818 - binary_accuracy: 0.9695 - balanced_acc: 0.8747 - val_loss: 0.3080 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6050
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1611 - binary_accuracy: 0.9688 - balanced_acc: 0.833314/19 [=====================>........] - ETA: 0s - loss: 0.1945 - binary_accuracy: 0.9632 - balanced_acc: 0.796219/19 [==============================] - 0s 6ms/step - loss: 0.1921 - binary_accuracy: 0.9652 - balanced_acc: 0.8353 - val_loss: 0.2681 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6238
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1840 - binary_accuracy: 0.9531 - balanced_acc: 0.866114/19 [=====================>........] - ETA: 0s - loss: 0.1612 - binary_accuracy: 0.9676 - balanced_acc: 0.866219/19 [==============================] - 0s 5ms/step - loss: 0.1637 - binary_accuracy: 0.9652 - balanced_acc: 0.8506 - val_loss: 0.2728 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6904
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1732 - binary_accuracy: 0.9844 - balanced_acc: 0.991513/19 [===================>..........] - ETA: 0s - loss: 0.1551 - binary_accuracy: 0.9748 - balanced_acc: 0.907019/19 [==============================] - 0s 6ms/step - loss: 0.1527 - binary_accuracy: 0.9746 - balanced_acc: 0.9094 - val_loss: 0.2787 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6904
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1281 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1478 - binary_accuracy: 0.9766 - balanced_acc: 0.907919/19 [==============================] - 0s 5ms/step - loss: 0.1467 - binary_accuracy: 0.9771 - balanced_acc: 0.9104 - val_loss: 0.3018 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6221
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1005 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1277 - binary_accuracy: 0.9844 - balanced_acc: 0.944619/19 [==============================] - 0s 6ms/step - loss: 0.1293 - binary_accuracy: 0.9830 - balanced_acc: 0.9209 - val_loss: 0.3002 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6238
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1497 - binary_accuracy: 0.9844 - balanced_acc: 0.991413/19 [===================>..........] - ETA: 0s - loss: 0.1212 - binary_accuracy: 0.9868 - balanced_acc: 0.976819/19 [==============================] - 0s 5ms/step - loss: 0.1201 - binary_accuracy: 0.9873 - balanced_acc: 0.9762 - val_loss: 0.3117 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6221
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1024 - binary_accuracy: 0.9844 - balanced_acc: 0.991914/19 [=====================>........] - ETA: 0s - loss: 0.1087 - binary_accuracy: 0.9888 - balanced_acc: 0.970119/19 [==============================] - 0s 6ms/step - loss: 0.1136 - binary_accuracy: 0.9856 - balanced_acc: 0.9488 - val_loss: 0.3023 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0866 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1136 - binary_accuracy: 0.9868 - balanced_acc: 0.966919/19 [==============================] - 0s 5ms/step - loss: 0.1114 - binary_accuracy: 0.9881 - balanced_acc: 0.9732 - val_loss: 0.2962 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 35/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0995 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.1071 - binary_accuracy: 0.9892 - balanced_acc: 0.918619/19 [==============================] - 0s 6ms/step - loss: 0.1060 - binary_accuracy: 0.9907 - balanced_acc: 0.9386 - val_loss: 0.2996 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 36/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0861 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1018 - binary_accuracy: 0.9933 - balanced_acc: 0.980119/19 [==============================] - 0s 5ms/step - loss: 0.0997 - binary_accuracy: 0.9932 - balanced_acc: 0.9845 - val_loss: 0.3047 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 37/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0949 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0928 - binary_accuracy: 0.9978 - balanced_acc: 0.998819/19 [==============================] - 0s 6ms/step - loss: 0.0963 - binary_accuracy: 0.9941 - balanced_acc: 0.9750 - val_loss: 0.3117 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 38/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0880 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0947 - binary_accuracy: 0.9933 - balanced_acc: 0.984719/19 [==============================] - 0s 5ms/step - loss: 0.0978 - binary_accuracy: 0.9915 - balanced_acc: 0.9716 - val_loss: 0.2911 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 39/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0836 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0939 - binary_accuracy: 0.9911 - balanced_acc: 0.964819/19 [==============================] - 0s 6ms/step - loss: 0.0948 - binary_accuracy: 0.9907 - balanced_acc: 0.9666 - val_loss: 0.2992 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 40/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0900 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0922 - binary_accuracy: 0.9933 - balanced_acc: 0.983319/19 [==============================] - 0s 5ms/step - loss: 0.0926 - binary_accuracy: 0.9949 - balanced_acc: 0.9877 - val_loss: 0.2991 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 41/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0839 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0939 - binary_accuracy: 0.9916 - balanced_acc: 0.979919/19 [==============================] - 0s 6ms/step - loss: 0.0994 - binary_accuracy: 0.9890 - balanced_acc: 0.9770 - val_loss: 0.2981 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 42/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0962 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0897 - binary_accuracy: 0.9967 - balanced_acc: 0.998219/19 [==============================] - 0s 5ms/step - loss: 0.0890 - binary_accuracy: 0.9966 - balanced_acc: 0.9855 - val_loss: 0.2986 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 43/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0814 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0880 - binary_accuracy: 0.9955 - balanced_acc: 0.983919/19 [==============================] - 0s 5ms/step - loss: 0.0900 - binary_accuracy: 0.9949 - balanced_acc: 0.9789 - val_loss: 0.2970 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 44/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0838 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0936 - binary_accuracy: 0.9952 - balanced_acc: 0.985919/19 [==============================] - 0s 6ms/step - loss: 0.0958 - binary_accuracy: 0.9932 - balanced_acc: 0.9776 - val_loss: 0.2963 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 45/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0725 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0896 - binary_accuracy: 0.9952 - balanced_acc: 0.987519/19 [==============================] - 0s 6ms/step - loss: 0.0885 - binary_accuracy: 0.9949 - balanced_acc: 0.9614 - val_loss: 0.2958 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 46/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0866 - binary_accuracy: 0.9844 - balanced_acc: 0.928614/19 [=====================>........] - ETA: 0s - loss: 0.0905 - binary_accuracy: 0.9933 - balanced_acc: 0.980019/19 [==============================] - 0s 6ms/step - loss: 0.0935 - binary_accuracy: 0.9907 - balanced_acc: 0.9668 - val_loss: 0.2955 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 47/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0918 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0929 - binary_accuracy: 0.9940 - balanced_acc: 0.981719/19 [==============================] - 0s 5ms/step - loss: 0.0914 - binary_accuracy: 0.9949 - balanced_acc: 0.9870 - val_loss: 0.2940 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 48/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0804 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.0905 - binary_accuracy: 0.9961 - balanced_acc: 0.997919/19 [==============================] - 0s 7ms/step - loss: 0.0897 - binary_accuracy: 0.9966 - balanced_acc: 0.9723 - val_loss: 0.2940 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 49/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0870 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0973 - binary_accuracy: 0.9928 - balanced_acc: 0.978119/19 [==============================] - 0s 6ms/step - loss: 0.0923 - binary_accuracy: 0.9949 - balanced_acc: 0.9850 - val_loss: 0.2929 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3658 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3683 - binary_accuracy: 0.9212 - balanced_acc: 0.5791

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-57-24Z

Training run 30/648 (flags = list(0.2, 256, 0.3, 256, 1024, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-57-33Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 1.5354 - binary_accuracy: 0.3555 - balanced_acc: 0.54805/5 [==============================] - 1s 158ms/step - loss: 1.4779 - binary_accuracy: 0.6539 - balanced_acc: 0.4940 - val_loss: 1.3855 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 1.3820 - binary_accuracy: 0.9102 - balanced_acc: 0.48955/5 [==============================] - 0s 9ms/step - loss: 1.3438 - binary_accuracy: 0.9143 - balanced_acc: 0.4979 - val_loss: 1.2716 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 1.2716 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 1.2404 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1848 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 1.1599 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 1.1674 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.1224 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 1.1383 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 1.1087 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0814 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 1.1240 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 1.0781 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0560 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0569 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 1.0561 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0401 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0500 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 1.0434 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0285 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9789 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 1.0313 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0180 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9887 - binary_accuracy: 0.9336 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 1.0207 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0071 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9989 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 1.0101 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9956 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9919 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 1.0000 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9945 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9836 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9996 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9934 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9911 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9931 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9922 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9808 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9966 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9910 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0192 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9980 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9899 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0090 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9945 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9887 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0043 - binary_accuracy: 0.9102 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9927 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9875 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9304 - binary_accuracy: 0.9414 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9926 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9864 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9940 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9892 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9852 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9891 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9888 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9841 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0311 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9923 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9839 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9652 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9879 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9838 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9980 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.9878 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9837 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9847 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9898 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9836 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0131 - binary_accuracy: 0.9062 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9881 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9835 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9821 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9885 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9834 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9831 - binary_accuracy: 0.9219 - balanced_acc: 0.50005/5 [==============================] - 0s 13ms/step - loss: 0.9869 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9832 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9616 - binary_accuracy: 0.9258 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9852 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9831 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0544 - binary_accuracy: 0.8867 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9876 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9830 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9955 - binary_accuracy: 0.9141 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9865 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9829 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.9618 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 1ms/step - loss: 0.9599 - binary_accuracy: 0.9402 - balanced_acc: 0.5000

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-57-33Z

Training run 31/648 (flags = list(0.2, 1024, 0.4, 64, 256, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-57-37Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 2.1688 - binary_accuracy: 0.3906 - balanced_acc: 0.394913/19 [===================>..........] - ETA: 0s - loss: 1.5965 - binary_accuracy: 0.8714 - balanced_acc: 0.491919/19 [==============================] - 1s 64ms/step - loss: 1.4863 - binary_accuracy: 0.8897 - balanced_acc: 0.4945 - val_loss: 1.1282 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0820 - binary_accuracy: 0.9531 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.0269 - binary_accuracy: 0.9118 - balanced_acc: 0.510919/19 [==============================] - 1s 37ms/step - loss: 0.9766 - binary_accuracy: 0.9220 - balanced_acc: 0.5330 - val_loss: 0.8038 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8090 - binary_accuracy: 0.9062 - balanced_acc: 0.571414/19 [=====================>........] - ETA: 0s - loss: 0.7078 - binary_accuracy: 0.9275 - balanced_acc: 0.588219/19 [==============================] - 1s 40ms/step - loss: 0.6911 - binary_accuracy: 0.9288 - balanced_acc: 0.6028 - val_loss: 0.6253 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5833
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5367 - binary_accuracy: 0.9531 - balanced_acc: 0.658514/19 [=====================>........] - ETA: 0s - loss: 0.5196 - binary_accuracy: 0.9487 - balanced_acc: 0.702019/19 [==============================] - 1s 39ms/step - loss: 0.5160 - binary_accuracy: 0.9491 - balanced_acc: 0.7234 - val_loss: 0.5165 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7170
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5002 - binary_accuracy: 0.9375 - balanced_acc: 0.839614/19 [=====================>........] - ETA: 0s - loss: 0.4232 - binary_accuracy: 0.9732 - balanced_acc: 0.836419/19 [==============================] - 0s 5ms/step - loss: 0.4224 - binary_accuracy: 0.9678 - balanced_acc: 0.8390 - val_loss: 0.4744 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6300
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4277 - binary_accuracy: 0.9688 - balanced_acc: 0.875014/19 [=====================>........] - ETA: 0s - loss: 0.3516 - binary_accuracy: 0.9777 - balanced_acc: 0.915119/19 [==============================] - 0s 5ms/step - loss: 0.3438 - binary_accuracy: 0.9788 - balanced_acc: 0.9028 - val_loss: 0.4274 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6282
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2847 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2901 - binary_accuracy: 0.9788 - balanced_acc: 0.915919/19 [==============================] - 0s 5ms/step - loss: 0.2833 - binary_accuracy: 0.9805 - balanced_acc: 0.9117 - val_loss: 0.3926 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6538
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2262 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.2395 - binary_accuracy: 0.9888 - balanced_acc: 0.951919/19 [==============================] - 0s 5ms/step - loss: 0.2411 - binary_accuracy: 0.9873 - balanced_acc: 0.9259 - val_loss: 0.3886 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6274
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2159 - binary_accuracy: 0.9844 - balanced_acc: 0.900014/19 [=====================>........] - ETA: 0s - loss: 0.2157 - binary_accuracy: 0.9888 - balanced_acc: 0.973919/19 [==============================] - 0s 5ms/step - loss: 0.2176 - binary_accuracy: 0.9856 - balanced_acc: 0.9660 - val_loss: 0.3675 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6471
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1865 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1975 - binary_accuracy: 0.9866 - balanced_acc: 0.951119/19 [==============================] - 0s 5ms/step - loss: 0.1987 - binary_accuracy: 0.9881 - balanced_acc: 0.9583 - val_loss: 0.3532 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6759
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2083 - binary_accuracy: 0.9844 - balanced_acc: 0.916714/19 [=====================>........] - ETA: 0s - loss: 0.1786 - binary_accuracy: 0.9877 - balanced_acc: 0.948819/19 [==============================] - 0s 5ms/step - loss: 0.1809 - binary_accuracy: 0.9864 - balanced_acc: 0.9533 - val_loss: 0.3360 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6038
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1474 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1623 - binary_accuracy: 0.9933 - balanced_acc: 0.948219/19 [==============================] - 0s 5ms/step - loss: 0.1629 - binary_accuracy: 0.9932 - balanced_acc: 0.9537 - val_loss: 0.3096 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6454
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1628 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1386 - binary_accuracy: 0.9967 - balanced_acc: 0.975619/19 [==============================] - 0s 5ms/step - loss: 0.1388 - binary_accuracy: 0.9949 - balanced_acc: 0.9723 - val_loss: 0.3083 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6337
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1411 - binary_accuracy: 0.9844 - balanced_acc: 0.991514/19 [=====================>........] - ETA: 0s - loss: 0.1364 - binary_accuracy: 0.9933 - balanced_acc: 0.986019/19 [==============================] - 0s 5ms/step - loss: 0.1327 - binary_accuracy: 0.9924 - balanced_acc: 0.9724 - val_loss: 0.3661 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5883
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1409 - binary_accuracy: 0.9688 - balanced_acc: 0.666711/19 [================>.............] - ETA: 0s - loss: 0.1292 - binary_accuracy: 0.9886 - balanced_acc: 0.882119/19 [==============================] - 0s 6ms/step - loss: 0.1257 - binary_accuracy: 0.9915 - balanced_acc: 0.9264 - val_loss: 0.2995 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6721
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1195 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1160 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.1143 - binary_accuracy: 0.9992 - balanced_acc: 0.9732 - val_loss: 0.2917 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6321
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1113 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1121 - binary_accuracy: 0.9978 - balanced_acc: 0.992319/19 [==============================] - 0s 5ms/step - loss: 0.1119 - binary_accuracy: 0.9983 - balanced_acc: 0.9943 - val_loss: 0.2933 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6321
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1077 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1082 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.1079 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2906 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6338
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1118 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1090 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.1079 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2890 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6321
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1060 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1066 - binary_accuracy: 0.9978 - balanced_acc: 0.994319/19 [==============================] - 0s 5ms/step - loss: 0.1059 - binary_accuracy: 0.9983 - balanced_acc: 0.9958 - val_loss: 0.2887 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6321
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1061 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.1035 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.1033 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2863 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6321
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0993 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.1016 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.1018 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2820 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6321
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0997 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0991 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.1012 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2838 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0974 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0981 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0980 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2832 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0950 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0979 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0986 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2829 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0940 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0980 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0975 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2825 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0980 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0967 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0970 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2823 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0988 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0960 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0975 - binary_accuracy: 0.9992 - balanced_acc: 0.9934 - val_loss: 0.2818 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0957 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0958 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0963 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2812 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6254
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1010 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0975 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0976 - binary_accuracy: 0.9992 - balanced_acc: 0.9967 - val_loss: 0.2801 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6254
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0939 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0983 - binary_accuracy: 0.9978 - balanced_acc: 0.987519/19 [==============================] - 0s 8ms/step - loss: 0.0979 - binary_accuracy: 0.9983 - balanced_acc: 0.9645 - val_loss: 0.2792 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6237
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0982 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0969 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0972 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2792 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6237
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1032 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0967 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.0972 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2784 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6487
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0911 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0956 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.0960 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2785 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6237

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3732 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 1ms/step - loss: 0.3635 - binary_accuracy: 0.9185 - balanced_acc: 0.5777

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-57-37Z

Training run 32/648 (flags = list(0.1, 1024, 0.3, 64, 256, 1e-04)) 
Using run directory tuning/ ABL1/2021-11-29T00-57-46Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 2.1687 - binary_accuracy: 0.3281 - balanced_acc: 0.452513/19 [===================>..........] - ETA: 0s - loss: 1.8934 - binary_accuracy: 0.8377 - balanced_acc: 0.513619/19 [==============================] - 1s 44ms/step - loss: 1.8252 - binary_accuracy: 0.8660 - balanced_acc: 0.5093 - val_loss: 1.6504 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.6071 - binary_accuracy: 0.9531 - balanced_acc: 0.500013/19 [===================>..........] - ETA: 0s - loss: 1.6740 - binary_accuracy: 0.9087 - balanced_acc: 0.500019/19 [==============================] - 0s 5ms/step - loss: 1.6380 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.5858 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 1.6539 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.5674 - binary_accuracy: 0.9196 - balanced_acc: 0.500019/19 [==============================] - 0s 6ms/step - loss: 1.5615 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.5170 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 1.4520 - binary_accuracy: 0.9531 - balanced_acc: 0.500013/19 [===================>..........] - ETA: 0s - loss: 1.4759 - binary_accuracy: 0.9279 - balanced_acc: 0.500019/19 [==============================] - 0s 6ms/step - loss: 1.4890 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.4524 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 1.5219 - binary_accuracy: 0.8906 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.4289 - binary_accuracy: 0.9185 - balanced_acc: 0.500019/19 [==============================] - 0s 5ms/step - loss: 1.4244 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.3907 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 1.4424 - binary_accuracy: 0.8750 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.3760 - binary_accuracy: 0.9129 - balanced_acc: 0.508919/19 [==============================] - 0s 5ms/step - loss: 1.3585 - binary_accuracy: 0.9203 - balanced_acc: 0.5110 - val_loss: 1.3323 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 1.3649 - binary_accuracy: 0.9062 - balanced_acc: 0.500012/19 [=================>............] - ETA: 0s - loss: 1.3059 - binary_accuracy: 0.9167 - balanced_acc: 0.509719/19 [==============================] - 1s 38ms/step - loss: 1.2948 - binary_accuracy: 0.9211 - balanced_acc: 0.5165 - val_loss: 1.2793 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 1.1858 - binary_accuracy: 0.9531 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.2437 - binary_accuracy: 0.9241 - balanced_acc: 0.547819/19 [==============================] - 1s 36ms/step - loss: 1.2391 - binary_accuracy: 0.9262 - balanced_acc: 0.5438 - val_loss: 1.2272 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5400
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 1.2136 - binary_accuracy: 0.9219 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.1831 - binary_accuracy: 0.9364 - balanced_acc: 0.598319/19 [==============================] - 0s 5ms/step - loss: 1.1817 - binary_accuracy: 0.9338 - balanced_acc: 0.5869 - val_loss: 1.1810 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5400
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 1.1408 - binary_accuracy: 0.9531 - balanced_acc: 0.700014/19 [=====================>........] - ETA: 0s - loss: 1.1223 - binary_accuracy: 0.9397 - balanced_acc: 0.638119/19 [==============================] - 1s 36ms/step - loss: 1.1260 - binary_accuracy: 0.9347 - balanced_acc: 0.6316 - val_loss: 1.1361 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5567
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0950 - binary_accuracy: 0.9531 - balanced_acc: 0.750014/19 [=====================>........] - ETA: 0s - loss: 1.0821 - binary_accuracy: 0.9375 - balanced_acc: 0.660419/19 [==============================] - 1s 56ms/step - loss: 1.0765 - binary_accuracy: 0.9364 - balanced_acc: 0.6344 - val_loss: 1.0939 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5817
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0494 - binary_accuracy: 0.9375 - balanced_acc: 0.666714/19 [=====================>........] - ETA: 0s - loss: 1.0267 - binary_accuracy: 0.9442 - balanced_acc: 0.649419/19 [==============================] - 0s 5ms/step - loss: 1.0271 - binary_accuracy: 0.9415 - balanced_acc: 0.6684 - val_loss: 1.0583 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5417
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 1.0195 - binary_accuracy: 0.9062 - balanced_acc: 0.491514/19 [=====================>........] - ETA: 0s - loss: 0.9789 - binary_accuracy: 0.9531 - balanced_acc: 0.676919/19 [==============================] - 1s 37ms/step - loss: 0.9813 - binary_accuracy: 0.9500 - balanced_acc: 0.6804 - val_loss: 1.0185 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5833
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.9843 - binary_accuracy: 0.9531 - balanced_acc: 0.700014/19 [=====================>........] - ETA: 0s - loss: 0.9488 - binary_accuracy: 0.9520 - balanced_acc: 0.770019/19 [==============================] - 1s 36ms/step - loss: 0.9387 - binary_accuracy: 0.9576 - balanced_acc: 0.7772 - val_loss: 0.9873 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5917
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8975 - binary_accuracy: 0.9688 - balanced_acc: 0.666714/19 [=====================>........] - ETA: 0s - loss: 0.8993 - binary_accuracy: 0.9609 - balanced_acc: 0.759119/19 [==============================] - 1s 37ms/step - loss: 0.8971 - binary_accuracy: 0.9601 - balanced_acc: 0.7682 - val_loss: 0.9515 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6083
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8964 - binary_accuracy: 0.9375 - balanced_acc: 0.776914/19 [=====================>........] - ETA: 0s - loss: 0.8687 - binary_accuracy: 0.9732 - balanced_acc: 0.865919/19 [==============================] - 0s 5ms/step - loss: 0.8589 - binary_accuracy: 0.9754 - balanced_acc: 0.8520 - val_loss: 0.9309 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5667
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8564 - binary_accuracy: 0.9688 - balanced_acc: 0.909114/19 [=====================>........] - ETA: 0s - loss: 0.8297 - binary_accuracy: 0.9688 - balanced_acc: 0.821919/19 [==============================] - 0s 5ms/step - loss: 0.8239 - binary_accuracy: 0.9729 - balanced_acc: 0.8394 - val_loss: 0.8994 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6083
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8377 - binary_accuracy: 0.9531 - balanced_acc: 0.824714/19 [=====================>........] - ETA: 0s - loss: 0.7909 - binary_accuracy: 0.9799 - balanced_acc: 0.850019/19 [==============================] - 0s 5ms/step - loss: 0.7889 - binary_accuracy: 0.9805 - balanced_acc: 0.8678 - val_loss: 0.8737 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6083
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7619 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.7653 - binary_accuracy: 0.9810 - balanced_acc: 0.870719/19 [==============================] - 0s 5ms/step - loss: 0.7599 - binary_accuracy: 0.9822 - balanced_acc: 0.8780 - val_loss: 0.8480 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6067
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7650 - binary_accuracy: 0.9688 - balanced_acc: 0.908014/19 [=====================>........] - ETA: 0s - loss: 0.7334 - binary_accuracy: 0.9866 - balanced_acc: 0.935019/19 [==============================] - 0s 5ms/step - loss: 0.7288 - binary_accuracy: 0.9881 - balanced_acc: 0.9446 - val_loss: 0.8277 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6050
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.7178 - binary_accuracy: 0.9844 - balanced_acc: 0.928613/19 [===================>..........] - ETA: 0s - loss: 0.7041 - binary_accuracy: 0.9868 - balanced_acc: 0.924819/19 [==============================] - 0s 6ms/step - loss: 0.6986 - binary_accuracy: 0.9890 - balanced_acc: 0.9345 - val_loss: 0.8050 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6050
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6920 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.6747 - binary_accuracy: 0.9955 - balanced_acc: 0.985419/19 [==============================] - 0s 5ms/step - loss: 0.6729 - binary_accuracy: 0.9949 - balanced_acc: 0.9826 - val_loss: 0.7975 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5667
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6508 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.6496 - binary_accuracy: 0.9933 - balanced_acc: 0.953319/19 [==============================] - 1s 36ms/step - loss: 0.6504 - binary_accuracy: 0.9915 - balanced_acc: 0.9565 - val_loss: 0.7578 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6800
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6314 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.6293 - binary_accuracy: 0.9952 - balanced_acc: 0.981019/19 [==============================] - 0s 5ms/step - loss: 0.6261 - binary_accuracy: 0.9958 - balanced_acc: 0.9866 - val_loss: 0.7534 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5633
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6081 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.6048 - binary_accuracy: 0.9952 - balanced_acc: 0.979719/19 [==============================] - 0s 6ms/step - loss: 0.6066 - binary_accuracy: 0.9941 - balanced_acc: 0.9799 - val_loss: 0.7266 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6133
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5818 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.5873 - binary_accuracy: 0.9976 - balanced_acc: 0.989019/19 [==============================] - 0s 5ms/step - loss: 0.5836 - binary_accuracy: 0.9975 - balanced_acc: 0.9859 - val_loss: 0.7195 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5883
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5716 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.5638 - binary_accuracy: 0.9988 - balanced_acc: 0.999319/19 [==============================] - 0s 7ms/step - loss: 0.5623 - binary_accuracy: 0.9983 - balanced_acc: 0.9930 - val_loss: 0.6937 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6550
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5644 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.5481 - binary_accuracy: 0.9988 - balanced_acc: 0.999319/19 [==============================] - 0s 6ms/step - loss: 0.5467 - binary_accuracy: 0.9975 - balanced_acc: 0.9877 - val_loss: 0.6813 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6550
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5322 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/19 [========>.....................] - ETA: 0s - loss: 0.5338 - binary_accuracy: 1.0000 - balanced_acc: 1.000018/19 [===========================>..] - ETA: 0s - loss: 0.5278 - binary_accuracy: 0.9983 - balanced_acc: 0.994919/19 [==============================] - 0s 9ms/step - loss: 0.5279 - binary_accuracy: 0.9983 - balanced_acc: 0.9952 - val_loss: 0.6687 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6300
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.5215 - binary_accuracy: 1.0000 - balanced_acc: 1.000012/19 [=================>............] - ETA: 0s - loss: 0.5153 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.5120 - binary_accuracy: 0.9983 - balanced_acc: 0.9963 - val_loss: 0.6552 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5800
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4962 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4966 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4947 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.6358 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6300
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4858 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4792 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4788 - binary_accuracy: 0.9992 - balanced_acc: 0.9967 - val_loss: 0.6252 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4784 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4644 - binary_accuracy: 0.9989 - balanced_acc: 0.994019/19 [==============================] - 0s 6ms/step - loss: 0.4645 - binary_accuracy: 0.9983 - balanced_acc: 0.9952 - val_loss: 0.6093 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4471 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4548 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4548 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.6099 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6300
Epoch 35/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4519 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4552 - binary_accuracy: 0.9988 - balanced_acc: 0.960919/19 [==============================] - 0s 6ms/step - loss: 0.4544 - binary_accuracy: 0.9992 - balanced_acc: 0.9732 - val_loss: 0.6095 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6300
Epoch 36/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4439 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4537 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4523 - binary_accuracy: 0.9992 - balanced_acc: 0.9912 - val_loss: 0.6074 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 37/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4568 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4497 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4505 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.6064 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 38/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4407 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4491 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4500 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.6045 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 39/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4488 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4476 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4472 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.6049 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6300
Epoch 40/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4500 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4470 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4464 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.6031 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6300
Epoch 41/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4514 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4452 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4445 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.6018 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6300
Epoch 42/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4515 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4438 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4426 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.6003 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 43/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4379 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4419 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4417 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.5988 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 44/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4354 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4407 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4411 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.5988 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 45/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4377 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4421 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.4406 - binary_accuracy: 0.9992 - balanced_acc: 0.9732 - val_loss: 0.5987 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 46/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4382 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4399 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4404 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.5987 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 47/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4415 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4414 - binary_accuracy: 0.9988 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.4403 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.5985 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 48/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4363 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4396 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4403 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.5984 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 49/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4358 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4403 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 5ms/step - loss: 0.4396 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.5984 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 50/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4405 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4401 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 6ms/step - loss: 0.4398 - binary_accuracy: 0.9992 - balanced_acc: 0.9995 - val_loss: 0.5983 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 51/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4473 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.4394 - binary_accuracy: 0.9989 - balanced_acc: 0.999419/19 [==============================] - 0s 5ms/step - loss: 0.4394 - binary_accuracy: 0.9983 - balanced_acc: 0.9952 - val_loss: 0.5982 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 52/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4344 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4399 - binary_accuracy: 1.0000 - balanced_acc: 0.961519/19 [==============================] - 0s 6ms/step - loss: 0.4401 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.5981 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271
Epoch 53/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4320 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.4404 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 6ms/step - loss: 0.4404 - binary_accuracy: 0.9992 - balanced_acc: 0.9733 - val_loss: 0.5979 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6271

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.6719 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 1ms/step - loss: 0.6367 - binary_accuracy: 0.9348 - balanced_acc: 0.5860

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-57-46Z

Training run 33/648 (flags = list(0.2, 2048, 0.4, 128, 1024, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-58-00Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/10 [==>...........................] - ETA: 0s - loss: 3.4502 - binary_accuracy: 0.3750 - balanced_acc: 0.3793 6/10 [=================>............] - ETA: 0s - loss: 2.9660 - binary_accuracy: 0.8255 - balanced_acc: 0.479910/10 [==============================] - 1s 90ms/step - loss: 2.7806 - binary_accuracy: 0.8617 - balanced_acc: 0.4879 - val_loss: 2.2247 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/10 [==>...........................] - ETA: 0s - loss: 2.1742 - binary_accuracy: 0.9531 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 2.0657 - binary_accuracy: 0.9049 - balanced_acc: 0.500010/10 [==============================] - 0s 13ms/step - loss: 1.9280 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.5702 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.5462 - binary_accuracy: 0.9219 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 1.4186 - binary_accuracy: 0.9167 - balanced_acc: 0.500010/10 [==============================] - 1s 72ms/step - loss: 1.3479 - binary_accuracy: 0.9194 - balanced_acc: 0.5063 - val_loss: 1.1279 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 4/250
 1/10 [==>...........................] - ETA: 0s - loss: 1.0495 - binary_accuracy: 0.9453 - balanced_acc: 0.5000 6/10 [=================>............] - ETA: 0s - loss: 0.9862 - binary_accuracy: 0.9440 - balanced_acc: 0.603210/10 [==============================] - 1s 73ms/step - loss: 0.9570 - binary_accuracy: 0.9372 - balanced_acc: 0.6214 - val_loss: 0.8473 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5685
Epoch 5/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.8274 - binary_accuracy: 0.9219 - balanced_acc: 0.7245 6/10 [=================>............] - ETA: 0s - loss: 0.7406 - binary_accuracy: 0.9714 - balanced_acc: 0.855510/10 [==============================] - 0s 12ms/step - loss: 0.7147 - binary_accuracy: 0.9669 - balanced_acc: 0.8190 - val_loss: 0.7106 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 6/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.6107 - binary_accuracy: 0.9375 - balanced_acc: 0.6667 6/10 [=================>............] - ETA: 0s - loss: 0.5636 - binary_accuracy: 0.9779 - balanced_acc: 0.908810/10 [==============================] - 0s 12ms/step - loss: 0.5421 - binary_accuracy: 0.9788 - balanced_acc: 0.8652 - val_loss: 0.6122 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5519
Epoch 7/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.4606 - binary_accuracy: 0.9844 - balanced_acc: 0.9000 6/10 [=================>............] - ETA: 0s - loss: 0.4464 - binary_accuracy: 0.9831 - balanced_acc: 0.929210/10 [==============================] - 0s 13ms/step - loss: 0.4298 - binary_accuracy: 0.9839 - balanced_acc: 0.9264 - val_loss: 0.5039 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5676
Epoch 8/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.3574 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.3528 - binary_accuracy: 0.9922 - balanced_acc: 0.974010/10 [==============================] - 1s 73ms/step - loss: 0.3468 - binary_accuracy: 0.9881 - balanced_acc: 0.9515 - val_loss: 0.4815 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6255
Epoch 9/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2912 - binary_accuracy: 0.9922 - balanced_acc: 0.9286 6/10 [=================>............] - ETA: 0s - loss: 0.2964 - binary_accuracy: 0.9896 - balanced_acc: 0.949610/10 [==============================] - 0s 12ms/step - loss: 0.2923 - binary_accuracy: 0.9881 - balanced_acc: 0.9635 - val_loss: 0.4209 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5833
Epoch 10/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2479 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.2569 - binary_accuracy: 0.9909 - balanced_acc: 0.948210/10 [==============================] - 1s 73ms/step - loss: 0.2593 - binary_accuracy: 0.9864 - balanced_acc: 0.9442 - val_loss: 0.3844 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6702
Epoch 11/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.2158 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.2257 - binary_accuracy: 0.9870 - balanced_acc: 0.939510/10 [==============================] - 0s 12ms/step - loss: 0.2264 - binary_accuracy: 0.9864 - balanced_acc: 0.9567 - val_loss: 0.3893 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5704
Epoch 12/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1955 - binary_accuracy: 0.9922 - balanced_acc: 0.9583 6/10 [=================>............] - ETA: 0s - loss: 0.2097 - binary_accuracy: 0.9805 - balanced_acc: 0.859810/10 [==============================] - 0s 13ms/step - loss: 0.2294 - binary_accuracy: 0.9754 - balanced_acc: 0.8808 - val_loss: 0.3314 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6109
Epoch 13/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1954 - binary_accuracy: 0.9922 - balanced_acc: 0.9444 6/10 [=================>............] - ETA: 0s - loss: 0.2183 - binary_accuracy: 0.9792 - balanced_acc: 0.841010/10 [==============================] - 1s 116ms/step - loss: 0.2103 - binary_accuracy: 0.9830 - balanced_acc: 0.8897 - val_loss: 0.3146 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6995
Epoch 14/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1911 - binary_accuracy: 0.9844 - balanced_acc: 0.9916 6/10 [=================>............] - ETA: 0s - loss: 0.1829 - binary_accuracy: 0.9909 - balanced_acc: 0.978710/10 [==============================] - 0s 12ms/step - loss: 0.1786 - binary_accuracy: 0.9890 - balanced_acc: 0.9451 - val_loss: 0.2988 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.6915
Epoch 15/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1483 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.1595 - binary_accuracy: 0.9948 - balanced_acc: 0.984010/10 [==============================] - 0s 12ms/step - loss: 0.1582 - binary_accuracy: 0.9932 - balanced_acc: 0.9744 - val_loss: 0.2845 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6444
Epoch 16/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1443 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/10 [====================>.........] - ETA: 0s - loss: 0.1450 - binary_accuracy: 0.9944 - balanced_acc: 0.983310/10 [==============================] - 0s 12ms/step - loss: 0.1425 - binary_accuracy: 0.9949 - balanced_acc: 0.9338 - val_loss: 0.3058 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5505
Epoch 17/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1301 - binary_accuracy: 0.9922 - balanced_acc: 0.9957 6/10 [=================>............] - ETA: 0s - loss: 0.1264 - binary_accuracy: 0.9974 - balanced_acc: 0.990910/10 [==============================] - 1s 74ms/step - loss: 0.1250 - binary_accuracy: 0.9975 - balanced_acc: 0.9904 - val_loss: 0.2499 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7460
Epoch 18/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1229 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.1151 - binary_accuracy: 0.9987 - balanced_acc: 0.992410/10 [==============================] - 0s 13ms/step - loss: 0.1146 - binary_accuracy: 0.9983 - balanced_acc: 0.9950 - val_loss: 0.2775 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6240
Epoch 19/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.1032 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.1043 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 13ms/step - loss: 0.1025 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2670 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6443
Epoch 20/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0987 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0947 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0992 - binary_accuracy: 0.9975 - balanced_acc: 0.9862 - val_loss: 0.2557 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6563
Epoch 21/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0875 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0932 - binary_accuracy: 0.9948 - balanced_acc: 0.984710/10 [==============================] - 1s 74ms/step - loss: 0.0919 - binary_accuracy: 0.9949 - balanced_acc: 0.9848 - val_loss: 0.2437 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7494
Epoch 22/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0891 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0895 - binary_accuracy: 0.9948 - balanced_acc: 0.981910/10 [==============================] - 0s 12ms/step - loss: 0.0904 - binary_accuracy: 0.9949 - balanced_acc: 0.9779 - val_loss: 0.2546 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6509
Epoch 23/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0774 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0864 - binary_accuracy: 0.9974 - balanced_acc: 0.991010/10 [==============================] - 0s 13ms/step - loss: 0.0857 - binary_accuracy: 0.9966 - balanced_acc: 0.9896 - val_loss: 0.2463 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6549
Epoch 24/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0748 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0831 - binary_accuracy: 0.9987 - balanced_acc: 0.994010/10 [==============================] - 0s 13ms/step - loss: 0.0805 - binary_accuracy: 0.9992 - balanced_acc: 0.9964 - val_loss: 0.2717 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6245
Epoch 25/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0709 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0758 - binary_accuracy: 0.9987 - balanced_acc: 0.994010/10 [==============================] - 0s 13ms/step - loss: 0.0770 - binary_accuracy: 0.9983 - balanced_acc: 0.9960 - val_loss: 0.2483 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7090
Epoch 26/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0769 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0753 - binary_accuracy: 0.9974 - balanced_acc: 0.984710/10 [==============================] - 0s 14ms/step - loss: 0.0770 - binary_accuracy: 0.9958 - balanced_acc: 0.9813 - val_loss: 0.2427 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7355
Epoch 27/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0696 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0725 - binary_accuracy: 0.9974 - balanced_acc: 0.998610/10 [==============================] - 0s 13ms/step - loss: 0.0721 - binary_accuracy: 0.9975 - balanced_acc: 0.9936 - val_loss: 0.2322 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7308
Epoch 28/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0644 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0711 - binary_accuracy: 0.9974 - balanced_acc: 0.988110/10 [==============================] - 1s 77ms/step - loss: 0.0722 - binary_accuracy: 0.9958 - balanced_acc: 0.9792 - val_loss: 0.2595 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.7666
Epoch 29/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0857 - binary_accuracy: 0.9844 - balanced_acc: 0.9916 6/10 [=================>............] - ETA: 0s - loss: 0.0740 - binary_accuracy: 0.9922 - balanced_acc: 0.985010/10 [==============================] - 0s 13ms/step - loss: 0.0740 - binary_accuracy: 0.9932 - balanced_acc: 0.9886 - val_loss: 0.2674 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6387
Epoch 30/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0691 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0820 - binary_accuracy: 0.9922 - balanced_acc: 0.965210/10 [==============================] - 0s 13ms/step - loss: 0.0764 - binary_accuracy: 0.9949 - balanced_acc: 0.9791 - val_loss: 0.2991 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6193
Epoch 31/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0861 - binary_accuracy: 0.9844 - balanced_acc: 0.8889 6/10 [=================>............] - ETA: 0s - loss: 0.0756 - binary_accuracy: 0.9922 - balanced_acc: 0.962010/10 [==============================] - 0s 12ms/step - loss: 0.0755 - binary_accuracy: 0.9924 - balanced_acc: 0.9143 - val_loss: 0.2479 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6447
Epoch 32/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0668 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0781 - binary_accuracy: 0.9922 - balanced_acc: 0.970810/10 [==============================] - 0s 12ms/step - loss: 0.0791 - binary_accuracy: 0.9932 - balanced_acc: 0.9782 - val_loss: 0.2741 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6549
Epoch 33/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0729 - binary_accuracy: 0.9922 - balanced_acc: 0.9545 6/10 [=================>............] - ETA: 0s - loss: 0.0706 - binary_accuracy: 0.9935 - balanced_acc: 0.973010/10 [==============================] - 0s 12ms/step - loss: 0.0712 - binary_accuracy: 0.9949 - balanced_acc: 0.9834 - val_loss: 0.2548 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5799
Epoch 34/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0579 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0676 - binary_accuracy: 0.9974 - balanced_acc: 0.985310/10 [==============================] - 0s 13ms/step - loss: 0.0743 - binary_accuracy: 0.9966 - balanced_acc: 0.9845 - val_loss: 0.2317 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6350
Epoch 35/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0601 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0628 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 1s 75ms/step - loss: 0.0682 - binary_accuracy: 0.9975 - balanced_acc: 0.9900 - val_loss: 0.2710 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7679
Epoch 36/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0881 - binary_accuracy: 0.9922 - balanced_acc: 0.9958 6/10 [=================>............] - ETA: 0s - loss: 0.0863 - binary_accuracy: 0.9883 - balanced_acc: 0.974410/10 [==============================] - 0s 13ms/step - loss: 0.0900 - binary_accuracy: 0.9881 - balanced_acc: 0.9546 - val_loss: 0.2576 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6488
Epoch 37/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0823 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0712 - binary_accuracy: 0.9974 - balanced_acc: 0.988910/10 [==============================] - 0s 13ms/step - loss: 0.0715 - binary_accuracy: 0.9966 - balanced_acc: 0.9788 - val_loss: 0.2492 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7299
Epoch 38/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0642 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0754 - binary_accuracy: 0.9961 - balanced_acc: 0.988210/10 [==============================] - 0s 13ms/step - loss: 0.0734 - binary_accuracy: 0.9966 - balanced_acc: 0.9879 - val_loss: 0.2890 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6060
Epoch 39/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0596 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0691 - binary_accuracy: 0.9974 - balanced_acc: 0.984110/10 [==============================] - 0s 12ms/step - loss: 0.0739 - binary_accuracy: 0.9966 - balanced_acc: 0.9896 - val_loss: 0.2522 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6956
Epoch 40/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0597 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0750 - binary_accuracy: 0.9935 - balanced_acc: 0.996410/10 [==============================] - 0s 13ms/step - loss: 0.0757 - binary_accuracy: 0.9949 - balanced_acc: 0.9945 - val_loss: 0.2683 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6364
Epoch 41/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0621 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0647 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 13ms/step - loss: 0.0708 - binary_accuracy: 0.9966 - balanced_acc: 0.9881 - val_loss: 0.2444 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6780
Epoch 42/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0593 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0617 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0629 - binary_accuracy: 0.9983 - balanced_acc: 0.9700 - val_loss: 0.2472 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6614
Epoch 43/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0545 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0600 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 13ms/step - loss: 0.0618 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2644 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6690
Epoch 44/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0525 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0602 - binary_accuracy: 0.9974 - balanced_acc: 0.987210/10 [==============================] - 0s 13ms/step - loss: 0.0625 - binary_accuracy: 0.9975 - balanced_acc: 0.9885 - val_loss: 0.2511 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6895
Epoch 45/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0554 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0570 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 13ms/step - loss: 0.0583 - binary_accuracy: 0.9983 - balanced_acc: 0.9466 - val_loss: 0.2389 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.7275
Epoch 46/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0550 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0576 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 13ms/step - loss: 0.0569 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2499 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6952
Epoch 47/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0525 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0541 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0536 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2682 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6259
Epoch 48/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0524 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0537 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 16ms/step - loss: 0.0535 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2579 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6245
Epoch 49/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0512 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0526 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 14ms/step - loss: 0.0516 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2482 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6785
Epoch 50/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0504 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0515 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0514 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2462 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6785
Epoch 51/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0528 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0511 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0511 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2471 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6600
Epoch 52/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0481 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0525 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 13ms/step - loss: 0.0522 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2490 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 53/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0478 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0498 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0499 - binary_accuracy: 1.0000 - balanced_acc: 0.9500 - val_loss: 0.2484 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 54/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0517 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0495 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0491 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2496 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 55/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0474 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0480 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0485 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2499 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 56/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0479 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0488 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0485 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2493 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 57/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0485 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0500 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 13ms/step - loss: 0.0494 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2484 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 58/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0468 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0493 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0486 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2469 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 59/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0500 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0481 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0490 - binary_accuracy: 0.9992 - balanced_acc: 0.9971 - val_loss: 0.2461 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 60/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0544 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0486 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0487 - binary_accuracy: 1.0000 - balanced_acc: 0.9500 - val_loss: 0.2458 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6647
Epoch 61/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0519 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0490 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0482 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2455 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6600
Epoch 62/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0469 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0479 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0480 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2452 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6600
Epoch 63/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0503 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0488 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0483 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2449 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6600
Epoch 64/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0609 - binary_accuracy: 0.9922 - balanced_acc: 0.9957 6/10 [=================>............] - ETA: 0s - loss: 0.0499 - binary_accuracy: 0.9987 - balanced_acc: 0.999310/10 [==============================] - 0s 12ms/step - loss: 0.0493 - binary_accuracy: 0.9992 - balanced_acc: 0.9496 - val_loss: 0.2449 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6600
Epoch 65/250
 1/10 [==>...........................] - ETA: 0s - loss: 0.0467 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 6/10 [=================>............] - ETA: 0s - loss: 0.0473 - binary_accuracy: 1.0000 - balanced_acc: 1.000010/10 [==============================] - 0s 13ms/step - loss: 0.0475 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2448 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6600

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3515 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 2ms/step - loss: 0.3462 - binary_accuracy: 0.9185 - balanced_acc: 0.5777

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-58-00Z

Training run 34/648 (flags = list(0.1, 2048, 0.4, 64, 2048, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-58-18Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 4.0859 - binary_accuracy: 0.6094 - balanced_acc: 0.5136 5/19 [======>.......................] - ETA: 0s - loss: 6.2931 - binary_accuracy: 0.8469 - balanced_acc: 0.5027 9/19 [=============>................] - ETA: 0s - loss: 5.0023 - binary_accuracy: 0.8698 - balanced_acc: 0.501513/19 [===================>..........] - ETA: 0s - loss: 4.4302 - binary_accuracy: 0.8882 - balanced_acc: 0.501017/19 [=========================>....] - ETA: 0s - loss: 4.0157 - binary_accuracy: 0.9007 - balanced_acc: 0.500819/19 [==============================] - 1s 57ms/step - loss: 3.8899 - binary_accuracy: 0.9016 - balanced_acc: 0.5007 - val_loss: 2.1959 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 2.1446 - binary_accuracy: 0.9531 - balanced_acc: 0.5000 5/19 [======>.......................] - ETA: 0s - loss: 2.0028 - binary_accuracy: 0.9312 - balanced_acc: 0.5792 9/19 [=============>................] - ETA: 0s - loss: 1.8556 - binary_accuracy: 0.9201 - balanced_acc: 0.542113/19 [===================>..........] - ETA: 0s - loss: 1.7271 - binary_accuracy: 0.9135 - balanced_acc: 0.568817/19 [=========================>....] - ETA: 0s - loss: 1.5909 - binary_accuracy: 0.9228 - balanced_acc: 0.588419/19 [==============================] - 1s 49ms/step - loss: 1.5467 - binary_accuracy: 0.9254 - balanced_acc: 0.5999 - val_loss: 0.9993 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5417
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.9724 - binary_accuracy: 0.9062 - balanced_acc: 0.6341 4/19 [=====>........................] - ETA: 0s - loss: 0.8867 - binary_accuracy: 0.9453 - balanced_acc: 0.6929 8/19 [===========>..................] - ETA: 0s - loss: 0.8296 - binary_accuracy: 0.9512 - balanced_acc: 0.689512/19 [=================>............] - ETA: 0s - loss: 0.7918 - binary_accuracy: 0.9414 - balanced_acc: 0.700316/19 [========================>.....] - ETA: 0s - loss: 0.7620 - binary_accuracy: 0.9395 - balanced_acc: 0.666919/19 [==============================] - 1s 50ms/step - loss: 0.7459 - binary_accuracy: 0.9381 - balanced_acc: 0.6650 - val_loss: 0.6347 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7637
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.6137 - binary_accuracy: 0.9531 - balanced_acc: 0.9754 5/19 [======>.......................] - ETA: 0s - loss: 0.5084 - binary_accuracy: 0.9688 - balanced_acc: 0.7484 9/19 [=============>................] - ETA: 0s - loss: 0.5156 - binary_accuracy: 0.9514 - balanced_acc: 0.688913/19 [===================>..........] - ETA: 0s - loss: 0.4909 - binary_accuracy: 0.9495 - balanced_acc: 0.725917/19 [=========================>....] - ETA: 0s - loss: 0.4773 - binary_accuracy: 0.9485 - balanced_acc: 0.744119/19 [==============================] - 0s 16ms/step - loss: 0.4778 - binary_accuracy: 0.9449 - balanced_acc: 0.7359 - val_loss: 0.4154 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6052
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3647 - binary_accuracy: 0.9531 - balanced_acc: 0.7857 5/19 [======>.......................] - ETA: 0s - loss: 0.3539 - binary_accuracy: 0.9500 - balanced_acc: 0.8439 9/19 [=============>................] - ETA: 0s - loss: 0.3295 - binary_accuracy: 0.9566 - balanced_acc: 0.808613/19 [===================>..........] - ETA: 0s - loss: 0.3562 - binary_accuracy: 0.9519 - balanced_acc: 0.801117/19 [=========================>....] - ETA: 0s - loss: 0.3568 - binary_accuracy: 0.9467 - balanced_acc: 0.781019/19 [==============================] - 0s 17ms/step - loss: 0.3615 - binary_accuracy: 0.9457 - balanced_acc: 0.7729 - val_loss: 0.4032 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5650
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3913 - binary_accuracy: 0.9062 - balanced_acc: 0.6250 5/19 [======>.......................] - ETA: 0s - loss: 0.3122 - binary_accuracy: 0.9469 - balanced_acc: 0.7453 9/19 [=============>................] - ETA: 0s - loss: 0.2974 - binary_accuracy: 0.9566 - balanced_acc: 0.790713/19 [===================>..........] - ETA: 0s - loss: 0.3057 - binary_accuracy: 0.9495 - balanced_acc: 0.775617/19 [=========================>....] - ETA: 0s - loss: 0.2889 - binary_accuracy: 0.9540 - balanced_acc: 0.796119/19 [==============================] - 0s 16ms/step - loss: 0.2865 - binary_accuracy: 0.9550 - balanced_acc: 0.7838 - val_loss: 0.3260 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6238
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2135 - binary_accuracy: 0.9531 - balanced_acc: 0.7500 5/19 [======>.......................] - ETA: 0s - loss: 0.2105 - binary_accuracy: 0.9812 - balanced_acc: 0.8900 9/19 [=============>................] - ETA: 0s - loss: 0.2055 - binary_accuracy: 0.9705 - balanced_acc: 0.853213/19 [===================>..........] - ETA: 0s - loss: 0.2145 - binary_accuracy: 0.9651 - balanced_acc: 0.846217/19 [=========================>....] - ETA: 0s - loss: 0.2086 - binary_accuracy: 0.9651 - balanced_acc: 0.835819/19 [==============================] - 0s 16ms/step - loss: 0.2134 - binary_accuracy: 0.9627 - balanced_acc: 0.8180 - val_loss: 0.2975 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6592
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1482 - binary_accuracy: 0.9844 - balanced_acc: 0.8333 5/19 [======>.......................] - ETA: 0s - loss: 0.1985 - binary_accuracy: 0.9563 - balanced_acc: 0.8872 9/19 [=============>................] - ETA: 0s - loss: 0.1984 - binary_accuracy: 0.9583 - balanced_acc: 0.852213/19 [===================>..........] - ETA: 0s - loss: 0.1912 - binary_accuracy: 0.9627 - balanced_acc: 0.856617/19 [=========================>....] - ETA: 0s - loss: 0.2064 - binary_accuracy: 0.9586 - balanced_acc: 0.852319/19 [==============================] - 0s 16ms/step - loss: 0.2106 - binary_accuracy: 0.9584 - balanced_acc: 0.8258 - val_loss: 0.3042 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6266
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1864 - binary_accuracy: 0.9844 - balanced_acc: 0.9000 5/19 [======>.......................] - ETA: 0s - loss: 0.1783 - binary_accuracy: 0.9844 - balanced_acc: 0.9068 9/19 [=============>................] - ETA: 0s - loss: 0.2035 - binary_accuracy: 0.9705 - balanced_acc: 0.861413/19 [===================>..........] - ETA: 0s - loss: 0.2111 - binary_accuracy: 0.9712 - balanced_acc: 0.884117/19 [=========================>....] - ETA: 0s - loss: 0.2218 - binary_accuracy: 0.9642 - balanced_acc: 0.855119/19 [==============================] - 0s 16ms/step - loss: 0.2193 - binary_accuracy: 0.9644 - balanced_acc: 0.8601 - val_loss: 0.3072 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6517
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1937 - binary_accuracy: 0.9688 - balanced_acc: 0.9831 5/19 [======>.......................] - ETA: 0s - loss: 0.1651 - binary_accuracy: 0.9719 - balanced_acc: 0.8900 9/19 [=============>................] - ETA: 0s - loss: 0.1880 - binary_accuracy: 0.9583 - balanced_acc: 0.803913/19 [===================>..........] - ETA: 0s - loss: 0.1990 - binary_accuracy: 0.9603 - balanced_acc: 0.844317/19 [=========================>....] - ETA: 0s - loss: 0.2169 - binary_accuracy: 0.9577 - balanced_acc: 0.831519/19 [==============================] - 0s 16ms/step - loss: 0.2155 - binary_accuracy: 0.9576 - balanced_acc: 0.8378 - val_loss: 0.3263 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6886
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1626 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.1792 - binary_accuracy: 0.9812 - balanced_acc: 0.9250 8/19 [===========>..................] - ETA: 0s - loss: 0.1846 - binary_accuracy: 0.9727 - balanced_acc: 0.893712/19 [=================>............] - ETA: 0s - loss: 0.1795 - binary_accuracy: 0.9740 - balanced_acc: 0.906816/19 [========================>.....] - ETA: 0s - loss: 0.1874 - binary_accuracy: 0.9707 - balanced_acc: 0.899519/19 [==============================] - 0s 17ms/step - loss: 0.1886 - binary_accuracy: 0.9695 - balanced_acc: 0.9009 - val_loss: 0.3047 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6271
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1800 - binary_accuracy: 0.9688 - balanced_acc: 0.8333 5/19 [======>.......................] - ETA: 0s - loss: 0.1657 - binary_accuracy: 0.9781 - balanced_acc: 0.8484 8/19 [===========>..................] - ETA: 0s - loss: 0.1686 - binary_accuracy: 0.9727 - balanced_acc: 0.871012/19 [=================>............] - ETA: 0s - loss: 0.1554 - binary_accuracy: 0.9805 - balanced_acc: 0.908116/19 [========================>.....] - ETA: 0s - loss: 0.1728 - binary_accuracy: 0.9727 - balanced_acc: 0.894719/19 [==============================] - 0s 17ms/step - loss: 0.1748 - binary_accuracy: 0.9729 - balanced_acc: 0.9096 - val_loss: 0.2447 - val_binary_accuracy: 0.9492 - val_balanced_acc: 0.7571
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2048 - binary_accuracy: 0.9531 - balanced_acc: 0.8831 5/19 [======>.......................] - ETA: 0s - loss: 0.1510 - binary_accuracy: 0.9781 - balanced_acc: 0.9130 9/19 [=============>................] - ETA: 0s - loss: 0.1455 - binary_accuracy: 0.9809 - balanced_acc: 0.926712/19 [=================>............] - ETA: 0s - loss: 0.1490 - binary_accuracy: 0.9818 - balanced_acc: 0.924516/19 [========================>.....] - ETA: 0s - loss: 0.1499 - binary_accuracy: 0.9824 - balanced_acc: 0.931619/19 [==============================] - ETA: 0s - loss: 0.1548 - binary_accuracy: 0.9813 - balanced_acc: 0.937719/19 [==============================] - 0s 18ms/step - loss: 0.1548 - binary_accuracy: 0.9813 - balanced_acc: 0.9377 - val_loss: 0.3124 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6366
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2123 - binary_accuracy: 0.9688 - balanced_acc: 0.8000 5/19 [======>.......................] - ETA: 0s - loss: 0.1363 - binary_accuracy: 0.9875 - balanced_acc: 0.9383 9/19 [=============>................] - ETA: 0s - loss: 0.1399 - binary_accuracy: 0.9809 - balanced_acc: 0.924512/19 [=================>............] - ETA: 0s - loss: 0.1395 - binary_accuracy: 0.9831 - balanced_acc: 0.931516/19 [========================>.....] - ETA: 0s - loss: 0.1379 - binary_accuracy: 0.9814 - balanced_acc: 0.931719/19 [==============================] - 0s 17ms/step - loss: 0.1351 - binary_accuracy: 0.9822 - balanced_acc: 0.9300 - val_loss: 0.2714 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7349
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1078 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.1256 - binary_accuracy: 0.9844 - balanced_acc: 0.9789 8/19 [===========>..................] - ETA: 0s - loss: 0.1218 - binary_accuracy: 0.9883 - balanced_acc: 0.985812/19 [=================>............] - ETA: 0s - loss: 0.1157 - binary_accuracy: 0.9922 - balanced_acc: 0.990516/19 [========================>.....] - ETA: 0s - loss: 0.1155 - binary_accuracy: 0.9932 - balanced_acc: 0.987719/19 [==============================] - 0s 17ms/step - loss: 0.1154 - binary_accuracy: 0.9924 - balanced_acc: 0.9791 - val_loss: 0.2654 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7049
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1377 - binary_accuracy: 0.9844 - balanced_acc: 0.9912 5/19 [======>.......................] - ETA: 0s - loss: 0.1230 - binary_accuracy: 0.9875 - balanced_acc: 0.9365 9/19 [=============>................] - ETA: 0s - loss: 0.1172 - binary_accuracy: 0.9913 - balanced_acc: 0.953613/19 [===================>..........] - ETA: 0s - loss: 0.1173 - binary_accuracy: 0.9880 - balanced_acc: 0.957617/19 [=========================>....] - ETA: 0s - loss: 0.1133 - binary_accuracy: 0.9899 - balanced_acc: 0.962719/19 [==============================] - 0s 17ms/step - loss: 0.1122 - binary_accuracy: 0.9898 - balanced_acc: 0.9399 - val_loss: 0.2747 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6616
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1042 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.1072 - binary_accuracy: 0.9937 - balanced_acc: 0.9734 9/19 [=============>................] - ETA: 0s - loss: 0.1082 - binary_accuracy: 0.9913 - balanced_acc: 0.956513/19 [===================>..........] - ETA: 0s - loss: 0.1041 - binary_accuracy: 0.9928 - balanced_acc: 0.963516/19 [========================>.....] - ETA: 0s - loss: 0.1041 - binary_accuracy: 0.9932 - balanced_acc: 0.969819/19 [==============================] - 0s 17ms/step - loss: 0.1041 - binary_accuracy: 0.9915 - balanced_acc: 0.9570 - val_loss: 0.2597 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7270
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1128 - binary_accuracy: 0.9844 - balanced_acc: 0.9167 5/19 [======>.......................] - ETA: 0s - loss: 0.0996 - binary_accuracy: 0.9937 - balanced_acc: 0.9817 8/19 [===========>..................] - ETA: 0s - loss: 0.0995 - binary_accuracy: 0.9961 - balanced_acc: 0.988612/19 [=================>............] - ETA: 0s - loss: 0.0981 - binary_accuracy: 0.9948 - balanced_acc: 0.970816/19 [========================>.....] - ETA: 0s - loss: 0.0977 - binary_accuracy: 0.9941 - balanced_acc: 0.967219/19 [==============================] - 0s 17ms/step - loss: 0.0991 - binary_accuracy: 0.9932 - balanced_acc: 0.9667 - val_loss: 0.2525 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7470
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0862 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 4/19 [=====>........................] - ETA: 0s - loss: 0.0912 - binary_accuracy: 0.9961 - balanced_acc: 0.9979 8/19 [===========>..................] - ETA: 0s - loss: 0.0907 - binary_accuracy: 0.9980 - balanced_acc: 0.999012/19 [=================>............] - ETA: 0s - loss: 0.0959 - binary_accuracy: 0.9935 - balanced_acc: 0.971916/19 [========================>.....] - ETA: 0s - loss: 0.0956 - binary_accuracy: 0.9941 - balanced_acc: 0.978319/19 [==============================] - 0s 17ms/step - loss: 0.0938 - binary_accuracy: 0.9949 - balanced_acc: 0.9818 - val_loss: 0.2543 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7470
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0939 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0975 - binary_accuracy: 0.9906 - balanced_acc: 0.9950 9/19 [=============>................] - ETA: 0s - loss: 0.0976 - binary_accuracy: 0.9931 - balanced_acc: 0.986112/19 [=================>............] - ETA: 0s - loss: 0.0945 - binary_accuracy: 0.9948 - balanced_acc: 0.989616/19 [========================>.....] - ETA: 0s - loss: 0.0929 - binary_accuracy: 0.9951 - balanced_acc: 0.987719/19 [==============================] - 0s 18ms/step - loss: 0.0922 - binary_accuracy: 0.9958 - balanced_acc: 0.9897 - val_loss: 0.2574 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7238
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1010 - binary_accuracy: 0.9844 - balanced_acc: 0.9286 5/19 [======>.......................] - ETA: 0s - loss: 0.0870 - binary_accuracy: 0.9937 - balanced_acc: 0.9607 9/19 [=============>................] - ETA: 0s - loss: 0.0898 - binary_accuracy: 0.9948 - balanced_acc: 0.977213/19 [===================>..........] - ETA: 0s - loss: 0.0877 - binary_accuracy: 0.9964 - balanced_acc: 0.984217/19 [=========================>....] - ETA: 0s - loss: 0.0924 - binary_accuracy: 0.9954 - balanced_acc: 0.983219/19 [==============================] - 0s 16ms/step - loss: 0.0917 - binary_accuracy: 0.9958 - balanced_acc: 0.9850 - val_loss: 0.2517 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0856 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0811 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0856 - binary_accuracy: 0.9980 - balanced_acc: 0.992212/19 [=================>............] - ETA: 0s - loss: 0.0857 - binary_accuracy: 0.9961 - balanced_acc: 0.970516/19 [========================>.....] - ETA: 0s - loss: 0.0887 - binary_accuracy: 0.9941 - balanced_acc: 0.969019/19 [==============================] - 0s 18ms/step - loss: 0.0874 - binary_accuracy: 0.9949 - balanced_acc: 0.9739 - val_loss: 0.2494 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0728 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0747 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 9/19 [=============>................] - ETA: 0s - loss: 0.0788 - binary_accuracy: 0.9983 - balanced_acc: 0.988913/19 [===================>..........] - ETA: 0s - loss: 0.0807 - binary_accuracy: 0.9976 - balanced_acc: 0.979517/19 [=========================>....] - ETA: 0s - loss: 0.0829 - binary_accuracy: 0.9972 - balanced_acc: 0.983819/19 [==============================] - 0s 16ms/step - loss: 0.0844 - binary_accuracy: 0.9958 - balanced_acc: 0.9798 - val_loss: 0.2502 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0750 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0882 - binary_accuracy: 0.9937 - balanced_acc: 0.9732 9/19 [=============>................] - ETA: 0s - loss: 0.0863 - binary_accuracy: 0.9913 - balanced_acc: 0.965113/19 [===================>..........] - ETA: 0s - loss: 0.0826 - binary_accuracy: 0.9940 - balanced_acc: 0.975917/19 [=========================>....] - ETA: 0s - loss: 0.0803 - binary_accuracy: 0.9954 - balanced_acc: 0.981519/19 [==============================] - 0s 17ms/step - loss: 0.0797 - binary_accuracy: 0.9958 - balanced_acc: 0.9835 - val_loss: 0.2495 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0989 - binary_accuracy: 0.9844 - balanced_acc: 0.9375 5/19 [======>.......................] - ETA: 0s - loss: 0.0878 - binary_accuracy: 0.9937 - balanced_acc: 0.9859 9/19 [=============>................] - ETA: 0s - loss: 0.0807 - binary_accuracy: 0.9965 - balanced_acc: 0.992213/19 [===================>..........] - ETA: 0s - loss: 0.0795 - binary_accuracy: 0.9976 - balanced_acc: 0.994617/19 [=========================>....] - ETA: 0s - loss: 0.0786 - binary_accuracy: 0.9982 - balanced_acc: 0.995919/19 [==============================] - 0s 17ms/step - loss: 0.0792 - binary_accuracy: 0.9975 - balanced_acc: 0.9958 - val_loss: 0.2501 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0709 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0794 - binary_accuracy: 0.9969 - balanced_acc: 0.9875 9/19 [=============>................] - ETA: 0s - loss: 0.0795 - binary_accuracy: 0.9983 - balanced_acc: 0.993113/19 [===================>..........] - ETA: 0s - loss: 0.0796 - binary_accuracy: 0.9976 - balanced_acc: 0.994517/19 [=========================>....] - ETA: 0s - loss: 0.0780 - binary_accuracy: 0.9982 - balanced_acc: 0.995819/19 [==============================] - 0s 17ms/step - loss: 0.0791 - binary_accuracy: 0.9975 - balanced_acc: 0.9958 - val_loss: 0.2494 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0761 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0758 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 9/19 [=============>................] - ETA: 0s - loss: 0.0776 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0815 - binary_accuracy: 0.9964 - balanced_acc: 0.982017/19 [=========================>....] - ETA: 0s - loss: 0.0814 - binary_accuracy: 0.9963 - balanced_acc: 0.985819/19 [==============================] - 0s 16ms/step - loss: 0.0821 - binary_accuracy: 0.9958 - balanced_acc: 0.9868 - val_loss: 0.2505 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0814 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0762 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 9/19 [=============>................] - ETA: 0s - loss: 0.0816 - binary_accuracy: 0.9965 - balanced_acc: 0.985213/19 [===================>..........] - ETA: 0s - loss: 0.0802 - binary_accuracy: 0.9976 - balanced_acc: 0.989717/19 [=========================>....] - ETA: 0s - loss: 0.0811 - binary_accuracy: 0.9972 - balanced_acc: 0.987919/19 [==============================] - 0s 16ms/step - loss: 0.0824 - binary_accuracy: 0.9966 - balanced_acc: 0.9888 - val_loss: 0.2500 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0728 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0738 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 9/19 [=============>................] - ETA: 0s - loss: 0.0786 - binary_accuracy: 0.9965 - balanced_acc: 0.987713/19 [===================>..........] - ETA: 0s - loss: 0.0805 - binary_accuracy: 0.9952 - balanced_acc: 0.990117/19 [=========================>....] - ETA: 0s - loss: 0.0790 - binary_accuracy: 0.9963 - balanced_acc: 0.992519/19 [==============================] - 0s 17ms/step - loss: 0.0787 - binary_accuracy: 0.9966 - balanced_acc: 0.9933 - val_loss: 0.2486 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.7470
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0938 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0865 - binary_accuracy: 0.9969 - balanced_acc: 0.9982 9/19 [=============>................] - ETA: 0s - loss: 0.0818 - binary_accuracy: 0.9983 - balanced_acc: 0.999013/19 [===================>..........] - ETA: 0s - loss: 0.0830 - binary_accuracy: 0.9964 - balanced_acc: 0.992317/19 [=========================>....] - ETA: 0s - loss: 0.0816 - binary_accuracy: 0.9963 - balanced_acc: 0.993619/19 [==============================] - 0s 16ms/step - loss: 0.0809 - binary_accuracy: 0.9966 - balanced_acc: 0.9943 - val_loss: 0.2488 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0708 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0762 - binary_accuracy: 0.9969 - balanced_acc: 0.9983 9/19 [=============>................] - ETA: 0s - loss: 0.0791 - binary_accuracy: 0.9965 - balanced_acc: 0.998213/19 [===================>..........] - ETA: 0s - loss: 0.0800 - binary_accuracy: 0.9964 - balanced_acc: 0.998117/19 [=========================>....] - ETA: 0s - loss: 0.0782 - binary_accuracy: 0.9972 - balanced_acc: 0.998519/19 [==============================] - 0s 17ms/step - loss: 0.0780 - binary_accuracy: 0.9975 - balanced_acc: 0.9724 - val_loss: 0.2506 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0809 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 5/19 [======>.......................] - ETA: 0s - loss: 0.0790 - binary_accuracy: 0.9969 - balanced_acc: 0.9983 9/19 [=============>................] - ETA: 0s - loss: 0.0791 - binary_accuracy: 0.9965 - balanced_acc: 0.998113/19 [===================>..........] - ETA: 0s - loss: 0.0772 - binary_accuracy: 0.9976 - balanced_acc: 0.998717/19 [=========================>....] - ETA: 0s - loss: 0.0774 - binary_accuracy: 0.9982 - balanced_acc: 0.999019/19 [==============================] - 0s 17ms/step - loss: 0.0775 - binary_accuracy: 0.9983 - balanced_acc: 0.9991 - val_loss: 0.2525 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1046 - binary_accuracy: 0.9844 - balanced_acc: 0.9919 5/19 [======>.......................] - ETA: 0s - loss: 0.0804 - binary_accuracy: 0.9969 - balanced_acc: 0.9984 9/19 [=============>................] - ETA: 0s - loss: 0.0781 - binary_accuracy: 0.9965 - balanced_acc: 0.989813/19 [===================>..........] - ETA: 0s - loss: 0.0760 - binary_accuracy: 0.9976 - balanced_acc: 0.993016/19 [========================>.....] - ETA: 0s - loss: 0.0751 - binary_accuracy: 0.9980 - balanced_acc: 0.994319/19 [==============================] - 0s 18ms/step - loss: 0.0784 - binary_accuracy: 0.9958 - balanced_acc: 0.9860 - val_loss: 0.2523 - val_binary_accuracy: 0.9458 - val_balanced_acc: 0.7488

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3836 - binary_accuracy: 0.9062 - balanced_acc: 0.483312/12 [==============================] - 0s 4ms/step - loss: 0.3743 - binary_accuracy: 0.9158 - balanced_acc: 0.5764

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-58-18Z

Training run 35/648 (flags = list(0.2, 256, 0.3, 64, 256, 0.01)) 
Using run directory tuning/ ABL1/2021-11-29T00-58-33Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 1.3718 - binary_accuracy: 0.4844 - balanced_acc: 0.354219/19 [==============================] - 1s 73ms/step - loss: 0.7426 - binary_accuracy: 0.8948 - balanced_acc: 0.4923 - val_loss: 0.5149 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4799 - binary_accuracy: 0.9531 - balanced_acc: 0.500019/19 [==============================] - 1s 38ms/step - loss: 0.4285 - binary_accuracy: 0.9254 - balanced_acc: 0.5822 - val_loss: 0.3816 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3483 - binary_accuracy: 0.8906 - balanced_acc: 0.562719/19 [==============================] - 1s 36ms/step - loss: 0.2982 - binary_accuracy: 0.9355 - balanced_acc: 0.6815 - val_loss: 0.2897 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5999
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2378 - binary_accuracy: 0.9688 - balanced_acc: 0.666719/19 [==============================] - 1s 37ms/step - loss: 0.2585 - binary_accuracy: 0.9415 - balanced_acc: 0.7148 - val_loss: 0.2782 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6612
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2163 - binary_accuracy: 0.9531 - balanced_acc: 0.848419/19 [==============================] - 0s 4ms/step - loss: 0.2349 - binary_accuracy: 0.9534 - balanced_acc: 0.8001 - val_loss: 0.3459 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6067
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3287 - binary_accuracy: 0.9219 - balanced_acc: 0.687519/19 [==============================] - 0s 4ms/step - loss: 0.2278 - binary_accuracy: 0.9567 - balanced_acc: 0.7849 - val_loss: 0.3104 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5650
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2145 - binary_accuracy: 0.9531 - balanced_acc: 0.750019/19 [==============================] - 1s 37ms/step - loss: 0.1893 - binary_accuracy: 0.9644 - balanced_acc: 0.8425 - val_loss: 0.2907 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6870
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1512 - binary_accuracy: 0.9844 - balanced_acc: 0.991819/19 [==============================] - 0s 4ms/step - loss: 0.1920 - binary_accuracy: 0.9678 - balanced_acc: 0.8465 - val_loss: 0.3299 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5633
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1494 - binary_accuracy: 0.9844 - balanced_acc: 0.900019/19 [==============================] - 0s 4ms/step - loss: 0.1839 - binary_accuracy: 0.9661 - balanced_acc: 0.8756 - val_loss: 0.2994 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6033
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1497 - binary_accuracy: 0.9531 - balanced_acc: 0.883119/19 [==============================] - 0s 4ms/step - loss: 0.1927 - binary_accuracy: 0.9652 - balanced_acc: 0.8415 - val_loss: 0.3064 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6435
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2073 - binary_accuracy: 0.9375 - balanced_acc: 0.666719/19 [==============================] - 0s 4ms/step - loss: 0.1802 - binary_accuracy: 0.9661 - balanced_acc: 0.8746 - val_loss: 0.2936 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.5354
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2068 - binary_accuracy: 0.9688 - balanced_acc: 0.833319/19 [==============================] - 1s 35ms/step - loss: 0.1669 - binary_accuracy: 0.9678 - balanced_acc: 0.8582 - val_loss: 0.2770 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.7291
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2233 - binary_accuracy: 0.9375 - balanced_acc: 0.783119/19 [==============================] - 0s 4ms/step - loss: 0.1672 - binary_accuracy: 0.9678 - balanced_acc: 0.8631 - val_loss: 0.2941 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6575
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1765 - binary_accuracy: 0.9375 - balanced_acc: 0.691519/19 [==============================] - 0s 4ms/step - loss: 0.1802 - binary_accuracy: 0.9610 - balanced_acc: 0.8399 - val_loss: 0.3241 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6054
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1195 - binary_accuracy: 0.9844 - balanced_acc: 0.833319/19 [==============================] - 0s 4ms/step - loss: 0.2001 - binary_accuracy: 0.9567 - balanced_acc: 0.8174 - val_loss: 0.3034 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6807
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2236 - binary_accuracy: 0.9531 - balanced_acc: 0.848419/19 [==============================] - 0s 4ms/step - loss: 0.1838 - binary_accuracy: 0.9746 - balanced_acc: 0.8551 - val_loss: 0.3471 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6521
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2102 - binary_accuracy: 0.9531 - balanced_acc: 0.863619/19 [==============================] - 1s 35ms/step - loss: 0.1782 - binary_accuracy: 0.9669 - balanced_acc: 0.8483 - val_loss: 0.2795 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7374
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2033 - binary_accuracy: 0.9531 - balanced_acc: 0.974119/19 [==============================] - 0s 4ms/step - loss: 0.1713 - binary_accuracy: 0.9695 - balanced_acc: 0.8580 - val_loss: 0.2943 - val_binary_accuracy: 0.9153 - val_balanced_acc: 0.6397
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2019 - binary_accuracy: 0.9688 - balanced_acc: 0.866719/19 [==============================] - 0s 4ms/step - loss: 0.1714 - binary_accuracy: 0.9737 - balanced_acc: 0.8773 - val_loss: 0.2873 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6754
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2170 - binary_accuracy: 0.9219 - balanced_acc: 0.658019/19 [==============================] - 0s 4ms/step - loss: 0.1599 - binary_accuracy: 0.9703 - balanced_acc: 0.8756 - val_loss: 0.2580 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.6581
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1727 - binary_accuracy: 0.9531 - balanced_acc: 0.848419/19 [==============================] - 1s 34ms/step - loss: 0.1441 - binary_accuracy: 0.9720 - balanced_acc: 0.8734 - val_loss: 0.2718 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.7791
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2033 - binary_accuracy: 0.9375 - balanced_acc: 0.857119/19 [==============================] - 0s 4ms/step - loss: 0.1544 - binary_accuracy: 0.9712 - balanced_acc: 0.8865 - val_loss: 0.3260 - val_binary_accuracy: 0.9119 - val_balanced_acc: 0.6896
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1314 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1631 - binary_accuracy: 0.9729 - balanced_acc: 0.8881 - val_loss: 0.3106 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6438
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1244 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1618 - binary_accuracy: 0.9763 - balanced_acc: 0.8790 - val_loss: 0.3279 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6304
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1636 - binary_accuracy: 0.9844 - balanced_acc: 0.937519/19 [==============================] - 0s 4ms/step - loss: 0.1803 - binary_accuracy: 0.9618 - balanced_acc: 0.8530 - val_loss: 0.2943 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6859
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1571 - binary_accuracy: 0.9688 - balanced_acc: 0.800019/19 [==============================] - 0s 4ms/step - loss: 0.1720 - binary_accuracy: 0.9635 - balanced_acc: 0.8339 - val_loss: 0.2880 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6543
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.2086 - binary_accuracy: 0.9688 - balanced_acc: 0.908019/19 [==============================] - 0s 4ms/step - loss: 0.1549 - binary_accuracy: 0.9746 - balanced_acc: 0.8573 - val_loss: 0.3057 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6826
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1288 - binary_accuracy: 0.9844 - balanced_acc: 0.937519/19 [==============================] - 0s 4ms/step - loss: 0.1500 - binary_accuracy: 0.9754 - balanced_acc: 0.8822 - val_loss: 0.3496 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6580
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1880 - binary_accuracy: 0.9375 - balanced_acc: 0.874619/19 [==============================] - 0s 4ms/step - loss: 0.1814 - binary_accuracy: 0.9661 - balanced_acc: 0.8748 - val_loss: 0.3530 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6038
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1415 - binary_accuracy: 0.9844 - balanced_acc: 0.944419/19 [==============================] - 0s 4ms/step - loss: 0.1667 - binary_accuracy: 0.9695 - balanced_acc: 0.8689 - val_loss: 0.3009 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5771
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1074 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1617 - binary_accuracy: 0.9720 - balanced_acc: 0.8299 - val_loss: 0.3199 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5621
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1589 - binary_accuracy: 0.9688 - balanced_acc: 0.908018/19 [===========================>..] - ETA: 0s - loss: 0.1370 - binary_accuracy: 0.9792 - balanced_acc: 0.890819/19 [==============================] - 0s 4ms/step - loss: 0.1362 - binary_accuracy: 0.9796 - balanced_acc: 0.8965 - val_loss: 0.3138 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5805
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1232 - binary_accuracy: 0.9844 - balanced_acc: 0.750019/19 [==============================] - 0s 4ms/step - loss: 0.1309 - binary_accuracy: 0.9822 - balanced_acc: 0.9155 - val_loss: 0.2878 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6410
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0900 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1226 - binary_accuracy: 0.9822 - balanced_acc: 0.9192 - val_loss: 0.2915 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6210
Epoch 35/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1103 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1172 - binary_accuracy: 0.9822 - balanced_acc: 0.8817 - val_loss: 0.2928 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5993
Epoch 36/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0868 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1153 - binary_accuracy: 0.9881 - balanced_acc: 0.9526 - val_loss: 0.2893 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5993
Epoch 37/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1062 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 3ms/step - loss: 0.1057 - binary_accuracy: 0.9941 - balanced_acc: 0.9703 - val_loss: 0.3004 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6038
Epoch 38/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1066 - binary_accuracy: 0.9844 - balanced_acc: 0.833319/19 [==============================] - 0s 3ms/step - loss: 0.1085 - binary_accuracy: 0.9856 - balanced_acc: 0.9502 - val_loss: 0.2966 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5993
Epoch 39/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1108 - binary_accuracy: 0.9844 - balanced_acc: 0.991419/19 [==============================] - 0s 4ms/step - loss: 0.1050 - binary_accuracy: 0.9873 - balanced_acc: 0.9635 - val_loss: 0.3134 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6038
Epoch 40/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0939 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1046 - binary_accuracy: 0.9898 - balanced_acc: 0.9558 - val_loss: 0.2981 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 41/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1393 - binary_accuracy: 0.9688 - balanced_acc: 0.833319/19 [==============================] - 0s 4ms/step - loss: 0.1024 - binary_accuracy: 0.9847 - balanced_acc: 0.9571 - val_loss: 0.2846 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 42/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0994 - binary_accuracy: 0.9844 - balanced_acc: 0.944419/19 [==============================] - 0s 4ms/step - loss: 0.1012 - binary_accuracy: 0.9856 - balanced_acc: 0.9354 - val_loss: 0.2842 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 43/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0855 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.0941 - binary_accuracy: 0.9941 - balanced_acc: 0.9658 - val_loss: 0.2847 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 44/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0794 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.0956 - binary_accuracy: 0.9890 - balanced_acc: 0.9494 - val_loss: 0.2860 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5771
Epoch 45/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0819 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1021 - binary_accuracy: 0.9847 - balanced_acc: 0.9159 - val_loss: 0.2856 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5771
Epoch 46/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0774 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.0965 - binary_accuracy: 0.9907 - balanced_acc: 0.9672 - val_loss: 0.2845 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 47/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1192 - binary_accuracy: 0.9688 - balanced_acc: 0.833319/19 [==============================] - 0s 4ms/step - loss: 0.0970 - binary_accuracy: 0.9898 - balanced_acc: 0.9561 - val_loss: 0.2846 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 48/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0746 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.1026 - binary_accuracy: 0.9898 - balanced_acc: 0.9578 - val_loss: 0.2824 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 49/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0800 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.0945 - binary_accuracy: 0.9898 - balanced_acc: 0.9734 - val_loss: 0.2814 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 50/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0843 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 4ms/step - loss: 0.0946 - binary_accuracy: 0.9915 - balanced_acc: 0.9722 - val_loss: 0.2806 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743
Epoch 51/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1068 - binary_accuracy: 0.9844 - balanced_acc: 0.937519/19 [==============================] - 0s 4ms/step - loss: 0.0933 - binary_accuracy: 0.9915 - balanced_acc: 0.9595 - val_loss: 0.2806 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5743

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3506 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 915us/step - loss: 0.3614 - binary_accuracy: 0.9266 - balanced_acc: 0.5820

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-58-33Z

Training run 36/648 (flags = list(0, 512, 0.4, 256, 256, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-58-44Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
1/5 [=====>........................] - ETA: 0s - loss: 1.7043 - binary_accuracy: 0.5547 - balanced_acc: 0.50075/5 [==============================] - 1s 157ms/step - loss: 1.3780 - binary_accuracy: 0.8414 - balanced_acc: 0.5001 - val_loss: 1.2429 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
1/5 [=====>........................] - ETA: 0s - loss: 1.2209 - binary_accuracy: 0.9297 - balanced_acc: 0.50005/5 [==============================] - 0s 10ms/step - loss: 1.2204 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 1.0939 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 3/250
1/5 [=====>........................] - ETA: 0s - loss: 1.0985 - binary_accuracy: 0.9180 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 1.0478 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.9810 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 4/250
1/5 [=====>........................] - ETA: 0s - loss: 0.9349 - binary_accuracy: 0.9453 - balanced_acc: 0.50005/5 [==============================] - 0s 9ms/step - loss: 0.9411 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8876 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 5/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8982 - binary_accuracy: 0.9023 - balanced_acc: 0.50005/5 [==============================] - 0s 8ms/step - loss: 0.8411 - binary_accuracy: 0.9186 - balanced_acc: 0.5000 - val_loss: 0.8011 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 6/250
1/5 [=====>........................] - ETA: 0s - loss: 0.8164 - binary_accuracy: 0.9062 - balanced_acc: 0.52005/5 [==============================] - 1s 125ms/step - loss: 0.7527 - binary_accuracy: 0.9220 - balanced_acc: 0.5160 - val_loss: 0.7330 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5132
Epoch 7/250
1/5 [=====>........................] - ETA: 0s - loss: 0.6961 - binary_accuracy: 0.9258 - balanced_acc: 0.52505/5 [==============================] - 1s 209ms/step - loss: 0.6714 - binary_accuracy: 0.9271 - balanced_acc: 0.5521 - val_loss: 0.6677 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5263
Epoch 8/250
1/5 [=====>........................] - ETA: 0s - loss: 0.6224 - binary_accuracy: 0.9375 - balanced_acc: 0.65225/5 [==============================] - 0s 8ms/step - loss: 0.6036 - binary_accuracy: 0.9347 - balanced_acc: 0.6070 - val_loss: 0.6107 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5263
Epoch 9/250
1/5 [=====>........................] - ETA: 0s - loss: 0.5439 - binary_accuracy: 0.9492 - balanced_acc: 0.53575/5 [==============================] - 0s 9ms/step - loss: 0.5407 - binary_accuracy: 0.9398 - balanced_acc: 0.6416 - val_loss: 0.5723 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5132
Epoch 10/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4796 - binary_accuracy: 0.9648 - balanced_acc: 0.73535/5 [==============================] - 0s 8ms/step - loss: 0.4847 - binary_accuracy: 0.9457 - balanced_acc: 0.6851 - val_loss: 0.5341 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5263
Epoch 11/250
1/5 [=====>........................] - ETA: 0s - loss: 0.4379 - binary_accuracy: 0.9648 - balanced_acc: 0.78745/5 [==============================] - 1s 127ms/step - loss: 0.4346 - binary_accuracy: 0.9601 - balanced_acc: 0.7910 - val_loss: 0.4983 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5526
Epoch 12/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3948 - binary_accuracy: 0.9766 - balanced_acc: 0.85005/5 [==============================] - 0s 8ms/step - loss: 0.3912 - binary_accuracy: 0.9695 - balanced_acc: 0.8392 - val_loss: 0.4772 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5395
Epoch 13/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3688 - binary_accuracy: 0.9766 - balanced_acc: 0.86635/5 [==============================] - 1s 134ms/step - loss: 0.3538 - binary_accuracy: 0.9805 - balanced_acc: 0.8855 - val_loss: 0.4501 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.5647
Epoch 14/250
1/5 [=====>........................] - ETA: 0s - loss: 0.3359 - binary_accuracy: 0.9883 - balanced_acc: 0.94795/5 [==============================] - 0s 9ms/step - loss: 0.3194 - binary_accuracy: 0.9915 - balanced_acc: 0.9664 - val_loss: 0.4366 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5637
Epoch 15/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2994 - binary_accuracy: 0.9922 - balanced_acc: 0.97165/5 [==============================] - 1s 125ms/step - loss: 0.2920 - binary_accuracy: 0.9915 - balanced_acc: 0.9579 - val_loss: 0.4122 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6393
Epoch 16/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2778 - binary_accuracy: 0.9922 - balanced_acc: 0.99575/5 [==============================] - 0s 8ms/step - loss: 0.2651 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.4193 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6141
Epoch 17/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2491 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 1s 124ms/step - loss: 0.2445 - binary_accuracy: 0.9975 - balanced_acc: 0.9847 - val_loss: 0.3855 - val_binary_accuracy: 0.9424 - val_balanced_acc: 0.6525
Epoch 18/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2334 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.2278 - binary_accuracy: 0.9992 - balanced_acc: 0.9993 - val_loss: 0.3915 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5516
Epoch 19/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2133 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 1s 125ms/step - loss: 0.2164 - binary_accuracy: 0.9958 - balanced_acc: 0.9798 - val_loss: 0.3686 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6575
Epoch 20/250
1/5 [=====>........................] - ETA: 0s - loss: 0.2057 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.2021 - binary_accuracy: 0.9975 - balanced_acc: 0.9802 - val_loss: 0.3699 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5565
Epoch 21/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1893 - binary_accuracy: 0.9961 - balanced_acc: 0.99795/5 [==============================] - 0s 8ms/step - loss: 0.1873 - binary_accuracy: 0.9975 - balanced_acc: 0.9901 - val_loss: 0.3503 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.5565
Epoch 22/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1768 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1791 - binary_accuracy: 0.9975 - balanced_acc: 0.9987 - val_loss: 0.3549 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6262
Epoch 23/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1644 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1679 - binary_accuracy: 0.9975 - balanced_acc: 0.9895 - val_loss: 0.3295 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6311
Epoch 24/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1570 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1569 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3420 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6141
Epoch 25/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1532 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1513 - binary_accuracy: 0.9983 - balanced_acc: 0.9951 - val_loss: 0.3087 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6301
Epoch 26/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1470 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1424 - binary_accuracy: 0.9983 - balanced_acc: 0.9889 - val_loss: 0.3234 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6130
Epoch 27/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1374 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1334 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2973 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6180
Epoch 28/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1280 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1283 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3076 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6262
Epoch 29/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1217 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1206 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3029 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 30/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1200 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1171 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3022 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 31/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1173 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1162 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.3011 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 32/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1161 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1158 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2993 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 33/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1159 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1149 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2969 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 34/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1113 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1140 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2959 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 35/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1148 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.1137 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2950 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 36/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1127 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1129 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2933 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 37/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1119 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1124 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2928 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 38/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1102 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1117 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2909 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 39/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1128 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1114 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2904 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 40/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1115 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1109 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2903 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 41/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1114 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1105 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2905 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 42/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1133 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1108 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2905 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 43/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1110 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1113 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2906 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 44/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1101 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1108 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2907 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 45/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1114 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1106 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2908 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 46/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1121 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 8ms/step - loss: 0.1105 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2910 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 47/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1089 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 9ms/step - loss: 0.1104 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2910 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 48/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1107 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 15ms/step - loss: 0.1100 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2910 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251
Epoch 49/250
1/5 [=====>........................] - ETA: 0s - loss: 0.1111 - binary_accuracy: 1.0000 - balanced_acc: 1.00005/5 [==============================] - 0s 10ms/step - loss: 0.1103 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2911 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.6251

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3971 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 1ms/step - loss: 0.3672 - binary_accuracy: 0.9212 - balanced_acc: 0.5791

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))

Run completed: tuning/ ABL1/2021-11-29T00-58-44Z

Training run 37/648 (flags = list(0, 1024, 0.3, 64, 2048, 0.001)) 
Using run directory tuning/ ABL1/2021-11-29T00-58-54Z

R-3.5.1> FLAGS <- flags(flag_integer("dense_units1", 2048), 
+     flag_numeric("dropout1", 0.1), flag_numeric("lr", 0.01), 
+     flag_integer("dense ..." ... [TRUNCATED] 

R-3.5.1> balanced_acc <- custom_metric("balanced_acc", function(y_true, 
+     y_pred) {
+     y_pred_pos = k_round(k_clip(y_pred, 0, 1))
+     y_pred .... [TRUNCATED] 

R-3.5.1> tensorflow::tf$random$set_seed(42)

R-3.5.1> model <- keras_model_sequential()

R-3.5.1> model %>% layer_dense(units = FLAGS$dense_units1, 
+     activation = FLAGS$activation_1, input_shape = c(1024), kernel_regularizer = regular .... [TRUNCATED] 

R-3.5.1> model %>% compile(loss = "binary_crossentropy", optimizer = optimizer_adam(FLAGS$lr), 
+     metrics = c("binary_accuracy", balanced_acc))

R-3.5.1> early_stop <- callback_early_stopping(monitor = "val_balanced_acc", 
+     mode = "max", patience = 30)

R-3.5.1> callback_check_pt <- callback_model_checkpoint(paste0(targets_dataset[i], 
+     "checkpoints"), monitor = "val_balanced_acc", verbose = 0, 
 .... [TRUNCATED] 

R-3.5.1> reduce_lr_on_plateau <- callback_reduce_lr_on_plateau(monitor = "val_balanced_acc", 
+     factor = 0.1, patience = 10, verbose = 0, mode = " ..." ... [TRUNCATED] 

R-3.5.1> epochs <- 250

R-3.5.1> history <- model %>% fit(x_train, y_train, epochs = epochs, 
+     validation_split = 0.2, batch_size = FLAGS$batch_size, verbose = 1, 
+     .... [TRUNCATED] 
Epoch 1/250
 1/19 [>.............................] - ETA: 0s - loss: 3.0518 - binary_accuracy: 0.7188 - balanced_acc: 0.4814 7/19 [==========>...................] - ETA: 0s - loss: 2.6154 - binary_accuracy: 0.8750 - balanced_acc: 0.497314/19 [=====================>........] - ETA: 0s - loss: 2.3228 - binary_accuracy: 0.9007 - balanced_acc: 0.498719/19 [==============================] - 1s 49ms/step - loss: 2.1695 - binary_accuracy: 0.9075 - balanced_acc: 0.4990 - val_loss: 1.5198 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.5000
Epoch 2/250
 1/19 [>.............................] - ETA: 0s - loss: 1.4279 - binary_accuracy: 0.9531 - balanced_acc: 0.5000 8/19 [===========>..................] - ETA: 0s - loss: 1.3574 - binary_accuracy: 0.9160 - balanced_acc: 0.500014/19 [=====================>........] - ETA: 0s - loss: 1.2526 - binary_accuracy: 0.9129 - balanced_acc: 0.513419/19 [==============================] - 1s 41ms/step - loss: 1.1689 - binary_accuracy: 0.9220 - balanced_acc: 0.5283 - val_loss: 0.8925 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5167
Epoch 3/250
 1/19 [>.............................] - ETA: 0s - loss: 0.8736 - binary_accuracy: 0.9062 - balanced_acc: 0.5714 7/19 [==========>...................] - ETA: 0s - loss: 0.7745 - binary_accuracy: 0.9241 - balanced_acc: 0.534014/19 [=====================>........] - ETA: 0s - loss: 0.7164 - binary_accuracy: 0.9353 - balanced_acc: 0.635919/19 [==============================] - 1s 41ms/step - loss: 0.6861 - binary_accuracy: 0.9355 - balanced_acc: 0.6467 - val_loss: 0.5968 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5583
Epoch 4/250
 1/19 [>.............................] - ETA: 0s - loss: 0.4873 - binary_accuracy: 0.9688 - balanced_acc: 0.8251 8/19 [===========>..................] - ETA: 0s - loss: 0.4526 - binary_accuracy: 0.9844 - balanced_acc: 0.874015/19 [======================>.......] - ETA: 0s - loss: 0.4358 - binary_accuracy: 0.9740 - balanced_acc: 0.868119/19 [==============================] - 1s 41ms/step - loss: 0.4351 - binary_accuracy: 0.9703 - balanced_acc: 0.8693 - val_loss: 0.4514 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.7420
Epoch 5/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3671 - binary_accuracy: 0.9531 - balanced_acc: 0.9110 8/19 [===========>..................] - ETA: 0s - loss: 0.3256 - binary_accuracy: 0.9824 - balanced_acc: 0.966815/19 [======================>.......] - ETA: 0s - loss: 0.3214 - binary_accuracy: 0.9802 - balanced_acc: 0.942719/19 [==============================] - 0s 9ms/step - loss: 0.3182 - binary_accuracy: 0.9788 - balanced_acc: 0.9424 - val_loss: 0.4425 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5633
Epoch 6/250
 1/19 [>.............................] - ETA: 0s - loss: 0.3821 - binary_accuracy: 0.9531 - balanced_acc: 0.8125 8/19 [===========>..................] - ETA: 0s - loss: 0.2571 - binary_accuracy: 0.9902 - balanced_acc: 0.966515/19 [======================>.......] - ETA: 0s - loss: 0.2493 - binary_accuracy: 0.9865 - balanced_acc: 0.949519/19 [==============================] - 0s 9ms/step - loss: 0.2479 - binary_accuracy: 0.9839 - balanced_acc: 0.9250 - val_loss: 0.3565 - val_binary_accuracy: 0.9220 - val_balanced_acc: 0.6059
Epoch 7/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1852 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.1988 - binary_accuracy: 0.9883 - balanced_acc: 0.938515/19 [======================>.......] - ETA: 0s - loss: 0.1932 - binary_accuracy: 0.9896 - balanced_acc: 0.957119/19 [==============================] - 0s 9ms/step - loss: 0.1900 - binary_accuracy: 0.9898 - balanced_acc: 0.9530 - val_loss: 0.3291 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6871
Epoch 8/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1483 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.1656 - binary_accuracy: 0.9922 - balanced_acc: 0.980015/19 [======================>.......] - ETA: 0s - loss: 0.1607 - binary_accuracy: 0.9917 - balanced_acc: 0.951219/19 [==============================] - 0s 9ms/step - loss: 0.1600 - binary_accuracy: 0.9915 - balanced_acc: 0.9573 - val_loss: 0.3172 - val_binary_accuracy: 0.9186 - val_balanced_acc: 0.6458
Epoch 9/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1297 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.1384 - binary_accuracy: 0.9941 - balanced_acc: 0.967715/19 [======================>.......] - ETA: 0s - loss: 0.1415 - binary_accuracy: 0.9906 - balanced_acc: 0.969619/19 [==============================] - 0s 9ms/step - loss: 0.1391 - binary_accuracy: 0.9915 - balanced_acc: 0.9755 - val_loss: 0.3204 - val_binary_accuracy: 0.9254 - val_balanced_acc: 0.5655
Epoch 10/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1382 - binary_accuracy: 0.9844 - balanced_acc: 0.9000 8/19 [===========>..................] - ETA: 0s - loss: 0.1259 - binary_accuracy: 0.9902 - balanced_acc: 0.951015/19 [======================>.......] - ETA: 0s - loss: 0.1291 - binary_accuracy: 0.9875 - balanced_acc: 0.939119/19 [==============================] - 0s 9ms/step - loss: 0.1298 - binary_accuracy: 0.9881 - balanced_acc: 0.9462 - val_loss: 0.2605 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.7325
Epoch 11/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1033 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.1056 - binary_accuracy: 0.9980 - balanced_acc: 0.987515/19 [======================>.......] - ETA: 0s - loss: 0.1056 - binary_accuracy: 0.9969 - balanced_acc: 0.982519/19 [==============================] - 0s 9ms/step - loss: 0.1087 - binary_accuracy: 0.9949 - balanced_acc: 0.9843 - val_loss: 0.2813 - val_binary_accuracy: 0.9288 - val_balanced_acc: 0.6104
Epoch 12/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0927 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.1018 - binary_accuracy: 0.9922 - balanced_acc: 0.950515/19 [======================>.......] - ETA: 0s - loss: 0.1002 - binary_accuracy: 0.9948 - balanced_acc: 0.966919/19 [==============================] - 0s 10ms/step - loss: 0.1008 - binary_accuracy: 0.9941 - balanced_acc: 0.9681 - val_loss: 0.2661 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6925
Epoch 13/250
 1/19 [>.............................] - ETA: 0s - loss: 0.1341 - binary_accuracy: 0.9688 - balanced_acc: 0.9831 7/19 [==========>...................] - ETA: 0s - loss: 0.0926 - binary_accuracy: 0.9933 - balanced_acc: 0.973813/19 [===================>..........] - ETA: 0s - loss: 0.0880 - binary_accuracy: 0.9964 - balanced_acc: 0.985919/19 [==============================] - 0s 10ms/step - loss: 0.0863 - binary_accuracy: 0.9975 - balanced_acc: 0.9903 - val_loss: 0.2522 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6771
Epoch 14/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0759 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0763 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0792 - binary_accuracy: 0.9976 - balanced_acc: 0.993019/19 [==============================] - 0s 10ms/step - loss: 0.0786 - binary_accuracy: 0.9975 - balanced_acc: 0.9948 - val_loss: 0.3270 - val_binary_accuracy: 0.9322 - val_balanced_acc: 0.5850
Epoch 15/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0710 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0743 - binary_accuracy: 0.9978 - balanced_acc: 0.989813/19 [===================>..........] - ETA: 0s - loss: 0.0769 - binary_accuracy: 0.9964 - balanced_acc: 0.979419/19 [==============================] - ETA: 0s - loss: 0.0751 - binary_accuracy: 0.9975 - balanced_acc: 0.985919/19 [==============================] - 0s 10ms/step - loss: 0.0751 - binary_accuracy: 0.9975 - balanced_acc: 0.9859 - val_loss: 0.2449 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6721
Epoch 16/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0715 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0684 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0686 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0680 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.2371 - val_binary_accuracy: 0.9390 - val_balanced_acc: 0.6954
Epoch 17/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0640 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0658 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0659 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0659 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2454 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 18/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0654 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0652 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0645 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0648 - binary_accuracy: 0.9992 - balanced_acc: 0.9996 - val_loss: 0.2417 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 19/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0628 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0629 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0639 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0635 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2388 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 20/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0632 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0634 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0629 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0626 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2372 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 21/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0631 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0609 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0621 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0617 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2355 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 22/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0603 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0600 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0605 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0608 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2341 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 23/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0583 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0591 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0588 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0598 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2343 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 24/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0581 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0598 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0593 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0589 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2334 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 25/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0569 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0579 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0579 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0583 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2332 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 26/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0560 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0576 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0583 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0583 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2328 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 27/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0604 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0574 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0578 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0581 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2327 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 28/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0588 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0577 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0575 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0581 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2327 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 29/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0576 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0573 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0576 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0580 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2322 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 30/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0592 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0585 - binary_accuracy: 1.0000 - balanced_acc: 1.000015/19 [======================>.......] - ETA: 0s - loss: 0.0581 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 11ms/step - loss: 0.0578 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2319 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 31/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0568 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 8/19 [===========>..................] - ETA: 0s - loss: 0.0584 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0582 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0578 - binary_accuracy: 1.0000 - balanced_acc: 0.9737 - val_loss: 0.2320 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 32/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0577 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0588 - binary_accuracy: 1.0000 - balanced_acc: 1.000013/19 [===================>..........] - ETA: 0s - loss: 0.0579 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0577 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2324 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 33/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0607 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0578 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0574 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 9ms/step - loss: 0.0576 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2319 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704
Epoch 34/250
 1/19 [>.............................] - ETA: 0s - loss: 0.0541 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 7/19 [==========>...................] - ETA: 0s - loss: 0.0559 - binary_accuracy: 1.0000 - balanced_acc: 1.000014/19 [=====================>........] - ETA: 0s - loss: 0.0575 - binary_accuracy: 1.0000 - balanced_acc: 1.000019/19 [==============================] - 0s 10ms/step - loss: 0.0575 - binary_accuracy: 1.0000 - balanced_acc: 1.0000 - val_loss: 0.2318 - val_binary_accuracy: 0.9356 - val_balanced_acc: 0.6704

R-3.5.1> history$params$epochs <- history$metrics$loss %>% 
+     length

R-3.5.1> plot(history)
`geom_smooth()` using formula 'y ~ x'

R-3.5.1> score <- model %>% evaluate(x_test, y_test, verbose = 0)

R-3.5.1> eval_model <- model %>% evaluate(x_test, y_test)
 1/12 [=>............................] - ETA: 0s - loss: 0.3308 - binary_accuracy: 0.9375 - balanced_acc: 0.500012/12 [==============================] - 0s 2ms/step - loss: 0.3228 - binary_accuracy: 0.9293 - balanced_acc: 0.5957

R-3.5.1> pred_model <- model %>% predict_classes(x_test)

R-3.5.1> rownames(pred_model) <- rownames(x_test)

R-3.5.1> proba_model <- model %>% predict_proba(x_test)

R-3.5.1> conf.matrix <- caret::confusionMatrix(factor(pred_model, 
+     levels = 0:1), factor(y_test, levels = 0:1), positive = "1")

R-3.5.1> save_model_tf(model, include_optimizer = TRUE, paste0(targets_dataset[i], 
+     ".h5"))
